"use strict";(self.webpackChunkadmin_dashboard=self.webpackChunkadmin_dashboard||[]).push([[976],{7623:(e,t,n)=>{n.d(t,{q:()=>De});var i=n(5043),o=n(8452),r=n(155),a=n(5290),s=n(5624),l=n(1411),d=function(){function e(e,t){this.parent=e,this.locator=t,this.renderer=this.locator.getService("rendererFactory"),this.addEventListener()}return e.prototype.render=function(){this.parent;this.contentRenderer=this.renderer.getRenderer(l.nJ.Content),this.contentRenderer.renderPanel()},e.prototype.refresh=function(e){void 0===e&&(e={requestType:"refresh"}),this.parent.notify(e.requestType+"-begin",e)},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(a.Ay,this.refresh,this),this.parent.on(a.LL,this.keyUp,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(a.Ay,this.refresh),this.parent.off(a.LL,this.keyUp))},e.prototype.keyUp=function(e){if("HTML"===this.parent.editorMode)switch(e.args.which){case 46:case 8:var t=this.parent.contentModule.getEditPanel().childNodes;if(0===t.length||1===t.length&&0===t[0].childNodes.length&&("BR"===t[0].tagName||("P"===t[0].tagName||"DIV"===t[0].tagName)&&""===t[0].textContent)){var n=this.parent.contentModule.getEditPanel();"DIV"===this.parent.enterKey?n.innerHTML="<div><br/></div>":"BR"===this.parent.enterKey?n.innerHTML="<br/>":n.innerHTML="<p><br/></p>",this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),n.childNodes[0],0)}}},e}(),h=n(5537),p=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),c=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},u={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,space:32,escape:27,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,delete:46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,plus:187,comma:188,minus:189,dot:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222,"]":221,"[":219,"=":187},m=function(e){function t(t,i){var o=e.call(this,i,t)||this;return o.keyPressHandler=function(e){for(var t=e.altKey,i=e.ctrlKey,r=e.shiftKey,a=e.metaKey,s=e.which,l=0,d=Object.keys(o.keyConfigs);l<d.length;l++)for(var h=d[l],p=0,c=o.keyConfigs[h].split(",");p<c.length;p++){var u=c[p],m=n.getKeyConfigData(u.trim());t!==m.altKey||i!==m.ctrlKey&&!a||r!==m.shiftKey||s!==m.keyCode||(e.action=h)}o.keyAction&&o.keyAction(e)},o.bind(),o}var n;return p(t,e),n=t,t.prototype.destroy=function(){this.unwireEvents(),e.prototype.destroy.call(this)},t.prototype.onPropertyChanged=function(e,t){},t.prototype.bind=function(){this.wireEvents()},t.prototype.getModuleName=function(){return"keyboard"},t.prototype.wireEvents=function(){this.element.addEventListener(this.eventName,this.keyPressHandler)},t.prototype.unwireEvents=function(){this.element.removeEventListener(this.eventName,this.keyPressHandler)},t.getKeyConfigData=function(e){if(e in this.configCache)return this.configCache[e];var t=e.toLowerCase().split("+"),i={altKey:-1!==t.indexOf("alt"),ctrlKey:-1!==t.indexOf("ctrl"),shiftKey:-1!==t.indexOf("shift"),keyCode:null};return t[t.length-1].length>1&&Number(t[t.length-1])?i.keyCode=Number(t[t.length-1]):i.keyCode=n.getKeyCode(t[t.length-1]),n.configCache[e]=i,i},t.getKeyCode=function(e){return u[e]||e.toUpperCase().charCodeAt(0)},t.configCache={},c([(0,o.mA)({})],t.prototype,"keyConfigs",void 0),c([(0,o.mA)("keyup")],t.prototype,"eventName",void 0),c([(0,o.Jh)()],t.prototype,"keyAction",void 0),t=n=c([o.kc],t)}(o.C6),g=function(){function e(e,t){this.parent=e;var n=t;this.rendererFactory=n.getService("rendererFactory"),this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on(a.X5,this.sourceCode,this),this.parent.on(a.qO,this.onInitialEnd,this),this.parent.on(a.Lv,this.updateSourceCode,this),this.parent.on(a.zr,this.destroy,this)},e.prototype.onInitialEnd=function(){this.parent.formatter.editorManager.observer.on(h.ck,this.onKeyDown,this)},e.prototype.removeEventListener=function(){this.unWireEvent(),this.parent.off(a.X5,this.sourceCode),this.parent.off(a.Lv,this.updateSourceCode),this.parent.off(a.qO,this.onInitialEnd),this.parent.off(a.zr,this.destroy),this.parent.formatter.editorManager.observer.off(h.ck,this.onKeyDown)},e.prototype.getSourceCode=function(){return this.parent.createElement("textarea",{className:"e-rte-srctextarea"})},e.prototype.wireEvent=function(e){this.keyboardModule=new m(e,{keyAction:this.previewKeyDown.bind(this),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"}),o.Jm.add(this.previewElement,"mousedown",this.mouseDownHandler,this)},e.prototype.unWireEvent=function(){this.keyboardModule&&this.keyboardModule.destroy(),this.previewElement&&o.Jm.remove(this.previewElement,"mousedown",this.mouseDownHandler)},e.prototype.wireBaseKeyDown=function(){this.parent.keyboardModule=new m(this.contentModule.getEditPanel(),{keyAction:this.parent.keyDown.bind(this.parent),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"})},e.prototype.unWireBaseKeyDown=function(){this.parent.keyboardModule.destroy()},e.prototype.mouseDownHandler=function(e){this.parent.notify(a.y,{args:e})},e.prototype.previewKeyDown=function(e){switch(e.action){case"html-source":this.updateSourceCode(e),e.preventDefault();break;case"toolbar-focus":if(this.parent.toolbarSettings.enable){this.parent.toolbarModule.baseToolbar.toolbarObj.element.querySelector('.e-toolbar-item[aria-disabled="false"][title] [tabindex]').focus()}}},e.prototype.onKeyDown=function(e){if("html-source"===e.event.action)e.event.preventDefault(),this.sourceCode(e),e.callBack({requestType:"SourceCode",editorMode:"HTML",event:e.event})},e.prototype.sourceCode=function(e){this.parent.isBlur=!1,this.parent.trigger(a.eY,{requestType:"SourceCode",targetItem:"SourceCode",args:e});var t=(0,o.Ub)("."+s.um,this.parent.element);if(this.contentModule=this.rendererFactory.getRenderer(l.nJ.Content),this.parent.notify(a.o7,{targetItem:"SourceCode",updateItem:"Preview",baseToolbar:this.parent.getBaseToolbarObject()}),(0,o.hX)(this.previewElement)&&(this.previewElement=this.getSourceCode()),this.parent.updateValueData(),this.parent.iframeSettings.enable){var n=void 0;(n=(0,o.hX)(this.parent.element.querySelector("#"+this.parent.element.id+"_source-view"))?this.parent.createElement("div",{className:"e-source-content",id:this.parent.element.id+"_source-view"}):this.parent.element.querySelector("#"+this.parent.element.id+"_source-view")).appendChild(this.previewElement),this.parent.element.appendChild(n),n.style.height=this.contentModule.getPanel().style.height,n.style.marginTop=this.contentModule.getPanel().style.marginTop,this.getPanel().value=this.getTextAreaValue(),this.contentModule.getPanel().style.display="none",n.style.display="block",this.getPanel().style.display="block"}else this.contentModule.getPanel().appendChild(this.previewElement),this.getPanel().value=this.getTextAreaValue(),this.contentModule.getEditPanel().style.display="none",this.previewElement.style.display="block";(this.parent.isBlur=!1,this.parent.disableToolbarItem(this.parent.toolbarSettings.items),this.parent.enableToolbarItem("SourceCode"),this.parent.getToolbar()&&(0,o.vy)([this.parent.getToolbar()],[s.P5]),(0,o.vy)(t,[s.ax]),this.parent.setContentHeight("sourceCode",!0),this.wireEvent(this.previewElement),this.unWireBaseKeyDown(),this.previewElement.focus(),this.parent.updateValue(),(0,o.hX)(this.parent.placeholder)||this.parent.iframeSettings.enable)||(this.parent.element.querySelector(".rte-placeholder.e-rte-placeholder").style.display="none");this.parent.trigger(a.wn,{requestType:"SourceCode",targetItem:"SourceCode",args:e}),this.parent.invokeChangeEvent()},e.prototype.updateSourceCode=function(e){this.parent.isBlur=!1,this.parent.trigger(a.eY,{requestType:"Preview",targetItem:"Preview",args:e});var t=this.getPanel();this.parent.notify(a.o7,{targetItem:"Preview",updateItem:"SourceCode",baseToolbar:this.parent.getBaseToolbarObject()});var n,i=this.parent.serializeValue(t.value);(n=null===i||""===i?"DIV"===this.parent.enterKey?"<div><br/></div>":"BR"===this.parent.enterKey?"<br/>":"<p><br/></p>":i,this.parent.iframeSettings.enable?(t.parentElement.style.display="none",t.style.display="none",this.contentModule.getPanel().style.display="block",this.contentModule.getEditPanel().innerHTML=n):(t.style.display="none",this.contentModule.getEditPanel().style.display="block",this.contentModule.getEditPanel().innerHTML=n),this.parent.isBlur=!1,this.parent.enableToolbarItem(this.parent.toolbarSettings.items),this.parent.getToolbar()&&(0,o.vy)([this.parent.getToolbar()],[s.P5]),this.parent.setContentHeight("preview",!0),this.unWireEvent(),this.wireBaseKeyDown(),this.contentModule.getEditPanel().focus(),this.parent.updateValue(),(0,o.hX)(this.parent.placeholder)||0!==this.contentModule.getEditPanel().innerText.length)||(this.parent.element.querySelector(".rte-placeholder.e-rte-placeholder").style.display="block");this.parent.trigger(a.wn,{requestType:"Preview",targetItem:"Preview",args:e}),this.parent.formatter.enableUndo(this.parent),this.parent.invokeChangeEvent()},e.prototype.getTextAreaValue=function(){return"<p><br></p>"===this.contentModule.getEditPanel().innerHTML||"<div><br></div>"===this.contentModule.getEditPanel().innerHTML||"<br>"===this.contentModule.getEditPanel().innerHTML||1===this.contentModule.getEditPanel().childNodes.length&&"P"===this.contentModule.getEditPanel().childNodes[0].tagName&&7===this.contentModule.getEditPanel().innerHTML.length||"DIV"===this.contentModule.getEditPanel().childNodes[0].tagName&&11===this.contentModule.getEditPanel().innerHTML.length?"":this.parent.value},e.prototype.getPanel=function(){return this.parent.element&&this.parent.element.querySelector(".e-rte-srctextarea")},e.prototype.getViewPanel=function(){return this.parent.iframeSettings.enable&&this.getPanel()?this.getPanel().parentElement:this.getPanel()},e.prototype.destroy=function(){this.removeEventListener()},e}(),f={bold:{command:"Style",subCommand:"Bold",value:"strong"},italic:{command:"Style",subCommand:"Italic",value:"em"},underline:{command:"Style",subCommand:"Underline",value:"span"},strikeThrough:{command:"Style",subCommand:"StrikeThrough",value:"span"},insertCode:{command:"Formats",subCommand:"Pre",value:"pre"},superscript:{command:"Effects",subCommand:"SuperScript",value:"sup"},subscript:{command:"Effects",subCommand:"SubScript",value:"sub"},uppercase:{command:"Casing",subCommand:"UpperCase"},lowercase:{command:"Casing",subCommand:"LowerCase"},fontColor:{command:"font",subCommand:"fontcolor",value:"#ff0000"},fontName:{command:"font",subCommand:"fontname",value:"Segoe UI"},fontSize:{command:"font",subCommand:"fontsize",value:"10pt"},backColor:{command:"font",subCommand:"backgroundcolor",value:"#ffff00"},justifyCenter:{command:"Alignments",subCommand:"JustifyCenter"},justifyFull:{command:"Alignments",subCommand:"JustifyFull"},justifyLeft:{command:"Alignments",subCommand:"JustifyLeft"},justifyRight:{command:"Alignments",subCommand:"JustifyRight"},undo:{command:"Actions",subCommand:"Undo"},redo:{command:"Actions",subCommand:"Redo"},createLink:{command:"Links",subCommand:"createLink"},editLink:{command:"Links",subCommand:"createLink"},createImage:{command:"Images",subCommand:"Images"},formatBlock:{command:"Formats",value:"P"},heading:{command:"Formats",value:"H1"},indent:{command:"Indents",subCommand:"Indent"},outdent:{command:"Indents",subCommand:"Outdent"},insertHTML:{command:"InsertHTML",subCommand:"InsertHTML",value:""},insertText:{command:"InsertText",subCommand:"InsertText",value:""},insertHorizontalRule:{command:"InsertHTML",subCommand:"InsertHTML",value:"<hr/>"},insertImage:{command:"Images",subCommand:"Image"},editImage:{command:"Images",subCommand:"Image"},insertTable:{command:"Table",subCommand:"CreateTable"},insertBrOnReturn:{command:"InsertHTML",subCommand:"InsertHTML",value:"<br/>"},insertOrderedList:{command:"Lists",value:"OL"},insertUnorderedList:{command:"Lists",value:"UL"},insertParagraph:{command:"Formats",value:"P"},removeFormat:{command:"Clear",subCommand:"ClearFormat"}},b=n(6545),v=n(3573),y=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on(a._D,this.commandCallBack,this),this.parent.on(a.zr,this.removeEventListener,this)},e.prototype.commandCallBack=function(e){"Undo"!==e.requestType&&"Redo"!==e.requestType&&this.parent.formatter.saveData(),this.parent.notify(a.Vx,{args:e}),this.parent.notify(a.U9,{})},e.prototype.removeEventListener=function(){this.parent.off(a._D,this.commandCallBack),this.parent.off(a.zr,this.removeEventListener)},e}(),C=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),S=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),S([(0,o.mA)(null)],t.prototype,"downloadUrl",void 0),S([(0,o.mA)(null)],t.prototype,"getImageUrl",void 0),S([(0,o.mA)(null)],t.prototype,"uploadUrl",void 0),S([(0,o.mA)(null)],t.prototype,"url",void 0),t}(o.I1),w=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),T=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},k=["Open","|","Cut","Copy","|","Delete","Download","Rename","|","Details"],N=["Open","|","Cut","Copy","Paste","|","Delete","Rename","Download","|","Details"],L=["SortBy","View","Refresh","|","Paste","|","NewFolder","Upload","|","Details","|","SelectAll"],D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return w(t,e),T([(0,o.mA)(k)],t.prototype,"file",void 0),T([(0,o.mA)(N)],t.prototype,"folder",void 0),T([(0,o.mA)(L)],t.prototype,"layout",void 0),T([(0,o.mA)(!0)],t.prototype,"visible",void 0),t}(o.I1),x=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),M=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},A=[{field:"name",headerText:"Name",minWidth:120,template:'<span class="e-fe-text">${name}</span>',customAttributes:{class:"e-fe-grid-name"}},{field:"_fm_modified",headerText:"DateModified",type:"dateTime",format:"MMMM dd, yyyy HH:mm",minWidth:120,width:"190"},{field:"size",headerText:"Size",minWidth:90,width:"110",template:'<span class="e-fe-size">${size}</span>'}],O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x(t,e),M([(0,o.mA)(!0)],t.prototype,"columnResizing",void 0),M([(0,o.mA)(A)],t.prototype,"columns",void 0),t}(o.I1),R=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),I=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R(t,e),I([(0,o.mA)("650px")],t.prototype,"maxWidth",void 0),I([(0,o.mA)("240px")],t.prototype,"minWidth",void 0),I([(0,o.mA)(!0)],t.prototype,"visible",void 0),I([(0,o.mA)("None")],t.prototype,"sortOrder",void 0),t}(o.I1),P=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),F=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),F([(0,o.mA)(!0)],t.prototype,"allowSearchOnTyping",void 0),F([(0,o.mA)("contains")],t.prototype,"filterType",void 0),F([(0,o.mA)(!0)],t.prototype,"ignoreCase",void 0),F([(0,o.mA)(null)],t.prototype,"placeholder",void 0),t}(o.I1),X=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),q=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},z=["NewFolder","Upload","Cut","Copy","Paste","Delete","Download","Rename","SortBy","Refresh","Selection","View","Details"],j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return X(t,e),q([(0,o.mA)(z)],t.prototype,"items",void 0),q([(0,o.mA)(!0)],t.prototype,"visible",void 0),t}(o.I1),U=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Q=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return U(t,e),Q([(0,o.mA)("")],t.prototype,"allowedExtensions",void 0),Q([(0,o.mA)(!0)],t.prototype,"autoUpload",void 0),Q([(0,o.mA)(!1)],t.prototype,"autoClose",void 0),Q([(0,o.mA)(0)],t.prototype,"minFileSize",void 0),Q([(0,o.mA)(3e7)],t.prototype,"maxFileSize",void 0),t}(o.I1),_=n(1011),J=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Y=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),Y([(0,o.mA)(!0)],t.prototype,"enable",void 0),Y([(0,o.mA)(!0)],t.prototype,"enableFloating",void 0),Y([(0,o.mA)(l.Yv.Expand)],t.prototype,"type",void 0),Y([(0,o.mA)(_.VI)],t.prototype,"items",void 0),Y([(0,o.mA)({})],t.prototype,"itemConfigs",void 0),t}(o.I1),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),Y([(0,o.mA)([".jpeg",".jpg",".png"])],t.prototype,"allowedTypes",void 0),Y([(0,o.mA)("inline")],t.prototype,"display",void 0),Y([(0,o.mA)("Blob")],t.prototype,"saveFormat",void 0),Y([(0,o.mA)("auto")],t.prototype,"width",void 0),Y([(0,o.mA)("auto")],t.prototype,"height",void 0),Y([(0,o.mA)(null)],t.prototype,"saveUrl",void 0),Y([(0,o.mA)(null)],t.prototype,"path",void 0),Y([(0,o.mA)(!0)],t.prototype,"resize",void 0),Y([(0,o.mA)(null)],t.prototype,"removeUrl",void 0),Y([(0,o.mA)(0)],t.prototype,"minWidth",void 0),Y([(0,o.mA)(null)],t.prototype,"maxWidth",void 0),Y([(0,o.mA)(0)],t.prototype,"minHeight",void 0),Y([(0,o.mA)(null)],t.prototype,"maxHeight",void 0),Y([(0,o.mA)(!1)],t.prototype,"resizeByPercent",void 0),t}(o.I1),G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),Y([(0,o.pr)({getImageUrl:null,url:null,uploadUrl:null},E)],t.prototype,"ajaxSettings",void 0),Y([(0,o.mA)(!1)],t.prototype,"allowDragAndDrop",void 0),Y([(0,o.pr)({visible:!0,file:["Open","|","Cut","Copy","|","Delete","Rename","|","Details"],folder:["Open","|","Cut","Copy","Paste","|","Delete","Rename","|","Details"],layout:["SortBy","View","Refresh","|","Paste","|","NewFolder","Upload","|","Details","|","SelectAll"]},D)],t.prototype,"contextMenuSettings",void 0),Y([(0,o.mA)("")],t.prototype,"cssClass",void 0),Y([(0,o.pr)({},O)],t.prototype,"detailsViewSettings",void 0),Y([(0,o.mA)(!1)],t.prototype,"enable",void 0),Y([(0,o.pr)({maxWidth:"650px",minWidth:"240px",visible:!0},B)],t.prototype,"navigationPaneSettings",void 0),Y([(0,o.mA)("/")],t.prototype,"path",void 0),Y([(0,o.mA)(null)],t.prototype,"rootAliasName",void 0),Y([(0,o.pr)({},H)],t.prototype,"searchSettings",void 0),Y([(0,o.mA)(!0)],t.prototype,"showFileExtension",void 0),Y([(0,o.mA)(!1)],t.prototype,"showHiddenItems",void 0),Y([(0,o.mA)(!0)],t.prototype,"showThumbnail",void 0),Y([(0,o.mA)("Ascending")],t.prototype,"sortOrder",void 0),Y([(0,o.pr)({visible:!0,items:["NewFolder","Upload","Cut","Copy","Paste","Delete","Download","Rename","SortBy","Refresh","Selection","View","Details"]},j)],t.prototype,"toolbarSettings",void 0),Y([(0,o.pr)({autoUpload:!0,minFileSize:0,maxFileSize:3e7,allowedExtensions:"",autoClose:!1},W)],t.prototype,"uploadSettings",void 0),Y([(0,o.mA)("LargeIcons")],t.prototype,"view",void 0),t}(o.I1),$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),Y([(0,o.mA)("100%")],t.prototype,"width",void 0),Y([(0,o.mA)(_.uu)],t.prototype,"styles",void 0),Y([(0,o.mA)(!0)],t.prototype,"resize",void 0),Y([(0,o.mA)(0)],t.prototype,"minWidth",void 0),Y([(0,o.mA)(null)],t.prototype,"maxWidth",void 0),t}(o.I1),Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),Y([(0,o.mA)(!0)],t.prototype,"enable",void 0),Y([(0,o.mA)(!1)],t.prototype,"showOnRightClick",void 0),Y([(0,o.mA)("hide")],t.prototype,"actionOnScroll",void 0),Y([(0,o.mA)(["Open","Edit","UnLink"])],t.prototype,"link",void 0),Y([(0,o.mA)(["Replace","Align","Caption","Remove","-","InsertLink","OpenImageLink","EditImageLink","RemoveImageLink","Display","AltText","Dimension"])],t.prototype,"image",void 0),Y([(0,o.mA)(["Cut","Copy","Paste"])],t.prototype,"text",void 0),Y([(0,o.mA)(["TableHeader","TableRows","TableColumns","BackgroundColor","-","TableRemove","Alignments","TableCellVerticalAlign","Styles"])],t.prototype,"table",void 0),t}(o.I1),ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),Y([(0,o.mA)(!1)],t.prototype,"prompt",void 0),Y([(0,o.mA)(null)],t.prototype,"deniedAttrs",void 0),Y([(0,o.mA)(["background","background-color","border","border-bottom","border-left","border-radius","border-right","border-style","border-top","border-width","clear","color","cursor","direction","display","float","font","font-family","font-size","font-weight","font-style","height","left","line-height","list-style-type","margin","margin-top","margin-left","margin-right","margin-bottom","max-height","max-width","min-height","min-width","overflow","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","position","right","table-layout","text-align","text-decoration","text-indent","top","vertical-align","visibility","white-space","width"])],t.prototype,"allowedStyleProps",void 0),Y([(0,o.mA)(null)],t.prototype,"deniedTags",void 0),Y([(0,o.mA)(!0)],t.prototype,"keepFormat",void 0),Y([(0,o.mA)(!1)],t.prototype,"plainText",void 0),t}(o.I1),te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),Y([(0,o.mA)(null)],t.prototype,"default",void 0),Y([(0,o.mA)("65px")],t.prototype,"width",void 0),Y([(0,o.mA)(_.mw)],t.prototype,"items",void 0),t}(o.I1),ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),Y([(0,o.mA)(null)],t.prototype,"default",void 0),Y([(0,o.mA)("35px")],t.prototype,"width",void 0),Y([(0,o.mA)(_.J)],t.prototype,"items",void 0),t}(o.I1),ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),Y([(0,o.mA)(null)],t.prototype,"default",void 0),Y([(0,o.mA)("65px")],t.prototype,"width",void 0),Y([(0,o.mA)(_.ah)],t.prototype,"types",void 0),t}(o.I1),oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),Y([(0,o.mA)("#ff0000")],t.prototype,"default",void 0),Y([(0,o.mA)("Palette")],t.prototype,"mode",void 0),Y([(0,o.mA)(10)],t.prototype,"columns",void 0),Y([(0,o.mA)(_.T8)],t.prototype,"colorCode",void 0),Y([(0,o.mA)(!1)],t.prototype,"modeSwitcher",void 0),t}(o.I1),re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),Y([(0,o.mA)("#ffff00")],t.prototype,"default",void 0),Y([(0,o.mA)("Palette")],t.prototype,"mode",void 0),Y([(0,o.mA)(10)],t.prototype,"columns",void 0),Y([(0,o.mA)(_.oR)],t.prototype,"colorCode",void 0),Y([(0,o.mA)(!1)],t.prototype,"modeSwitcher",void 0),t}(o.I1),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),Y([(0,o.mA)(_.$I)],t.prototype,"types",void 0),t}(o.I1),se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),Y([(0,o.mA)(_.K7)],t.prototype,"types",void 0),t}(o.I1),le=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),de=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},he=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return le(t,e),de([(0,o.mA)([])],t.prototype,"styles",void 0),de([(0,o.mA)([])],t.prototype,"scripts",void 0),t}(o.I1),pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return le(t,e),de([(0,o.mA)(!1)],t.prototype,"enable",void 0),de([(0,o.mA)(null)],t.prototype,"attributes",void 0),de([(0,o.pr)({},he)],t.prototype,"resources",void 0),t}(o.I1),ce=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ue=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ce(t,e),ue([(0,o.mA)(!1)],t.prototype,"enable",void 0),ue([(0,o.mA)(!0)],t.prototype,"onSelection",void 0),t}(o.I1),ge=n(8237);function fe(e,t,n,i){var o;n?o=t.contentModule.getDocument().querySelector("body"):o=t.element;if(Object.keys(e).length)for(var r=0,a=Object.keys(e);r<a.length;r++){var s=a[r];if("class"===s)o.classList.add(e[s]);else if("disabled"===s&&"disabled"===e[s])t.enabled=!1,t.setEnable();else if("readonly"===s&&"readonly"===e[s])t.readonly=!0,t.setReadOnly(i);else if("style"===s)o.setAttribute("style",e[s]);else if("tabindex"===s)t.inputElement.setAttribute("tabindex",e[s]);else if("placeholder"===s)t.placeholder=e[s],t.setPlaceHolder();else{["name","required"].indexOf(s)>-1?t.valueContainer.setAttribute(s,e[s]):o.setAttribute(s,e[s])}}}var be=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.showFullScreen=function(e){var t=this;if(!0!==this.parent.toolbarSettings.enable||"Markdown"===this.parent.editorMode||(0,o.hX)(this.parent.quickToolbarModule)||this.parent.quickToolbarModule.hideQuickToolbars(),this.scrollableParent=(0,r.Ue)(this.parent.element),!this.parent.element.classList.contains(s.Wl)){var n={cancel:!1,requestType:"Maximize",targetItem:"Maximize",args:e};this.parent.trigger(a.eY,n,(function(n){n.cancel||(t.parent.toolbarSettings.enableFloating&&!t.parent.inlineMode.enable&&t.parent.toolbarSettings.enable&&(t.parent.getToolbarElement().style.width="100%",t.parent.getToolbarElement().style.top="0px"),t.parent.element.classList.add(s.Wl),t.toggleParentOverflow(!0),t.parent.setContentHeight(),t.parent.toolbarModule&&(t.parent.getBaseToolbarObject().toolbarObj.items[0].properties||t.parent.getBaseToolbarObject().toolbarObj.removeItems(0),o.Pw.isDevice&&t.parent.toolbarModule.removeFixedTBarClass(),t.parent.toolbarModule.updateItem({targetItem:"Maximize",updateItem:"Minimize",baseToolbar:t.parent.getBaseToolbarObject()})),t.parent.trigger(a.wn,{requestType:"Maximize",targetItem:"Maximize",args:e}))}))}},e.prototype.hideFullScreen=function(e){var t=this;if(!0!==this.parent.toolbarSettings.enable||"Markdown"===this.parent.editorMode||(0,o.hX)(this.parent.quickToolbarModule)||this.parent.quickToolbarModule.hideQuickToolbars(),this.parent.element.classList.contains(s.Wl)){var n={cancel:!1,requestType:"Minimize",targetItem:"Minimize",args:e};this.parent.trigger(a.eY,n,(function(n){if(!n.cancel){t.parent.element.classList.remove(s.Wl);for(var i=document.querySelectorAll(".e-rte-overflow"),r=0;r<i.length;r++)(0,o.vy)([i[r]],["e-rte-overflow"]);t.parent.setContentHeight(),t.parent.toolbarModule&&(t.parent.getBaseToolbarObject().toolbarObj.items[0].properties||t.parent.getBaseToolbarObject().toolbarObj.removeItems(0),t.parent.toolbarModule.updateItem({targetItem:"Minimize",updateItem:"Maximize",baseToolbar:t.parent.getBaseToolbarObject()}),o.Pw.isDevice&&t.parent.inlineMode.enable&&t.parent.toolbarModule.addFixedTBarClass()),t.parent.trigger(a.wn,{requestType:"Minimize",targetItem:"Minimize",args:e})}}))}},e.prototype.toggleParentOverflow=function(e){if(!(0,o.hX)(this.scrollableParent))for(var t=0;t<this.scrollableParent.length;t++)if("#document"===this.scrollableParent[t].nodeName){var n=document.querySelector("body");(0,o.iQ)([n],["e-rte-overflow"])}else{n=this.scrollableParent[t];(0,o.iQ)([n],["e-rte-overflow"])}},e.prototype.onKeyDown=function(e){var t=e.args;switch(t.action){case"full-screen":this.showFullScreen(e.args),t.preventDefault();break;case"escape":this.hideFullScreen(e.args),t.preventDefault()}},e.prototype.addEventListener=function(){this.parent.on(a.u2,this.onKeyDown,this),this.parent.on(a.zr,this.destroy,this)},e.prototype.removeEventListener=function(){this.parent.off(a.u2,this.onKeyDown),this.parent.off(a.zr,this.destroy)},e.prototype.destroy=function(){this.parent.element.classList.contains(s.Wl)&&this.toggleParentOverflow(!1);for(var e=document.querySelectorAll(".e-rte-overflow"),t=0;t<e.length;t++)(0,o.vy)([e[t]],["e-rte-overflow"]);this.removeEventListener()},e}(),ve=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on(a.tn,this.enterHandler,this),this.parent.on(a.zr,this.destroy,this)},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.removeEventListener=function(){this.parent.off(a.tn,this.enterHandler),this.parent.off(a.zr,this.destroy)},e.prototype.getRangeNode=function(){this.range=this.parent.getRange(),this.startNode="#text"===this.range.startContainer.nodeName?this.range.startContainer.parentElement:this.range.startContainer,this.endNode="#text"===this.range.endContainer.nodeName?this.range.endContainer.parentElement:this.range.endContainer},e.prototype.enterHandler=function(e){var t=this;this.getRangeNode();var n=!0;if(!(0,o.hX)(this.startNode.closest("TABLE"))&&!(0,o.hX)(this.endNode.closest("TABLE"))){n=!1;for(var i=this.startNode,r=i;!this.parent.formatter.editorManager.domNode.isBlockNode(i);)r=i,i=i.parentElement;n="TD"!==r.tagName}if(13===e.args.which&&"Enter"===e.args.code&&(0,o.hX)(this.startNode.closest("LI"))&&(0,o.hX)(this.endNode.closest("LI"))&&n&&(0,o.hX)(this.startNode.closest("PRE"))&&(0,o.hX)(this.endNode.closest("PRE"))){var s=e.args.shiftKey,l={cancel:!1,name:a.eY,requestType:s?"ShiftEnterAction":"EnterAction",originalEvent:e.args};this.parent.trigger(a.eY,l,(function(i){if(!i.cancel){if(t.range.startOffset!==t.range.endOffset||t.range.startContainer!==t.range.endContainer)if(t.range.deleteContents(),"#text"===t.range.startContainer.nodeName&&0===t.range.startContainer.textContent.length&&t.range.startContainer.parentElement!==t.parent.inputElement)"BR"===t.parent.enterKey?t.range.startContainer.parentElement.innerHTML="&#8203;":t.range.startContainer.parentElement.innerHTML="<br>";else if(t.range.startContainer===t.parent.inputElement&&""===t.range.startContainer.innerHTML){t.range.startContainer.innerHTML="<br>";var r=t.range.startContainer.childNodes[t.range.startOffset];t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),r,0)}else if(t.parent.inputElement===t.range.startContainer){if("#text"===(r=t.range.startContainer.childNodes[t.range.startOffset]).nodeName&&0===r.textContent.length)t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),r,r.previousSibling.textContent.length);else if(t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),r,r.textContent.length>=0?0:1),0===r.previousSibling.textContent.length)(0,o.Yo)(r.previousSibling);else if(0===r.textContent.length){for(var l=r.previousSibling.lastChild;"#text"!==l.nodeName;)l=l.lastChild;t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),l,l.textContent.length),(0,o.Yo)(r)}else if("BR"!==t.parent.enterKey&&0!==r.previousSibling.textContent.length&&0!==r.textContent.length)return void e.args.preventDefault();t.getRangeNode()}if(t.range.startContainer===t.range.endContainer&&t.range.startOffset===t.range.endOffset&&t.range.startContainer===t.parent.inputElement&&(t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),t.range.startContainer.childNodes[t.range.startOffset],0),t.getRangeNode()),"P"===t.parent.enterKey&&!s||"DIV"===t.parent.enterKey&&!s||"P"===t.parent.shiftEnterKey&&s||"DIV"===t.parent.shiftEnterKey&&s){var d=void 0;d=n&&t.parent.formatter.editorManager.domNode.isBlockNode(t.startNode)?t.startNode:t.parent.formatter.editorManager.domNode.blockParentNode(t.startNode);var h=!1,p=!1;if(0==t.range.startOffset||0==t.range.endOffset||t.range.startContainer!==t.range.endContainer||!(0,o.hX)(d.childNodes[0])&&"IMG"===d.childNodes[0].nodeName)0===t.range.startOffset&&0===t.range.endOffset&&(p=!0);else{var c=t.range.startContainer.textContent.substring(0,t.range.startOffset);160!=c.charCodeAt(t.range.startOffset-1)&&0===c.trim().length&&(p=!0)}if(t.removeBRElement(d),(0===t.range.startOffset&&0===t.range.endOffset||p)&&((0,o.hX)(t.range.startContainer.previousSibling)||"IMG"!==t.range.startContainer.previousSibling.nodeName&&"BR"!==t.range.startContainer.previousSibling.nodeName)){var u=void 0,m=void 0;"IMG"===t.range.startContainer.nodeName?(m=t.createInsertElement(s),h=!0,u=!1):0!==d.textContent.trim().length?(m=t.parent.formatter.editorManager.nodeCutter.SplitNode(t.range,d,!1).cloneNode(!0),u=!1):(m=t.parent.formatter.editorManager.nodeCutter.SplitNode(t.range,d,!0).cloneNode(!0),u=!0);for(var g=t.createInsertElement(s);m.firstChild;)g.appendChild(m.firstChild);if(d.parentElement.insertBefore(g,d),!u){l=g;for(var f=void 0;!(0,o.hX)(l)&&"#text"!==l.nodeName;)f=l,l=l.lastChild;f.innerHTML="<br>",h||(0,o.Yo)(d)}t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),g.nextElementSibling,0)}else if(0!==d.textContent.length||!(0,o.hX)(d.childNodes[0])&&"IMG"===d.childNodes[0].nodeName){m=t.parent.formatter.editorManager.nodeCutter.SplitNode(t.range,d,!0);if((0,o.hX)(m.childNodes[0])||"#text"!==m.childNodes[0].nodeName||0!==m.childNodes[0].textContent.length||(0,o.Yo)(m.childNodes[0]),0===m.textContent.trim().length){var b=t.parent.createElement("br");if("A"===t.startNode.nodeName){var v=t.startNode.parentElement;t.startNode.parentElement.insertBefore(b,t.startNode),(0,o.Yo)(t.startNode),t.startNode=v}else t.startNode.appendChild(b);"\n"===m.childNodes[0].textContent&&(0,o.Yo)(m.childNodes[0]),t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),t.startNode,0)}if(("P"===t.parent.enterKey||"DIV"===t.parent.enterKey)&&!s||("DIV"===t.parent.shiftEnterKey||"P"===t.parent.shiftEnterKey)&&s){for(var y=t.createInsertElement(s);m.firstChild;)y.appendChild(m.firstChild);t.parent.formatter.editorManager.domNode.insertAfter(y,m),(0,o.Yo)(m),t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),t.parent.formatter.editorManager.domNode.isBlockNode(t.startNode)?y:t.startNode,0)}}else if((0,o.hX)(d.children[0])||"BR"===d.children[0].tagName){(g=t.createInsertElement(s)).innerHTML="<br>",t.parent.formatter.editorManager.domNode.insertAfter(g,d),t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),g,0)}else{var m=t.parent.formatter.editorManager.nodeCutter.SplitNode(t.range,d,!1).cloneNode(!0);t.parent.formatter.editorManager.domNode.insertAfter(m,d),t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),m,m.textContent.length>=0?0:1)}e.args.preventDefault()}if("BR"===t.parent.enterKey&&!s||"BR"===t.parent.shiftEnterKey&&s){var C=void 0;if(t.parent.formatter.editorManager.domNode.isBlockNode(t.startNode))C=t.startNode;else{for(var S=t.startNode,E=S;!t.parent.formatter.editorManager.domNode.isBlockNode(S);)E=S,S=S.parentElement;C=S===t.parent.inputElement?E:S}t.removeBRElement(C);for(var w=C.lastChild;!(0,o.hX)(w)&&"#text"!==w.nodeName&&"BR"!==w.nodeName;)w=w.lastChild;var T=t.range.startContainer===w?t.range.startContainer.textContent.length:C.textContent.length;if(C!==t.parent.inputElement&&t.parent.formatter.editorManager.domNode.isBlockNode(C)&&t.range.startOffset===t.range.endOffset&&t.range.startOffset===T){var k=t.parent.createElement("br");if("BR"===w.nodeName&&0===C.textContent.length)t.parent.formatter.editorManager.domNode.insertAfter(k,w);else{var N=t.parent.createElement("br");t.parent.formatter.editorManager.domNode.insertAfter(k,t.range.startContainer),t.parent.formatter.editorManager.domNode.insertAfter(N,t.range.startContainer)}t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),k,0)}else if((0,o.hX)(C)||C===t.parent.inputElement||"BR"===C.nodeName)t.insertBRElement();else if(0===C.textContent.trim().length||1===C.textContent.trim().length&&8203===C.textContent.charCodeAt(0)){m=t.parent.formatter.editorManager.nodeCutter.SplitNode(t.range,C,!0).cloneNode(!0);t.parent.formatter.editorManager.domNode.insertAfter(m,C);var L=t.parent.createElement("br");m.parentElement.insertBefore(L,m),t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),m,0)}else{m=void 0,L=t.parent.createElement("br");if(0!==t.range.startOffset||0!==t.range.endOffset||(0,o.hX)(C.previousSibling)||"BR"!==C.previousSibling.nodeName)t.insertBRElement();else{m=t.parent.formatter.editorManager.nodeCutter.SplitNode(t.range,C,!1).cloneNode(!0),t.parent.formatter.editorManager.domNode.insertAfter(L,C),t.insertFocusContent();for(l=L.nextSibling;!(0,o.hX)(l)&&"#text"!==l.nodeName;)l=l.lastChild;t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),l,0)}}e.args.preventDefault()}t.parent.trigger(a.wn,{requestType:s?"ShiftEnterAction":"EnterAction",args:e.args})}}))}},e.prototype.removeBRElement=function(e){-1!=o.Pw.userAgent.indexOf("Firefox")&&this.range.endOffset===e.textContent.length&&"BR"===e.lastChild.nodeName&&(0,o.Yo)(e.lastChild)},e.prototype.insertBRElement=function(){var e=!1,t=this.parent.createElement("br");if("BR"===this.startNode.nodeName&&"BR"===this.endNode.nodeName&&0===this.range.startOffset&&this.range.startOffset===this.range.endOffset?(this.parent.formatter.editorManager.domNode.insertAfter(t,this.startNode),e=!0):(this.startNode!==this.parent.inputElement||(0,o.hX)(this.range.startContainer.previousSibling)||"BR"!==this.range.startContainer.previousSibling.nodeName||0!==this.range.startContainer.textContent.length||(e=!0),this.range.insertNode(t)),e||!(0,o.hX)(t.nextElementSibling)&&"BR"===t.nextElementSibling.tagName||!(0,o.hX)(t.nextSibling)&&t.nextSibling.textContent.length>0)this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),(0,o.hX)(t.nextSibling)?t:t.nextSibling,0),e=!1;else{var n=this.parent.createElement("br");this.range.insertNode(n),this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),t,0)}},e.prototype.insertFocusContent=function(){0===this.range.startContainer.textContent.length&&("#text"===this.range.startContainer.nodeName?this.range.startContainer.parentElement.innerHTML="&#8203;":this.range.startContainer.innerHTML="&#8203;")},e.prototype.createInsertElement=function(e){var t;return"DIV"===this.parent.enterKey&&!e||"DIV"===this.parent.shiftEnterKey&&e?t=this.parent.createElement("div"):("P"===this.parent.enterKey&&!e||"P"===this.parent.shiftEnterKey&&e)&&(t=this.parent.createElement("p")),t},e}(),ye=n(134),Ce=n(6815),Se=function(){function e(e){this.parent=e}return e.prototype.render=function(e){var t;return e.beforeOpen=this.beforeOpen.bind(this),e.open=this.open.bind(this),(0,o.hX)(e.close)&&(e.close=this.close.bind(this)),e.beforeClose=this.beforeClose.bind(this),(t=new Ce.lG(e)).isStringTemplate=!0,t},e.prototype.beforeOpen=function(e){this.parent.trigger(a.oc,e,this.beforeOpenCallback.bind(this,e))},e.prototype.beforeOpenCallback=function(e){e.cancel&&this.parent.notify(a.XY,null)},e.prototype.open=function(e){this.parent.trigger(a.JY,e)},e.prototype.beforeClose=function(e){this.parent.trigger(a.ex,e,(function(e){e.cancel||e.container.classList.contains("e-popup-close")&&(e.cancel=!0)}))},e.prototype.close=function(e){this.parent.trigger(a.rU,e)},e}(),Ee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),we=function(){return we=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},we.apply(this,arguments)},Te=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},ke=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.defaultResetValue=null,i.isResizeInitialized=!1,i.isFocusOut=!1,i.isRTE=!1,i.isBlur=!0,i.needsID=!0,i}return Ee(t,e),t.prototype.requiredModules=function(){var e=[];return this.toolbarSettings.enable&&(e.push({member:"toolbar",args:[this,this.serviceLocator]}),e.push({member:"link",args:[this,this.serviceLocator]}),e.push({member:"table",args:[this,this.serviceLocator]}),e.push({member:"image",args:[this,this.serviceLocator]}),this.quickToolbarSettings.enable&&e.push({member:"quickToolbar",args:[this,this.serviceLocator]})),this.showCharCount&&e.push({member:"count",args:[this,this.serviceLocator]}),"Markdown"===this.editorMode&&e.push({member:"markdownEditor",args:[this,this.serviceLocator]}),"HTML"===this.editorMode&&(e.push({member:"htmlEditor",args:[this,this.serviceLocator]}),e.push({member:"pasteCleanup",args:[this,this.serviceLocator]})),this.fileManagerSettings.enable&&e.push({member:"fileManager",args:[this,this.serviceLocator]}),this.enableResize&&e.push({member:"resize",args:[this]}),e},t.prototype.updateEnable=function(){this.enabled?((0,o.vy)([this.element],s.a6),this.element.setAttribute("aria-disabled","false"),(0,o.hX)(this.htmlAttributes.tabindex)?this.inputElement.setAttribute("tabindex","0"):this.inputElement.setAttribute("tabindex",this.htmlAttributes.tabindex)):(this.getToolbar()&&((0,o.vy)(this.getToolbar().querySelectorAll("."+s.ax),s.ax),(0,o.vy)([this.getToolbar()],[s.Ps,s.gT])),(0,o.iQ)([this.element],s.a6),this.element.tabIndex=-1,this.element.setAttribute("aria-disabled","true"),this.inputElement.setAttribute("tabindex","-1"))},t.prototype.setEnable=function(){this.updateEnable(),this.enabled?this.eventInitializer():this.unWireEvents()},t.prototype.preRender=function(){this.onBlurHandler=this.blurHandler.bind(this),this.onFocusHandler=this.focusHandler.bind(this),this.onResizeHandler=this.resizeHandler.bind(this),this.clickPoints={clientX:0,clientY:0},this.initialValue=this.value,this.serviceLocator=new b.q,this.initializeServices(),this.setContainer(),this.persistData(),(0,o.sN)(this.element,{width:(0,o.IV)(this.width)}),(0,o.uK)(this.element,{role:"application"})},t.prototype.persistData=function(){if(this.enablePersistence&&"TEXTAREA"===this.originalElement.tagName){this.element.id=this.originalElement.id+"_wrapper";var e=window.localStorage.getItem(this.getModuleName()+this.element.id);(0,o.hX)(e)||""===e||this.setProperties(JSON.parse(e),!0)}},t.prototype.setContainer=function(){this.originalElement=this.element.cloneNode(!0),null!==this.value&&null===this.valueTemplate||this.setValue(),this.element.hasAttribute("tabindex")&&(this.htmlAttributes={tabindex:this.element.getAttribute("tabindex")},this.element.removeAttribute("tabindex")),this.element.innerHTML="";for(var e=["class","style","id","ejs-for"],t={},n=0;n<this.element.attributes.length;n++)-1!==e.indexOf(this.element.attributes[n].name)||/^data-val/.test(this.element.attributes[n].name)||(t[this.element.attributes[n].name]=this.element.getAttribute(this.element.attributes[n].name));if((0,o.X$)(t,this.htmlAttributes,t),this.setProperties({htmlAttributes:t},!0),(0,o.hX)(this.htmlAttributes.id)||(this.element.id=this.htmlAttributes.id),"TEXTAREA"===this.element.tagName){var i=this.createElement("div",{className:this.element.getAttribute("class")});this.element.innerHTML="",this.element.parentElement.insertBefore(i,this.element),this.valueContainer=this.element,(0,o.vy)([this.valueContainer],this.element.getAttribute("class").split(" ")),this.element=i}else this.valueContainer=this.createElement("textarea",{id:this.getID()+"-value"});this.valueContainer.name=this.getID(),(0,o.iQ)([this.valueContainer],s.Gp),this.element.appendChild(this.valueContainer)},t.prototype.getPersistData=function(){return this.addOnPersist(["value"])},t.prototype.focusIn=function(){this.enabled&&(this.inputElement.focus(),this.focusHandler({}))},t.prototype.focusOut=function(){this.enabled&&(this.inputElement.blur(),this.blurHandler({}))},t.prototype.selectAll=function(){this.notify(a.Ub,{})},t.prototype.selectRange=function(e){this.notify(a.N$,{range:e})},t.prototype.getSelection=function(){var e="";return this.notify(a.no,{callBack:function(t){e=t}}),e},t.prototype.executeCommand=function(e,t,n){if(t=this.htmlPurifier(e,t),"HTML"===this.editorMode){var i=this.getRange();this.iframeSettings.enable&&this.formatter.editorManager.nodeSelection.Clear(this.element.ownerDocument),(!(!this.iframeSettings.enable||i.startContainer!==this.inputElement)||!this.inputElement.contains(i.startContainer))&&this.focusIn()}var o=f[e];n&&n.undo&&n.undo&&0===this.formatter.getUndoRedoStack().length&&this.formatter.saveData(),this.formatter.editorManager.execCommand(o.command,o.subCommand?o.subCommand:t||o.value,null,null,t||o.value,t||o.value),n&&n.undo&&(this.formatter.saveData(),this.formatter.enableUndo(this)),this.setPlaceHolder(),this.notify(a.a7,{})},t.prototype.htmlPurifier=function(e,t){if("HTML"===this.editorMode)switch(e){case"insertHTML":this.enableHtmlSanitizer&&(t="string"===typeof t?this.htmlEditorModule.sanitizeHelper(t):this.htmlEditorModule.sanitizeHelper(t.outerHTML));break;case"insertTable":(0,o.hX)(t.width)&&(t.width={minWidth:this.tableSettings.minWidth,maxWidth:this.tableSettings.maxWidth,width:this.tableSettings.width});break;case"insertImage":var n=this.createElement("img",{attrs:{src:t.url}}),i=n.outerHTML;this.enableHtmlSanitizer&&(i=this.htmlEditorModule.sanitizeHelper(n.outerHTML));var r=""!==i&&this.createElement("div",{innerHTML:i}).firstElementChild.getAttribute("src")||null;r=(0,o.hX)(r)?"":r,t.url=r,(0,o.hX)(t.width)&&(t.width={minWidth:this.insertImageSettings.minWidth,maxWidth:this.insertImageSettings.maxWidth,width:this.insertImageSettings.width}),(0,o.hX)(t.height)&&(t.height={minHeight:this.insertImageSettings.minHeight,maxHeight:this.insertImageSettings.maxHeight,height:this.insertImageSettings.height});break;case"createLink":var a=this.createElement("a",{attrs:{href:t.url}}),s=a.outerHTML;this.enableHtmlSanitizer&&(s=this.htmlEditorModule.sanitizeHelper(a.outerHTML));var l=""!==s&&this.createElement("div",{innerHTML:s}).firstElementChild.getAttribute("href")||null;l=(0,o.hX)(l)?"":l,t.url=l}return t},t.prototype.encode=function(e){var t=this.createElement("div");return t.innerText=e.trim(),t.innerHTML.replace(/<br\s*[\/]?>/gi,"\n")},t.prototype.render=function(){this.value&&!this.valueTemplate&&this.setProperties({value:this.serializeValue(this.value)},!0),this.renderModule=new d(this,this.serviceLocator),this.sourceCodeModule=new g(this,this.serviceLocator),this.notify(a.X0,{}),this.trigger(a.Hh),this.RTERender();new y(this);this.notify(a.qO,{}),this.enableXhtml&&this.setProperties({value:this.getXhtml()},!0),this.toolbarSettings.enable&&"Expand"===this.toolbarSettings.type&&!(0,o.hX)(this.getToolbar())&&this.toolbarSettings.items.indexOf("Undo")>-1&&this.toolbarSettings.items.indexOf("Redo")>-1&&this.disableToolbarItem(["Undo","Redo"]),this.setContentHeight(),null!==this.value&&(this.valueContainer.defaultValue=this.value),this.enabled?this.eventInitializer():this.unWireEvents(),this.renderComplete()},t.prototype.eventInitializer=function(){this.wireEvents()},t.prototype.cleanList=function(e){var t=this.getRange(),n=t.startContainer,i=t.endContainer,r=t.startOffset,a=n===i,s="#text"===t.endContainer.nodeName?t.endContainer.parentElement:t.endContainer,l=(0,o.kp)(s,"LI");if(!(0,o.hX)(l)&&s.textContent.length===t.endOffset&&!t.collapsed){l.textContent=l.textContent.trim(),l.textContent.length-1;for(var d=l;"#text"!==d.nodeName;)d=d.lastChild;this.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(),a?d:n,d,r,d.textContent.length)}},t.prototype.keyDown=function(e){if(this.notify(a.u2,{member:"keydown",args:e}),this.restrict(e),"HTML"===this.editorMode&&this.cleanList(e),"HTML"===this.editorMode&&(8===e.which&&"Backspace"===e.code||46===e.which&&"Delete"===e.code)){var t=this.getRange(),n="#text"===t.startContainer.nodeName?t.startContainer.parentElement:t.startContainer;if((0,o.kp)(n,"pre")&&8===e.which&&8203===t.startContainer.textContent.charCodeAt(t.startOffset-1)||46===e.which&&8203===t.startContainer.textContent.charCodeAt(t.startOffset)){var i=new RegExp(String.fromCharCode(8203),"g"),r=8===e.which?t.startOffset-1:t.startOffset;t.startContainer.textContent=t.startContainer.textContent.replace(i,""),this.formatter.editorManager.nodeSelection.setCursorPoint(this.contentModule.getDocument(),t.startContainer,r)}else if("Backspace"===e.code&&8===e.which&&8203===t.startContainer.textContent.charCodeAt(0)&&t.collapsed){var s=t.startContainer.parentElement,l=void 0,d=void 0;for(d=0;d<s.childNodes.length;d++)s.childNodes[d]===t.startContainer&&(l=d);var h=!0,p=[];for(d=l;d>=0;d--)3===s.childNodes[d].nodeType&&8203===s.childNodes[d].textContent.charCodeAt(0)&&h?p.push(d):h=!1;if(p.length>0)for(d=p.length-1;d>0;d--)s.childNodes[p[d]].textContent="";this.formatter.editorManager.nodeSelection.setCursorPoint(this.contentModule.getDocument(),t.startContainer,t.startOffset)}}if(0===this.formatter.getUndoRedoStack().length&&this.formatter.saveData(),"insert-link"!==e.action&&(e.action&&"paste"!==e.action&&"space"!==e.action||9===e.which||"Backspace"===e.code&&8===e.which))switch(this.formatter.process(this,null,e),e.action){case"toolbar-focus":if(this.toolbarSettings.enable){this.toolbarModule.baseToolbar.toolbarObj.element.querySelector('.e-toolbar-item[aria-disabled="false"][title] [tabindex]').focus()}break;case"escape":this.contentModule.getEditPanel().focus()}(0,o.hX)(this.placeholder)||((0,o.hX)(this.placeHolderWrapper)||1===this.inputElement.textContent.length?this.setPlaceHolder():this.placeHolderWrapper.style.display="none"),this.autoResize()},t.prototype.keyUp=function(e){this.notify(a.LL,{member:"keyup",args:e}),"KeyX"!==e.code||88!==e.which||88!==e.keyCode||!e.ctrlKey||""!==this.inputElement.innerHTML&&"<br>"!==this.inputElement.innerHTML||(this.inputElement.innerHTML=(0,ye.kf)((0,ye.Bu)(this),this));var t=32===e.which||13===e.which||8===e.which||46===e.which;("shift"!==e.key&&!e.ctrlKey&&e.key&&1===e.key.length||t||"Markdown"===this.editorMode&&("shift"!==e.key&&!e.ctrlKey&&e.key&&1===e.key.length||t)&&!this.inlineMode.enable)&&this.formatter.onKeyHandler(this,e),(this.inputElement&&0!==this.inputElement.textContent.length||this.element.querySelectorAll(".e-toolbar-item.e-active").length>0)&&this.notify(a.Vx,{args:e}),(0,o.hX)(this.placeholder)||"Enter"===e.key&&13===e.keyCode||"<p><br></p>"!==this.inputElement.innerHTML&&"<div><br></div>"!==this.inputElement.innerHTML&&"<br>"!==this.inputElement.innerHTML||this.setPlaceHolder()},t.prototype.serializeValue=function(e){return"HTML"!==this.editorMode||(0,o.hX)(e)||(this.enableHtmlEncode?(e=this.htmlEditorModule.sanitizeHelper((0,ye.D4)(e)),e=this.encode(e)):e=this.htmlEditorModule.sanitizeHelper(e)),e},t.prototype.sanitizeHtml=function(e){return this.serializeValue(e)},t.prototype.updateValue=function(e){if((0,o.hX)(e)){var t=this.inputElement.innerHTML;this.setProperties({value:(0,ye.Jz)(t)?null:t})}else this.setProperties({value:e})},t.prototype.triggerEditArea=function(e){if((0,ye.wU)()){var t=e.touches?e.changedTouches[0]:e;this.clickPoints.clientX===t.clientX&&this.clickPoints.clientY===t.clientY&&this.notify(a.ot,{member:"editAreaClick",args:e})}else this.notify(a.ot,{member:"editAreaClick",args:e})},t.prototype.notifyMouseUp=function(e){var t=e.touches?e.changedTouches[0]:e;this.notify(a.Je,{member:"mouseUp",args:e,touchData:{prevClientX:this.clickPoints.clientX,prevClientY:this.clickPoints.clientY,clientX:t.clientX,clientY:t.clientY}}),this.inputElement&&("HTML"===this.editorMode&&0!==this.inputElement.textContent.length||"Markdown"===this.editorMode&&0!==this.inputElement.value.length)&&this.notify(a.Vx,{args:e}),this.triggerEditArea(e)},t.prototype.mouseUp=function(e){if(this.quickToolbarSettings.showOnRightClick&&o.Pw.isDevice){var t=e.target,n=(0,o.kp)(t,"table");if(t&&"A"===t.nodeName||"IMG"===t.nodeName||"TD"===t.nodeName||"TH"===t.nodeName||"TABLE"===t.nodeName||n&&this.contentModule.getEditPanel().contains(n))return}if(this.notifyMouseUp(e),3===e.detail){var i=this.getRange(),r=this.formatter.editorManager.domNode.getSelection();/\s+$/.test(r.toString())&&(((0,o.hX)(i.startContainer.parentElement)||((0,o.hX)(i.startContainer.parentElement.nextSibling)||3===i.startContainer.parentElement.nextSibling.nodeType&&!/\s+$/.test(i.startContainer.parentElement.nextSibling.textContent))&&i.startOffset!==i.endOffset)&&"li"!==i.startContainer.parentElement.tagName.toLocaleLowerCase()||(i.setStart(i.startContainer,i.startOffset),i.setEnd(i.startContainer,i.startContainer.textContent.length)))}},t.prototype.ensureModuleInjected=function(e){return this.getInjectedModules().indexOf(e)>=0},t.prototype.onCopy=function(){this.contentModule.getDocument().execCommand("copy",!1,null)},t.prototype.onCut=function(){this.contentModule.getDocument().execCommand("cut",!1,null)},t.prototype.onPaste=function(e){var t=this,n={originalEvent:e,cancel:!1,requestType:"Paste"};this.trigger(a.eY,n,(function(n){var i=t.getText().trim().length-t.getSelection().length+((0,o.hX)(e)||(0,o.hX)(e.clipboardData)?0:e.clipboardData.getData("text/plain").length);if("Markdown"!==t.editorMode)if(!n.cancel&&"true"===t.inputElement.contentEditable&&(-1===t.maxLength||i<=t.maxLength))if((0,o.hX)(t.pasteCleanupModule)){var r={requestType:"Paste",editorMode:t.editorMode,event:e},s=null,l=!1;e&&!(0,o.hX)(e.clipboardData)&&(s=e.clipboardData.getData("text/plain"),l=e.clipboardData.getData("text/html").indexOf("MsoNormal")>0);var d=e&&e.clipboardData&&e.clipboardData.items.length>0?e.clipboardData.items[0].getAsFile():null;null!==s&&t.notify(a.oh,{file:d,args:e,text:s,isWordPaste:l}),setTimeout((function(){t.formatter.onSuccess(t,r)}),0)}else t.notify(a.hY,{args:e});else e.preventDefault();else-1===t.maxLength||i<=t.maxLength||e.preventDefault()}))},t.prototype.clipboardAction=function(e,t){switch(e.toLowerCase()){case"cut":this.onCut(),this.formatter.onSuccess(this,{requestType:"Cut",editorMode:this.editorMode,event:t});break;case"copy":this.onCopy(),this.formatter.onSuccess(this,{requestType:"Copy",editorMode:this.editorMode,event:t});break;case"paste":this.onPaste(t)}},t.prototype.destroy=function(){if(!this.isDestroyed&&this.isRendered)if(null!==this.element.offsetParent||(0,o.hX)(this.toolbarModule)){if(this.notify(a.zr,{}),this.destroyDependentModules(),(0,o.hX)(this.timeInterval)||(clearInterval(this.timeInterval),this.timeInterval=null),this.unWireEvents(),"TEXTAREA"===this.originalElement.tagName){this.element.parentElement.insertBefore(this.valueContainer,this.element),this.valueContainer.id=this.getID(),this.valueContainer.removeAttribute("name"),(0,o.Yo)(this.element),""!==this.originalElement.innerHTML.trim()?(this.valueContainer.value=this.originalElement.innerHTML.trim(),this.setProperties({value:(0,o.hX)(this.initialValue)?null:this.initialValue},!0)):this.valueContainer.value=this.valueContainer.defaultValue,this.element=this.valueContainer;for(var t=0;t<this.originalElement.classList.length;t++)(0,o.iQ)([this.element],this.originalElement.classList[t]);(0,o.vy)([this.element],s.Gp)}else""!==this.originalElement.innerHTML.trim()?(this.element.innerHTML=this.originalElement.innerHTML.trim(),this.setProperties({value:(0,o.hX)(this.initialValue)?null:this.initialValue},!0)):this.element.innerHTML="";if(this.placeholder&&this.placeHolderWrapper&&(this.placeHolderWrapper=null),!(0,o.hX)(this.cssClass)){var n=this.cssClass.split(" ");for(t=0;t<n.length;t++)""!==n[t].trim()&&(0,o.vy)([this.element],n[t])}this.removeHtmlAttributes(),this.removeAttributes(),e.prototype.destroy.call(this),this.isRendered=!1,this.enablePersistence&&window.localStorage.removeItem(this.getModuleName()+this.element.id)}else this.toolbarModule.destroy()},t.prototype.removeHtmlAttributes=function(){if(this.htmlAttributes)for(var e=Object.keys(this.htmlAttributes),t=0;t<e.length&&this.element.hasAttribute(e[t]);t++)this.element.removeAttribute(e[t])},t.prototype.removeAttributes=function(){this.enabled||(0,o.vy)([this.element],s.a6),this.enableRtl&&(0,o.vy)([this.element],s.gi),this.readonly&&(0,o.vy)([this.element],s.YP),""!==this.element.style.width&&""===this.originalElement.style.width&&this.element.style.removeProperty("width"),""!==this.element.style.height&&""===this.originalElement.style.height&&this.element.style.removeProperty("height"),this.element.removeAttribute("aria-disabled"),this.element.removeAttribute("role"),this.element.removeAttribute("tabindex")},t.prototype.destroyDependentModules=function(){this.renderModule.destroy(),this.formatter.editorManager.undoRedoManager.destroy(),this.sourceCodeModule.destroy()},t.prototype.getContent=function(){return this.contentModule.getPanel()},t.prototype.getText=function(){return this.contentModule.getText()},t.prototype.getSelectedHtml=function(){var e=this.createElement("div"),t=this.contentModule.getDocument().getSelection();if(t.rangeCount>0){var n=t.getRangeAt(0).cloneContents();e.appendChild(n)}return e.innerHTML},t.prototype.showInlineToolbar=function(){if(this.inlineMode.enable){var e=this.getRange(),t="#text"===e.endContainer.nodeName?e.endContainer.parentElement:e.endContainer,n=e.getClientRects()[0].left,i=e.getClientRects()[0].top;this.quickToolbarModule.showInlineQTBar(n,i,t)}},t.prototype.hideInlineToolbar=function(){this.quickToolbarModule.hideInlineQTBar()},t.prototype.getModuleName=function(){return"richtexteditor"},t.prototype.onPropertyChanged=function(t,n){for(var i=0,r=Object.keys(t);i<r.length;i++){var l=r[i];switch(l){case"enterKey":case"value":var d=void 0;d="enterKey"===l?null===this.value||"<div><br></div>"===this.value||"<p><br></p>"===this.value||"<br>"===this.value?null:this.value:t[l];var p="HTML"===this.editorMode?(0,ye.kf)(d,this):d;(!(0,o.hX)(d)&&""!==d||"enterKey"===l)&&(this.value=this.serializeValue(this.enableHtmlEncode?this.encode((0,ye.D4)(p)):p)),this.updatePanelValue(),this.setPlaceHolder(),this.notify(a.hM,{module:"XhtmlValidation",newProp:t,oldProp:n}),this.enableXhtml&&this.setProperties({value:this.getXhtml()},!0),this.showCharCount&&this.countModule.refresh();break;case"valueTemplate":this.setValue(),this.showCharCount&&this.countModule.refresh();break;case"width":this.setWidth(t[l]),this.toolbarSettings.enable&&!this.inlineMode.enable&&(this.toolbarModule.refreshToolbarOverflow(),this.resizeHandler());break;case"height":this.setHeight(t[l]),this.setContentHeight(),this.autoResize();break;case"readonly":this.setReadOnly(!1);break;case"cssClass":this.element.classList.remove(n[l]),this.setCssClass(t[l]);break;case"enabled":this.setEnable();break;case"enableRtl":this.updateRTL();break;case"placeholder":this.placeholder=t[l],this.setPlaceHolder();break;case"htmlAttributes":fe(this.htmlAttributes,this,!1,!1);break;case"iframeSettings":var c=n[l];if(c.resources){var u=this.contentModule.getDocument().querySelector("head"),m=void 0;c.resources.scripts&&(m=u.querySelectorAll("."+s.ZL),this.removeSheets(m)),c.resources.styles&&(m=u.querySelectorAll("."+s.Fy),this.removeSheets(m))}this.setIframeSettings();break;case"locale":e.prototype.refresh.call(this);break;case"inlineMode":this.notify(a.Ay,{module:"quickToolbar",newProp:t,oldProp:n}),this.setContentHeight();break;case"toolbarSettings":this.notify(a.Ay,{module:"toolbar",newProp:t,oldProp:n}),this.setContentHeight();break;case"maxLength":this.showCharCount&&this.countModule.refresh();break;case"showCharCount":t[l]&&this.countModule?this.countModule.renderCount():!1===t[l]&&this.countModule&&this.countModule.destroy();break;case"enableHtmlEncode":this.updateValueData(),this.updatePanelValue(),this.setPlaceHolder(),this.showCharCount&&this.countModule.refresh();break;case"undoRedoSteps":case"undoRedoTimer":this.formatter.editorManager.observer.notify(h.Hj,{newProp:t,oldProp:n});break;case"enableXhtml":this.notify(a.hM,{module:"XhtmlValidation",newProp:t,oldProp:n});break;case"quickToolbarSettings":t.quickToolbarSettings.showOnRightClick?this.wireContextEvent():this.unWireContextEvent(),this.notify(a.Ay,{newProp:t,oldProp:n});break;default:this.notify(a.Ay,{newProp:t,oldProp:n})}}},t.prototype.updateValueData=function(){this.enableHtmlEncode?this.setProperties({value:this.encode((0,ye.D4)(this.inputElement.innerHTML))},!0):this.setProperties({value:/<[a-z][\s\S]*>/i.test(this.inputElement.innerHTML)?this.inputElement.innerHTML:(0,ye.D4)(this.inputElement.innerHTML)})},t.prototype.removeSheets=function(e){var t;for(t=0;t<e.length;t++)(0,o.Yo)(e[t])},t.prototype.updatePanelValue=function(){var e=this.value;e=this.enableHtmlEncode&&this.value?(0,ye.D4)(e):e;var t=this.element.querySelector(".e-rte-srctextarea");e?(t&&"block"===t.style.display&&(t.value=this.value),this.valueContainer&&(this.valueContainer.value=this.enableHtmlEncode?this.value:e),"HTML"===this.editorMode&&this.inputElement&&this.inputElement.innerHTML.trim()!==e.trim()?this.inputElement.innerHTML=e:"Markdown"===this.editorMode&&this.inputElement&&this.inputElement.value.trim()!==e.trim()&&(this.inputElement.value=e)):(t&&"block"===t.style.display&&(t.value=""),"HTML"===this.editorMode?"DIV"===this.enterKey?this.inputElement.innerHTML="<div><br/></div>":"BR"===this.enterKey?this.inputElement.innerHTML="<br/>":(this.inputElement.innerHTML="<p><br/></p>",""===e&&this.formatter&&this.inputElement&&this.formatter.editorManager.nodeSelection.setCursorPoint(this.contentModule.getDocument(),this.inputElement.firstElementChild,this.inputElement.firstElementChild.childElementCount)):this.inputElement.value="",this.valueContainer&&(this.valueContainer.value="")),this.showCharCount&&this.countModule.refresh()},t.prototype.setHeight=function(e){this.element.style.height="auto"!==e?(0,o.IV)(e):"auto","Expand"===this.toolbarSettings.type&&("string"===typeof this.height&&this.height.indexOf("px")>-1||"number"===typeof this.height)?this.element.classList.add(s.ag):this.element.classList.remove(s.ag)},t.prototype.setPlaceHolder=function(){this.inputElement&&this.placeholder&&!0!==this.iframeSettings.enable&&("Markdown"!==this.editorMode?(this.placeHolderWrapper||(this.placeHolderWrapper=this.createElement("span",{className:"rte-placeholder e-rte-placeholder"}),this.inputElement&&this.inputElement.parentElement.insertBefore(this.placeHolderWrapper,this.inputElement),(0,o.uK)(this.placeHolderWrapper,{style:"font-size: 14px; padding: 16px; margin-left: 0px; margin-right: 0px;"})),this.placeHolderWrapper.innerHTML=this.placeholder,0!==this.inputElement.textContent.length||(0,o.hX)(this.inputElement.firstChild)||"BR"!==this.inputElement.firstChild.nodeName&&("P"!==this.inputElement.firstChild.nodeName&&"DIV"!==this.inputElement.firstChild.nodeName||(0,o.hX)(this.inputElement.firstChild.firstChild)||"BR"!==this.inputElement.firstChild.firstChild.nodeName)?this.placeHolderWrapper.style.display="none":this.placeHolderWrapper.style.display="block"):this.inputElement.setAttribute("placeholder",this.placeholder))},t.prototype.setWidth=function(e){"auto"!==e?(0,o.sN)(this.element,{width:(0,o.IV)(this.width)}):this.element.style.width="auto"},t.prototype.setCssClass=function(e){if(!(0,o.hX)(e))for(var t=e.split(" "),n=0;n<t.length;n++)""!==t[n].trim()&&this.element.classList.add(t[n])},t.prototype.updateRTL=function(){this.notify(a.S7,{enableRtl:this.enableRtl}),this.enableRtl?this.element.classList.add(s.gi):this.element.classList.remove(s.gi)},t.prototype.updateReadOnly=function(){this.notify(a.QH,{editPanel:this.inputElement,mode:this.readonly})},t.prototype.setReadOnly=function(e){this.updateReadOnly(),e||(this.readonly&&this.enabled?this.unbindEvents():this.enabled&&this.bindEvents())},t.prototype.print=function(){var e,t=this,n={element:this.inputElement,requestType:"print",cancel:!1};this.trigger(a.eY,n,(function(n){if(e=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth),"msie"===o.Pw.info.name&&e.resizeTo(screen.availWidth,screen.availHeight),e=(0,o.yy)(t.inputElement,e),!n.cancel){t.trigger(a.wn,{requestType:"print"})}}))},t.prototype.refreshUI=function(){this.renderModule.refresh()},t.prototype.showFullScreen=function(){this.fullScreenModule.showFullScreen()},t.prototype.enableToolbarItem=function(e,t){this.toolbarModule.enableTBarItems(this.getBaseToolbarObject(),e,!0,t)},t.prototype.disableToolbarItem=function(e,t){this.toolbarModule.enableTBarItems(this.getBaseToolbarObject(),e,!1,t)},t.prototype.removeToolbarItem=function(e){this.toolbarModule.removeTBarItems(e)},t.prototype.getRange=function(){return this.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument())},t.prototype.initializeServices=function(){this.serviceLocator.register("rendererFactory",new v.O),this.serviceLocator.register("rteLocale",this.localeObj=new o.Wo(this.getModuleName(),ge.q,this.locale)),this.serviceLocator.register("dialogRenderObject",new Se(this))},t.prototype.RTERender=function(){var e=this.serviceLocator.getService("rendererFactory");this.contentModule=e.getRenderer(l.nJ.Content),this.fullScreenModule=new be(this),this.enterKeyModule=new ve(this),this.renderModule.render(),this.inputElement=this.contentModule.getEditPanel(),this.setHeight(this.height),fe(this.htmlAttributes,this,!1,!0),this.iframeSettings&&this.setIframeSettings(),this.setCssClass(this.cssClass),this.updateEnable(),this.setPlaceHolder(),this.updateRTL(),this.updateReadOnly(),this.updatePanelValue(),this.enableHtmlEncode&&!(0,o.hX)(this.value)&&this.setProperties({value:this.encode((0,ye.D4)(this.value))})},t.prototype.setIframeSettings=function(){if(this.iframeSettings.resources){var e=this.iframeSettings.resources.styles,t=this.iframeSettings.resources.scripts;this.iframeSettings.resources.scripts.length>0&&this.InjectSheet(!0,t),this.iframeSettings.resources.styles.length>0&&this.InjectSheet(!1,e)}this.iframeSettings.attributes&&fe(this.iframeSettings.attributes,this,!0,!1)},t.prototype.InjectSheet=function(e,t){try{if(t&&t.length>0)for(var n=this.contentModule.getDocument().querySelector("head"),i=0;i<t.length;i++)if(e){var o=this.createScriptElement();o.src=t[i],n.appendChild(o)}else{var r=this.createStyleElement();r.href=t[i],n.appendChild(r)}}catch(a){return}},t.prototype.createScriptElement=function(){var e=this.createElement("script",{className:s.ZL});return e.type="text/javascript",e},t.prototype.createStyleElement=function(){var e=this.createElement("link",{className:s.Fy});return e.rel="stylesheet",e},t.prototype.setValue=function(){if(this.valueTemplate)if("string"===typeof this.valueTemplate)this.setProperties({value:this.valueTemplate});else{for(var e=(0,o.wE)(this.valueTemplate)("",this,"valueTemplate"),t=0;t<e.length;t++){var n=e[t];(0,o.BC)([n],this.element)}this.setProperties({value:this.element.innerHTML.trim()})}else{var i=!(0,o.hX)(this.element.innerHTML)&&this.element.innerHTML.replace(/<(\/?|\!?)(!--!--)>/g,"").trim();""!==i&&("TEXTAREA"===this.element.tagName?this.setProperties({value:(0,ye.D4)(i)}):this.setProperties({value:i}))}},t.prototype.updateResizeFlag=function(){this.isResizeInitialized=!0},t.prototype.getInsertImgMaxWidth=function(){var e=this.insertImageSettings.maxWidth,t=this.contentModule.getEditPanel(),n=window.getComputedStyle(t),i=t.offsetWidth-(14+parseFloat(n.paddingLeft.split("px")[0])+parseFloat(n.paddingRight.split("px")[0])+parseFloat(n.marginLeft.split("px")[0])+parseFloat(n.marginRight.split("px")[0]));return(0,o.hX)(e)?i:e},t.prototype.setContentHeight=function(e,t){var n,i,r=0,a="string"===typeof this.height&&this.height.indexOf("%")>-1,d=this.sourceCodeModule.getPanel()&&"block"===this.sourceCodeModule.getPanel().parentElement.style.display?this.sourceCodeModule.getPanel().parentElement:this.contentModule.getPanel(),h=this.element.offsetHeight;0!==h||"auto"===this.height||this.getToolbar()||(h=parseInt(this.height,10),a&&(i=this.height));var p=this.getToolbar()?this.toolbarModule.getToolbarHeight():0,c=this.element.querySelector("."+s.x7),u=this.enableResize?(0,o.hX)(c)?0:c.offsetHeight+8:0,m=this.getToolbar()?this.toolbarModule.getExpandTBarPopHeight():0;if(this.toolbarSettings.type===l.Yv.Expand&&t&&"preview"!==e?(n="auto"===this.height&&0===u?"auto":h-(p+m+u)+"px",r=this.toolbarSettings.enableFloating?0:m):n="auto"!==this.height||this.element.classList.contains("e-rte-full-screen")||this.isResizeInitialized?a&&i?i:h-(p+u)+"px":"auto","windowResize"!==e&&(this.iframeSettings.enable?"auto"!==n&&(0,o.sN)(d,{height:n,marginTop:r+"px"}):(0,o.sN)(d,{height:n,marginTop:r+"px"})),this.iframeSettings.enable&&"sourceCode"===e){var g=(0,o.Lt)("."+s.Jt,this.element);(0,o.sN)(g,{height:n,marginTop:r+"px"})}if(this.toolbarSettings.enableFloating&&this.getToolbar()&&!this.inlineMode.enable){var f=(t?p+m:p)+"px";(0,o.sN)(this.getToolbar().parentElement,{height:f})}0===u&&this.autoResize()},t.prototype.getHtml=function(){return this.serializeValue(this.contentModule.getEditPanel().innerHTML)},t.prototype.getXhtml=function(){var e=this.value;return!(0,o.hX)(e)&&this.enableXhtml&&(e=this.htmlEditorModule.xhtmlValidation.selfEncloseValidation(e)),e},t.prototype.showSourceCode=function(){this.readonly||this.notify(a.X5,{})},t.prototype.getCharCount=function(){var e="Markdown"===this.editorMode?this.inputElement.value.trim():this.inputElement.textContent.trim();return"Markdown"!==this.editorMode&&-1!==e.indexOf("\u200b")?e.replace(/\u200B/g,"").length:e.length},t.prototype.showDialog=function(e){e===l.hs.InsertLink?this.notify(a.WM,{}):e===l.hs.InsertImage?this.notify(a.jD,{}):e===l.hs.InsertTable&&this.notify(a.s9,{})},t.prototype.closeDialog=function(e){e===l.hs.InsertLink?this.notify(a.Ds,{}):e===l.hs.InsertImage?this.notify(a.IH,{}):e===l.hs.InsertTable&&this.notify(a.NM,{})},t.prototype.getBaseToolbarObject=function(){return!this.inlineMode.enable||o.Pw.isDevice&&!(0,ye.wU)()?this.toolbarModule&&this.toolbarModule.getBaseToolbar():this.quickToolbarModule&&this.quickToolbarModule.getInlineBaseToolbar()},t.prototype.getToolbar=function(){return this.toolbarModule?this.toolbarModule.getToolbarElement():null},t.prototype.getToolbarElement=function(){return this.toolbarModule&&this.toolbarModule.getToolbarElement()},t.prototype.getID=function(){return"TEXTAREA"===this.originalElement.tagName?this.valueContainer.id:this.element.id},t.prototype.mouseDownHandler=function(e){var t=e.touches?e.changedTouches[0]:e;(0,o.iQ)([this.element],[s.uC]),this.preventDefaultResize(e),this.notify(a.cT,{args:e}),this.clickPoints={clientX:t.clientX,clientY:t.clientY}},t.prototype.preventImgResize=function(e){"img"===e.target.nodeName.toLocaleLowerCase()&&e.preventDefault()},t.prototype.preventDefaultResize=function(e){"msie"===o.Pw.info.name?this.contentModule.getEditPanel().addEventListener("mscontrolselect",this.preventImgResize):"mozilla"===o.Pw.info.name&&(this.contentModule.getDocument().execCommand("enableObjectResizing",!1,"false"),this.contentModule.getDocument().execCommand("enableInlineTableEditing",!1,"false"))},t.prototype.defaultResize=function(e){"msie"===o.Pw.info.name?this.contentModule.getEditPanel().removeEventListener("mscontrolselect",this.preventImgResize):"mozilla"===o.Pw.info.name&&(this.contentModule.getDocument().execCommand("enableObjectResizing",!0,"true"),this.contentModule.getDocument().execCommand("enableInlineTableEditing",!0,"true"))},t.prototype.resizeHandler=function(){var e=!1;document.body.contains(this.element)?(this.toolbarSettings.enable&&!this.inlineMode.enable&&(this.toolbarModule.refreshToolbarOverflow(),e=this.toolbarModule.baseToolbar.toolbarObj.element.classList.contains(s.P5)),this.setContentHeight("windowResize",e),this.notify(a.L5,null)):document.defaultView.removeEventListener("resize",this.onResizeHandler,!0)},t.prototype.scrollHandler=function(e){this.notify(a.W2,{args:e})},t.prototype.contentScrollHandler=function(e){this.notify(a.Vd,{args:e})},t.prototype.focusHandler=function(e){if(!this.isRTE||this.isFocusOut){this.isRTE=!this.isFocusOut,this.isFocusOut=!1,(0,o.iQ)([this.element],[s.uC]),"HTML"===this.editorMode?this.cloneValue="<p><br></p>"===this.inputElement.innerHTML||"<div><br></div>"===this.inputElement.innerHTML||"<br>"===this.inputElement.innerHTML?null:this.enableHtmlEncode?this.encode((0,ye.D4)(this.inputElement.innerHTML)):this.inputElement.innerHTML:this.cloneValue=""===this.inputElement.value?null:this.inputElement.value;var t=document.activeElement;if((t===this.element||t===this.getToolbarElement()||t===this.contentModule.getEditPanel()||this.iframeSettings.enable&&t===this.contentModule.getPanel()&&e.target&&!e.target.classList.contains("e-img-inner")&&e.target&&e.target.parentElement&&!e.target.parentElement.classList.contains("e-img-wrap")||(0,o.kp)(t,".e-rte-toolbar")===this.getToolbarElement())&&(this.contentModule.getEditPanel().focus(),!(0,o.hX)(this.getToolbarElement()))){this.getToolbarElement().setAttribute("tabindex","-1");for(var n=this.getToolbarElement().querySelectorAll('[tabindex="0"]'),i=0;i<n.length;i++)n[i].setAttribute("tabindex","-1")}this.preventDefaultResize(e),this.trigger("focus",{event:e,isInteracted:0!==Object.keys(e).length}),!(0,o.hX)(this.saveInterval)&&this.saveInterval>0&&!this.autoSaveOnIdle&&(this.timeInterval=setInterval(this.updateValueOnIdle.bind(this),this.saveInterval)),o.Jm.add(document,"mousedown",this.onDocumentClick,this)}if(!(0,o.hX)(this.getToolbarElement())){var r=this.getToolbarElement().querySelectorAll("input,select,button,a,[tabindex]");for(i=0;i<r.length;i++)r[i].classList.contains("e-rte-dropdown-btn")||r[i].classList.contains("e-insert-table-btn")||r[i].hasAttribute("tabindex")&&"-1"===r[i].getAttribute("tabindex")||r[i].setAttribute("tabindex","-1")}},t.prototype.getUpdatedValue=function(){var e;(0,o.hX)(this.tableModule)||this.tableModule.removeResizeElement();var t=this.element.querySelector(".e-rte-srctextarea");return"HTML"===this.editorMode?(e="<p><br></p>"===this.inputElement.innerHTML||"<div><br></div>"===this.inputElement.innerHTML||"<br>"===this.inputElement.innerHTML?null:this.enableHtmlEncode?this.encode((0,ye.D4)(this.inputElement.innerHTML)):this.inputElement.innerHTML,t&&"block"===t.style.display&&(e=t.value)):e=""===this.inputElement.value?null:this.inputElement.value,e},t.prototype.updateValueOnIdle=function(){((0,o.hX)(this.tableModule)||(0,o.hX)(this.inputElement.querySelector(".e-table-box.e-rbox-select")))&&(this.setProperties({value:this.getUpdatedValue()},!0),this.valueContainer.value=this.value,this.invokeChangeEvent())},t.prototype.updateIntervalValue=function(){clearTimeout(this.idleInterval),this.idleInterval=setTimeout(this.updateValueOnIdle.bind(this),0)},t.prototype.updateStatus=function(e){if(!(0,o.hX)(e.html)||!(0,o.hX)(e.markdown)){var t=this.formatter.editorManager.undoRedoManager.getUndoStatus(),n={undo:t.undo,redo:t.redo,html:e.html,markdown:e.markdown};this.trigger(a.Z2,n)}},t.prototype.onDocumentClick=function(e){var t=e.target,n=(0,o.kp)(t,"."+s.bP);this.element.contains(e.target)||document===e.target||n===this.element||(0,o.kp)(t,'[aria-owns="'+this.getID()+'"]')||(this.isBlur=!0,this.isRTE=!1),this.notify(a.dx,{args:e}),"msie"!==o.Pw.info.name&&e.detail>3&&e.preventDefault()},t.prototype.blurHandler=function(e){var t=e.relatedTarget;if(t){var n=(0,o.kp)(t,"."+s.bP);n&&n===this.element?(this.isBlur=!1,t===this.getToolbarElement()&&t.setAttribute("tabindex","-1")):(0,o.kp)(t,'[aria-owns="'+this.getID()+'"]')?this.isBlur=!1:(this.isBlur=!0,t=null)}if(this.isBlur&&(0,o.hX)(t)){(0,o.vy)([this.element],[s.uC]),this.notify(a.T0,{});var i=this.getUpdatedValue();this.setProperties({value:i}),this.notify(a.Vx,{args:e,documentNode:document}),this.invokeChangeEvent(),this.isFocusOut=!0,this.isBlur=!1,(0,ye.Pt)(this.valueContainer,"focusout"),this.defaultResize(e),this.trigger("blur",{event:e,isInteracted:0!==Object.keys(e).length}),(0,o.hX)(this.timeInterval)||(clearInterval(this.timeInterval),this.timeInterval=null),o.Jm.remove(document,"mousedown",this.onDocumentClick)}else this.isRTE=!0},t.prototype.contentChanged=function(){this.autoSaveOnIdle&&((0,o.hX)(this.saveInterval)||(clearTimeout(this.timeInterval),this.timeInterval=setTimeout(this.updateIntervalValue.bind(this),this.saveInterval)))},t.prototype.invokeChangeEvent=function(){var e={value:this.enableXhtml?this.getXhtml():this.value};this.value!==this.cloneValue&&(this.trigger("change",e),this.cloneValue=this.value)},t.prototype.wireScrollElementsEvents=function(){this.scrollParentElements=(0,r.Ue)(this.element);for(var e=0,t=this.scrollParentElements;e<t.length;e++){var n=t[e];o.Jm.add(n,"scroll",this.scrollHandler,this)}this.iframeSettings.enable||o.Jm.add(this.contentModule.getPanel(),"scroll",this.contentScrollHandler,this)},t.prototype.wireContextEvent=function(){this.quickToolbarSettings.showOnRightClick&&(o.Jm.add(this.inputElement,"contextmenu",this.contextHandler,this),o.Pw.isDevice&&(this.touchModule=new o.Up(this.inputElement,{tapHold:this.touchHandler.bind(this),tapHoldThreshold:500})))},t.prototype.unWireContextEvent=function(){o.Jm.remove(this.inputElement,"contextmenu",this.contextHandler),o.Pw.isDevice&&this.touchModule&&this.touchModule.destroy()},t.prototype.unWireScrollElementsEvents=function(){this.scrollParentElements=(0,r.Ue)(this.element);for(var e=0,t=this.scrollParentElements;e<t.length;e++){var n=t[e];o.Jm.remove(n,"scroll",this.scrollHandler)}this.iframeSettings.enable||o.Jm.remove(this.contentModule.getPanel(),"scroll",this.contentScrollHandler)},t.prototype.touchHandler=function(e){this.notifyMouseUp(e.originalEvent),this.triggerEditArea(e.originalEvent)},t.prototype.contextHandler=function(e){var t=(0,o.kp)(e.target,"a, table, img");!1!==this.inlineMode.onSelection&&((0,o.hX)(t)||!this.inputElement.contains(t)||"IMG"!==t.tagName&&"TABLE"!==t.tagName&&"A"!==t.tagName)||e.preventDefault()},t.prototype.resetHandler=function(){var e=this.valueContainer.defaultValue.trim();this.setProperties({value:""===e?null:e})},t.prototype.autoResize=function(){var e=this;if("auto"===this.height){if("Markdown"===this.editorMode)setTimeout((function(){e.setAutoHeight(e.inputElement)}),0);else if(this.iframeSettings.enable){var t=this.element.querySelector("#"+this.getID()+"_rte-view");setTimeout((function(){e.setAutoHeight(t)}),100),this.inputElement.style.overflow="hidden"}}else this.inputElement.style.overflow=null},t.prototype.setAutoHeight=function(e){(0,o.hX)(e)||(e.style.height="",e.style.height=this.inputElement.scrollHeight+"px",e.style.overflow="hidden")},t.prototype.wireEvents=function(){this.element.addEventListener("focusin",this.onFocusHandler,!0),this.element.addEventListener("focusout",this.onBlurHandler,!0),this.on(a.a7,this.contentChanged,this),this.on(a.rx,this.updateResizeFlag,this),this.on(a.e4,this.updateStatus,this),this.readonly&&this.enabled||this.bindEvents()},t.prototype.restrict=function(e){if(this.maxLength>=0){for(var t="Markdown"===this.editorMode?this.contentModule.getText():e.currentTarget.textContent.trim(),n=[8,16,17,37,38,39,40,46,65],i=void 0,o=0;o<=n.length-1;o++)if(e.which===n[o]){if(e.ctrlKey&&65===e.which)return;if(65!==e.which)return void(i=n[o])}t.length>=this.maxLength&&-1!==this.maxLength&&e.which!==i&&e.preventDefault()}},t.prototype.bindEvents=function(){this.keyboardModule=new m(this.inputElement,{keyAction:this.keyDown.bind(this),keyConfigs:we({},this.formatter.keyConfig,this.keyConfig),eventName:"keydown"});var e=(0,o.kp)(this.valueContainer,"form");e&&o.Jm.add(e,"reset",this.resetHandler,this),o.Jm.add(this.inputElement,"keyup",this.keyUp,this),o.Jm.add(this.inputElement,"paste",this.onPaste,this),o.Jm.add(this.inputElement,o.Pw.touchEndEvent,(0,o.sg)(this.mouseUp,30),this),o.Jm.add(this.inputElement,o.Pw.touchStartEvent,this.mouseDownHandler,this),this.wireContextEvent(),this.formatter.editorManager.observer.on(h.ck,this.editorKeyDown,this),this.element.ownerDocument.defaultView.addEventListener("resize",this.onResizeHandler,!0),this.iframeSettings.enable&&(o.Jm.add(this.inputElement,"focusin",this.focusHandler,this),o.Jm.add(this.inputElement,"focusout",this.blurHandler,this),o.Jm.add(this.inputElement.ownerDocument,"scroll",this.contentScrollHandler,this),o.Jm.add(this.inputElement.ownerDocument,o.Pw.touchStartEvent,this.onIframeMouseDown,this)),this.wireScrollElementsEvents()},t.prototype.onIframeMouseDown=function(e){this.isBlur=!1,this.notify(a.KK,e)},t.prototype.editorKeyDown=function(e){switch(e.event.action){case"copy":this.onCopy();break;case"cut":this.onCut()}!e.callBack||"copy"!==e.event.action&&"cut"!==e.event.action&&"delete"!==e.event.action||e.callBack({requestType:e.event.action,editorMode:"HTML",event:e.event})},t.prototype.unWireEvents=function(){this.element.removeEventListener("focusin",this.onFocusHandler,!0),this.element.removeEventListener("focusout",this.onBlurHandler,!0),this.off(a.a7,this.contentChanged),this.off(a.rx,this.updateResizeFlag),this.off(a.e4,this.updateStatus),this.readonly&&this.enabled||this.unbindEvents()},t.prototype.unbindEvents=function(){this.keyboardModule&&this.keyboardModule.destroy();var e=(0,o.kp)(this.valueContainer,"form");e&&o.Jm.remove(e,"reset",this.resetHandler),o.Jm.remove(this.inputElement,"keyup",this.keyUp),o.Jm.remove(this.inputElement,"paste",this.onPaste),o.Jm.remove(this.inputElement,o.Pw.touchEndEvent,(0,o.sg)(this.mouseUp,30)),o.Jm.remove(this.inputElement,o.Pw.touchStartEvent,this.mouseDownHandler),this.unWireContextEvent(),this.formatter&&this.formatter.editorManager.observer.off(h.ck,this.editorKeyDown),this.element.ownerDocument.defaultView.removeEventListener("resize",this.onResizeHandler,!0),this.iframeSettings.enable&&(o.Jm.remove(this.inputElement,"focusin",this.focusHandler),o.Jm.remove(this.inputElement,"focusout",this.blurHandler),o.Jm.remove(this.inputElement.ownerDocument,"scroll",this.contentScrollHandler),o.Jm.remove(this.inputElement.ownerDocument,o.Pw.touchStartEvent,this.onIframeMouseDown)),this.unWireScrollElementsEvents()},Te([(0,o.pr)({},V)],t.prototype,"toolbarSettings",void 0),Te([(0,o.pr)({},Z)],t.prototype,"quickToolbarSettings",void 0),Te([(0,o.pr)({},ee)],t.prototype,"pasteCleanupSettings",void 0),Te([(0,o.pr)({},pe)],t.prototype,"iframeSettings",void 0),Te([(0,o.pr)({},K)],t.prototype,"insertImageSettings",void 0),Te([(0,o.pr)({},$)],t.prototype,"tableSettings",void 0),Te([(0,o.mA)(0)],t.prototype,"floatingToolbarOffset",void 0),Te([(0,o.pr)({},me)],t.prototype,"inlineMode",void 0),Te([(0,o.pr)({},G)],t.prototype,"fileManagerSettings",void 0),Te([(0,o.mA)("100%")],t.prototype,"width",void 0),Te([(0,o.mA)(!1)],t.prototype,"enablePersistence",void 0),Te([(0,o.mA)(!1)],t.prototype,"enableResize",void 0),Te([(0,o.mA)({})],t.prototype,"htmlAttributes",void 0),Te([(0,o.mA)(null)],t.prototype,"placeholder",void 0),Te([(0,o.mA)(!1)],t.prototype,"autoSaveOnIdle",void 0),Te([(0,o.mA)(!1)],t.prototype,"readonly",void 0),Te([(0,o.mA)(!0)],t.prototype,"enabled",void 0),Te([(0,o.mA)(!0)],t.prototype,"enableHtmlSanitizer",void 0),Te([(0,o.mA)(!1)],t.prototype,"enableHtmlEncode",void 0),Te([(0,o.mA)(!1)],t.prototype,"enableXhtml",void 0),Te([(0,o.mA)("auto")],t.prototype,"height",void 0),Te([(0,o.mA)(null)],t.prototype,"cssClass",void 0),Te([(0,o.mA)(null)],t.prototype,"value",void 0),Te([(0,o.mA)("P")],t.prototype,"enterKey",void 0),Te([(0,o.mA)("BR")],t.prototype,"shiftEnterKey",void 0),Te([(0,o.mA)(30)],t.prototype,"undoRedoSteps",void 0),Te([(0,o.mA)(300)],t.prototype,"undoRedoTimer",void 0),Te([(0,o.mA)("HTML")],t.prototype,"editorMode",void 0),Te([(0,o.mA)(null)],t.prototype,"keyConfig",void 0),Te([(0,o.mA)(!1)],t.prototype,"showCharCount",void 0),Te([(0,o.mA)(!1)],t.prototype,"enableTabKey",void 0),Te([(0,o.mA)(!1)],t.prototype,"enableAutoUrl",void 0),Te([(0,o.mA)(-1)],t.prototype,"maxLength",void 0),Te([(0,o.pr)({},ie)],t.prototype,"format",void 0),Te([(0,o.pr)({},ae)],t.prototype,"numberFormatList",void 0),Te([(0,o.pr)({},se)],t.prototype,"bulletFormatList",void 0),Te([(0,o.pr)({},te)],t.prototype,"fontFamily",void 0),Te([(0,o.pr)({},ne)],t.prototype,"fontSize",void 0),Te([(0,o.pr)({},oe)],t.prototype,"fontColor",void 0),Te([(0,o.pr)({},re)],t.prototype,"backgroundColor",void 0),Te([(0,o.mA)(null)],t.prototype,"valueTemplate",void 0),Te([(0,o.mA)(1e4)],t.prototype,"saveInterval",void 0),Te([(0,o.Jh)()],t.prototype,"actionBegin",void 0),Te([(0,o.Jh)()],t.prototype,"actionComplete",void 0),Te([(0,o.Jh)()],t.prototype,"beforeDialogOpen",void 0),Te([(0,o.Jh)()],t.prototype,"dialogOpen",void 0),Te([(0,o.Jh)()],t.prototype,"beforeDialogClose",void 0),Te([(0,o.Jh)()],t.prototype,"dialogClose",void 0),Te([(0,o.Jh)()],t.prototype,"beforeQuickToolbarOpen",void 0),Te([(0,o.Jh)()],t.prototype,"quickToolbarOpen",void 0),Te([(0,o.Jh)()],t.prototype,"quickToolbarClose",void 0),Te([(0,o.Jh)()],t.prototype,"toolbarStatusUpdate",void 0),Te([(0,o.Jh)()],t.prototype,"updatedToolbarStatus",void 0),Te([(0,o.Jh)()],t.prototype,"imageSelected",void 0),Te([(0,o.Jh)()],t.prototype,"beforeImageUpload",void 0),Te([(0,o.Jh)()],t.prototype,"imageUploading",void 0),Te([(0,o.Jh)()],t.prototype,"imageUploadSuccess",void 0),Te([(0,o.Jh)()],t.prototype,"imageUploadFailed",void 0),Te([(0,o.Jh)()],t.prototype,"imageRemoving",void 0),Te([(0,o.Jh)()],t.prototype,"afterImageDelete",void 0),Te([(0,o.Jh)()],t.prototype,"created",void 0),Te([(0,o.Jh)()],t.prototype,"destroyed",void 0),Te([(0,o.Jh)()],t.prototype,"beforeSanitizeHtml",void 0),Te([(0,o.Jh)()],t.prototype,"blur",void 0),Te([(0,o.Jh)()],t.prototype,"toolbarClick",void 0),Te([(0,o.Jh)()],t.prototype,"focus",void 0),Te([(0,o.Jh)()],t.prototype,"change",void 0),Te([(0,o.Jh)()],t.prototype,"resizing",void 0),Te([(0,o.Jh)()],t.prototype,"resizeStart",void 0),Te([(0,o.Jh)()],t.prototype,"resizeStop",void 0),Te([(0,o.Jh)()],t.prototype,"beforePasteCleanup",void 0),Te([(0,o.Jh)()],t.prototype,"afterPasteCleanup",void 0),Te([(0,o.Jh)()],t.prototype,"beforeImageDrop",void 0),Te([(0,o.mA)(null)],t.prototype,"formatter",void 0),t=Te([o.kc],t)}(o.uA),Ne=n(3527),Le=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),De=function(e){function t(t){var n=e.call(this,t)||this;return n.initRenderCalled=!1,n.checkInjectedModules=!0,n.immediateRender=!1,n.portals=[],n}return Le(t,e),t.prototype.render=function(){if(!(this.element&&!this.initRenderCalled||this.refreshing)||this.isReactForeceUpdate)return i.createElement("div",this.getDefaultAttributes(),[].concat(this.props.children,this.portals));e.prototype.render.call(this),this.initRenderCalled=!0},t}(ke);(0,Ne.XJ)(De,[Ne.xu,i.Component])},5537:(e,t,n)=>{n.d(t,{FL:()=>l,Hj:()=>p,Oh:()=>m,Q7:()=>g,R:()=>i,R8:()=>h,VD:()=>r,ck:()=>a,fh:()=>u,gf:()=>d,hU:()=>c,hr:()=>o,qv:()=>s});var i="keydown",o="action",r="format-type",a="keydown-handler",s="list-type",l="keyup-handler",d="keyup",h="model_changed_plugin",p="model_changed",c="ms_word_cleanup_plugin",u="ms_word_cleanup",m="onBegin",g="actionBegin"},5453:(e,t,n)=>{n.d(t,{Mv:()=>d,WM:()=>s,fo:()=>l,l2:()=>h,wU:()=>a});var i=n(8452),o=n(5624),r=["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","font","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","strong","strike","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"];function a(){var e=!1;return i.Pw.isDevice&&i.Pw.isIos&&(e=!0),e}function s(e,t){if("BODY"===e.nodeName&&!(0,i.hX)(t)){var n=top.window.document.querySelector(t);(0,i.hX)(n)||n.contentWindow.focus()}}function l(e){var t=document.createElement("div");t.innerHTML=e,t.setAttribute("class","tempDiv");var n=document.createElement("div");if(t.childNodes.length>0){for(var a=void 0,s=void 0,l=void 0;t.firstChild;)"#text"===t.firstChild.nodeName&&(t.firstChild.textContent.indexOf("\n")<0||""!==t.firstChild.textContent.trim())||r.indexOf(t.firstChild.nodeName.toLocaleLowerCase())>=0?(a?s.appendChild(t.firstChild):(l=(0,i.n)("p"),n.appendChild(l),l.appendChild(t.firstChild)),s=l,a=!0):"#text"===t.firstChild.nodeName&&("\n"===t.firstChild.textContent||t.firstChild.textContent.indexOf("\n")>=0&&""===t.firstChild.textContent.trim())?(0,i.Yo)(t.firstChild):(n.appendChild(t.firstChild),a=!1);for(var d=n.querySelectorAll("table"),h=0;h<d.length;h++){"0"===d[h].getAttribute("border")&&d[h].removeAttribute("border");for(var p=d[h].querySelectorAll("td"),c=0;c<p.length;c++)"none"===p[c].style.borderLeft&&p[c].style.removeProperty("border-left"),"none"===p[c].style.borderRight&&p[c].style.removeProperty("border-right"),"none"===p[c].style.borderBottom&&p[c].style.removeProperty("border-bottom"),"none"===p[c].style.borderTop&&p[c].style.removeProperty("border-top"),"none"===p[c].style.border&&p[c].style.removeProperty("border");d[h].classList.contains(o.Qb)||d[h].classList.add(o.Qb)}var u=n.querySelectorAll("img");for(h=0;h<u.length;h++)u[h].classList.contains(o.nw)||u[h].classList.add(o.nw),u[h].classList.contains(o.eh)||u[h].classList.contains(o._L)||u[h].classList.add(o.eh)}return n.innerHTML}function d(e){var t=e;do{t.childNodes.length>0&&(t=t.childNodes[0])}while(t.childNodes.length>0);return t}function h(){return{bold:!1,italic:!1,subscript:!1,superscript:!1,strikethrough:!1,orderedlist:!1,unorderedlist:!1,underline:!1,alignments:null,backgroundcolor:null,fontcolor:null,fontname:null,fontsize:null,formats:null,createlink:!1,insertcode:!1}}},377:(e,t,n)=>{n.d(t,{b:()=>d});var i=n(1411),o=n(5624),r=n(5290),a=n(134),s=n(1011),l=n(8452),d=function(){function e(e,t){this.tools={},this.parent=e,this.locator=t,this.renderFactory=this.locator.getService("rendererFactory"),this.addEventListener(),this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?(0,l.X$)(this.tools,s.Yl,(0,a.mm)(this.parent.toolbarSettings.itemConfigs),!0):this.tools=s.Yl}return e.prototype.addEventListener=function(){this.parent.on(r.S7,this.setRtl,this),this.parent.on(r.zr,this.removeEventListener,this)},e.prototype.removeEventListener=function(){this.parent.off(r.S7,this.setRtl),this.parent.off(r.zr,this.removeEventListener)},e.prototype.setRtl=function(e){(0,l.hX)(this.toolbarObj)||this.toolbarObj.setProperties({enableRtl:e.enableRtl})},e.prototype.getClass=function(e){var t;switch(e){case"fontsize":t="e-rte-inline-size-template";break;case"fontcolor":case"backgroundcolor":t="e-rte-inline-color-template";break;default:t="e-rte-inline-template"}return t},e.prototype.getTemplateObject=function(e,t){var n;switch(e){case"fontcolor":case"backgroundcolor":case"numberformatlist":case"bulletformatlist":n="span";break;default:n="button"}return{command:this.tools[e.toLocaleLowerCase()].command,subCommand:this.tools[e.toLocaleLowerCase()].subCommand,template:this.parent.createElement(n,{id:this.parent.getID()+"_"+t+"_"+this.tools[e.toLocaleLowerCase()].id}).outerHTML,cssClass:this.parent.inlineMode.enable?this.getClass(e):"",tooltipText:(0,a.RE)(e,this.locator)}},e.prototype.getObject=function(e,t){var n=e.toLowerCase();if(-1!==s.XX.indexOf(n))return this.getTemplateObject(n,t);switch(n){case"|":return{type:"Separator"};case"-":return{type:"Separator",cssClass:o.af};default:return{id:this.parent.getID()+"_"+t+"_"+this.tools[n.toLocaleLowerCase()].id,prefixIcon:this.tools[n.toLocaleLowerCase()].icon,tooltipText:(0,a.RE)(n,this.locator),command:this.tools[n.toLocaleLowerCase()].command,subCommand:this.tools[n.toLocaleLowerCase()].subCommand}}},e.prototype.getItems=function(e,t){var n=this;if(this.parent.toolbarSettings.items.length<1)return[];for(var i=[],o=function(e){if("string"===typeof e)i.push(r.getObject(e,t));else{if(!(0,l.hX)(e.click)){var o=e,a=o.click;o.click=function(){o.undo&&0===n.parent.formatter.getUndoRedoStack().length&&n.parent.formatter.saveData(),a.call(n),n.parent.formatter.getUndoRedoStack()[n.parent.formatter.getUndoRedoStack().length-1].text.trim()!==n.parent.inputElement.innerHTML.trim()&&o.undo&&n.parent.formatter.saveData()}}i.push(e)}},r=this,a=0,s=e;a<s.length;a++){o(s[a])}return i},e.prototype.getToolbarOptions=function(e){return{target:e.target,rteToolbarObj:this,items:this.getItems(e.items,e.container),overflowMode:e.mode,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl}},e.prototype.render=function(e){this.toolbarRenderer=this.renderFactory.getRenderer(i.nJ.Toolbar),this.toolbarRenderer.renderToolbar(this.getToolbarOptions(e))},e}()},4217:(e,t,n)=>{n.d(t,{i:()=>d});var i=n(8452),o=n(1411),r=n(5290),a=n(5624),s=n(134),l=n(1011),d=function(){function e(e,t){this.tools={},this.parent=e,this.locator=t,this.renderFactory=this.locator.getService("rendererFactory"),this.addEventListener(),this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?(0,i.X$)(this.tools,l.Yl,(0,s.mm)(this.parent.toolbarSettings.itemConfigs),!0):this.tools=l.Yl}return e.prototype.initializeInstance=function(){this.toolbarRenderer=this.renderFactory.getRenderer(o.nJ.Toolbar)},e.prototype.renderColorPickerInput=function(e){var t=this;this.initializeInstance();var n,o,r=e.containerType,d=e.container;l.XX.forEach((function(l){if(-1!==(0,s.Dx)(l,e.items))switch(l){case"fontcolor":n=t.parent.getID()+"_"+r+"_FontColor_Target";var h=t.parent.createElement("input");h.id=n,h.classList.add(a.jw),document.body.appendChild(h),o={cssClass:t.tools[l.toLocaleLowerCase()].icon+" "+a.bU+" "+a.I6,value:t.tools[l.toLocaleLowerCase()].value,command:t.tools[l.toLocaleLowerCase()].command,subCommand:t.tools[l.toLocaleLowerCase()].subCommand,element:(0,i.Lt)("#"+t.parent.getID()+"_"+r+"_FontColor",d),target:n},t.fontColorPicker=t.toolbarRenderer.renderColorPicker(o,"fontcolor"),t.fontColorDropDown=t.toolbarRenderer.renderColorPickerDropDown(o,"fontcolor",t.fontColorPicker);break;case"backgroundcolor":n=t.parent.getID()+"_"+r+"_BackgroundColor_Target";var p=t.parent.createElement("input");p.id=n,p.classList.add(a.mY),document.body.appendChild(p),o={cssClass:t.tools[l.toLocaleLowerCase()].icon+" "+a.bU+" "+a.I6,value:t.tools[l.toLocaleLowerCase()].value,command:t.tools[l.toLocaleLowerCase()].command,subCommand:t.tools[l.toLocaleLowerCase()].subCommand,element:(0,i.Lt)("#"+t.parent.getID()+"_"+r+"_BackgroundColor",d),target:n},t.backgroundColorPicker=t.toolbarRenderer.renderColorPicker(o,"backgroundcolor"),t.backgroundColorDropDown=t.toolbarRenderer.renderColorPickerDropDown(o,"backgroundcolor",t.backgroundColorPicker,t.defaultColorPicker)}}))},e.prototype.destroy=function(){this.removeEventListener(),this.destroyColorPicker()},e.prototype.destroyColorPicker=function(){var e;(this.fontColorPicker&&!this.fontColorPicker.isDestroyed&&this.fontColorPicker.destroy(),this.backgroundColorPicker&&!this.backgroundColorPicker.isDestroyed&&this.backgroundColorPicker.destroy(),this.fontColorDropDown&&!this.fontColorDropDown.isDestroyed)&&((e=this.fontColorDropDown.element.querySelector(".e-rte-color-content"))&&(0,i.Yo)(e),this.fontColorDropDown.destroy());this.backgroundColorDropDown&&!this.backgroundColorDropDown.isDestroyed&&((e=this.backgroundColorDropDown.element.querySelector(".e-rte-color-content"))&&(this.defaultColorPicker=e.children[0].style.borderBottomColor,(0,i.Yo)(e)),this.backgroundColorDropDown.destroy())},e.prototype.setRtl=function(e){this.fontColorPicker&&(this.fontColorPicker.setProperties({enableRtl:e.enableRtl}),this.fontColorDropDown.setProperties({enableRtl:e.enableRtl})),this.backgroundColorPicker&&(this.backgroundColorPicker.setProperties({enableRtl:e.enableRtl}),this.backgroundColorDropDown.setProperties({enableRtl:e.enableRtl}))},e.prototype.addEventListener=function(){this.parent.on(r.hr,this.renderColorPickerInput,this),this.parent.on(r.S7,this.setRtl,this),this.parent.on(r.zr,this.destroy,this),this.parent.on(r.A_,this.destroyColorPicker,this),this.parent.on(r.Ay,this.onPropertyChanged,this)},e.prototype.onPropertyChanged=function(e){for(var t=e.newProp,n=0,i=Object.keys(t);n<i.length;n++){switch(i[n]){case"fontColor":if(this.fontColorPicker)for(var o=0,r=Object.keys(t.fontColor);o<r.length;o++){switch(r[o]){case"default":this.fontColorPicker.setProperties({value:t.fontColor.default}),this.fontColorDropDown.element.querySelector("."+this.tools.fontcolor.icon).style.borderBottomColor=t.fontColor.default;break;case"mode":this.fontColorPicker.setProperties({mode:t.fontColor.mode});break;case"columns":this.fontColorPicker.setProperties({columns:t.fontColor.columns});break;case"colorCode":this.fontColorPicker.setProperties({presetColors:t.fontColor.colorCode});break;case"modeSwitcher":this.fontColorPicker.setProperties({modeSwitcher:t.fontColor.modeSwitcher})}}break;case"backgroundColor":if(this.backgroundColorPicker)for(var a=0,s=Object.keys(t.backgroundColor);a<s.length;a++){switch(s[a]){case"default":this.backgroundColorPicker.setProperties({value:t.backgroundColor.default}),this.backgroundColorDropDown.element.querySelector("."+this.tools.backgroundcolor.icon).style.borderBottomColor=t.backgroundColor.default;break;case"mode":this.backgroundColorPicker.setProperties({mode:t.backgroundColor.mode});break;case"columns":this.backgroundColorPicker.setProperties({columns:t.backgroundColor.columns});break;case"colorCode":this.backgroundColorPicker.setProperties({presetColors:t.backgroundColor.colorCode});break;case"modeSwitcher":this.backgroundColorPicker.setProperties({modeSwitcher:t.backgroundColor.modeSwitcher})}}}}},e.prototype.removeEventListener=function(){this.parent.off(r.hr,this.renderColorPickerInput),this.parent.off(r.zr,this.destroy),this.parent.off(r.S7,this.setRtl),this.parent.off(r.A_,this.destroyColorPicker),this.parent.off(r.Ay,this.onPropertyChanged)},e}()},2611:(e,t,n)=>{n.d(t,{V:()=>d});var i=n(8452),o=n(1411),r=n(134),a=n(5290),s=n(5624),l=n(1011),d=function(){function e(e,t){this.parent=e,this.locator=t,this.renderFactory=this.locator.getService("rendererFactory"),this.addEventListener()}return e.prototype.initializeInstance=function(){this.toolbarRenderer=this.renderFactory.getRenderer(o.nJ.Toolbar)},e.prototype.beforeRender=function(e){var t=e.item;t.cssClass&&(0,i.iQ)([e.element],t.cssClass),"Alignments"!==t.command&&"JustifyLeft"!==t.subCommand&&"JustifyRight"!==t.subCommand&&"JustifyCenter"!==t.subCommand||e.element.setAttribute("title",(0,r.RE)(t.subCommand.toLocaleLowerCase(),this.locator))},e.prototype.dropdownContent=function(e,t,n){return'<span style="display: inline-flex;width:'+("quick"===t?"auto":e)+'" ><span class="e-rte-dropdown-btn-text">'+n+"</span></span>"},e.prototype.renderDropDowns=function(e){var t=this;this.initializeInstance();var n=e.containerType,o=e.container;l.XX.forEach((function(a){var d=void 0;if(-1!==(0,r.Dx)(a,e.items))switch(a){case"numberformatlist":if(d=(0,i.Lt)("#"+t.parent.getID()+"_"+n+"_NumberFormatList",o),(0,i.hX)(d)||d.classList.contains(s.YW))return;var h=t.parent.numberFormatList.types.slice();h.forEach((function(e){Object.defineProperties(e,{command:{value:"Lists",enumerable:!0},subCommand:{value:"NumberFormatList",enumerable:!0}})})),t.numberFormatListDropDown=t.toolbarRenderer.renderListDropDown({cssClass:"e-order-list "+s.bU+" "+s.I6,itemName:"NumberFormatList",items:h,element:d});break;case"bulletformatlist":if(d=(0,i.Lt)("#"+t.parent.getID()+"_"+n+"_BulletFormatList",o),(0,i.hX)(d)||d.classList.contains(s.YW))return;var p=t.parent.bulletFormatList.types.slice();p.forEach((function(e){Object.defineProperties(e,{command:{value:"Lists",enumerable:!0},subCommand:{value:"BulletFormatList",enumerable:!0}})})),t.bulletFormatListDropDown=t.toolbarRenderer.renderListDropDown({cssClass:"e-unorder-list "+s.bU+" "+s.I6,itemName:"BulletFormatList",items:p,element:d});break;case"formats":if(d=(0,i.Lt)("#"+t.parent.getID()+"_"+n+"_Formats",o),(0,i.hX)(d)||d.classList.contains(s.YW))return;var c=t.parent.format.types.slice();c.forEach((function(e){Object.defineProperties(e,{command:{value:"Formats",enumerable:!0},subCommand:{value:e.value,enumerable:!0}})}));var u=(0,i.hX)(t.parent.format.default)?c[0].text:t.parent.format.default;t.formatDropDown=t.toolbarRenderer.renderDropDownButton({iconCss:"quick"===n?"e-formats e-icons":"",content:t.dropdownContent(t.parent.format.width,n,"quick"===n?"":(0,r.Zl)(c,u,"text","text")),cssClass:s.E1+" "+s.cC+" "+s.Vg,itemName:"Formats",items:c,element:d});break;case"fontname":if(d=(0,i.Lt)("#"+t.parent.getID()+"_"+n+"_FontName",o),(0,i.hX)(d)||d.classList.contains(s.YW))return;var m=t.parent.fontFamily.items.slice();m.forEach((function(e){Object.defineProperties(e,{command:{value:"Font",enumerable:!0},subCommand:{value:"FontName",enumerable:!0}})}));var g=(0,i.hX)(t.parent.fontFamily.default)?m[0].text:t.parent.fontFamily.default;t.fontNameDropDown=t.toolbarRenderer.renderDropDownButton({iconCss:"quick"===n?"e-font-name e-icons":"",content:t.dropdownContent(t.parent.fontFamily.width,n,"quick"===n?"":(0,r.Zl)(m,g,"text","text")),cssClass:s.E1+" "+s.cC+" "+s.JN,itemName:"FontName",items:m,element:d}),(0,i.hX)(t.parent.fontFamily.default)||(t.getEditNode().style.fontFamily=t.parent.fontFamily.default);break;case"fontsize":if(d=(0,i.Lt)("#"+t.parent.getID()+"_"+n+"_FontSize",o),(0,i.hX)(d)||d.classList.contains(s.YW))return;var f=t.parent.fontSize.items.slice();f.forEach((function(e){Object.defineProperties(e,{command:{value:"Font",enumerable:!0},subCommand:{value:"FontSize",enumerable:!0}})}));var b=(0,i.hX)(t.parent.fontSize.default)?f[1].text:t.parent.fontSize.default;t.fontSizeDropDown=t.toolbarRenderer.renderDropDownButton({content:t.dropdownContent(t.parent.fontSize.width,n,(0,r.H3)((0,r.Zl)(f,b.replace(/\s/g,""),"value","text"))),cssClass:s.E1+" "+s.cC+" "+s.p2,itemName:"FontSize",items:f,element:d}),(0,i.hX)(t.parent.fontSize.default)||(t.getEditNode().style.fontSize=t.parent.fontSize.default);break;case"alignments":if(d=(0,i.Lt)("#"+t.parent.getID()+"_"+n+"_Alignments",o),(0,i.hX)(d)||d.classList.contains(s.YW))return;t.alignDropDown=t.toolbarRenderer.renderDropDownButton({iconCss:"e-justify-left e-icons",cssClass:s.E1+" "+s.cC,itemName:"Alignments",items:l.qT,element:d});break;case"align":t.imageAlignmentDropDown(n,o,d);break;case"display":t.imageDisplayDropDown(n,o,d);break;case"tablerows":t.rowDropDown(n,o,d);break;case"tablecolumns":t.columnDropDown(n,o,d);break;case"tablecell":t.cellDropDown(n,o,d);break;case"tablecellverticalalign":t.verticalAlignDropDown(n,o,d);break;case"styles":t.tableStylesDropDown(n,o,d)}}))},e.prototype.getUpdateItems=function(e,t){var n=e.slice();return n.forEach((function(e){Object.defineProperties(e,{command:{value:"Format"===t?"Formats":"Font",enumerable:!0},subCommand:{value:"Format"===t?e.value:t,enumerable:!0}})})),n},e.prototype.onPropertyChanged=function(e){for(var t,n,o=e.newProp,a=0,l=Object.keys(o);a<l.length;a++){switch(l[a]){case"fontFamily":if(this.fontNameDropDown)for(var d=0,h=Object.keys(o.fontFamily);d<h.length;d++){switch(h[d]){case"default":case"width":var p=this.fontNameDropDown.items;t=(0,i.hX)((0,i.kp)(this.fontNameDropDown.element,"."+s.Y4))?"toolbar":"quick";var c=(0,i.hX)(this.parent.fontFamily.default)?p[0].text:this.parent.fontFamily.default;n=this.dropdownContent(this.parent.fontFamily.width,t,"quick"===t?"":(0,r.Zl)(p,c,"text","text")),this.fontNameDropDown.setProperties({content:n}),(0,i.hX)(this.parent.fontFamily.default)?this.getEditNode().style.removeProperty("font-family"):this.getEditNode().style.fontFamily=this.parent.fontFamily.default;break;case"items":this.fontNameDropDown.setProperties({items:this.getUpdateItems(o.fontFamily.items,"FontName")})}}break;case"fontSize":if(this.fontSizeDropDown)for(var u=0,m=Object.keys(o.fontSize);u<m.length;u++){switch(m[u]){case"default":case"width":var g=this.fontSizeDropDown.items;t=(0,i.hX)((0,i.kp)(this.fontSizeDropDown.element,"."+s.Y4))?"toolbar":"quick";var f=(0,i.hX)(this.parent.fontSize.default)?g[1].text:this.parent.fontSize.default;n=this.dropdownContent(this.parent.fontSize.width,t,(0,r.H3)((0,r.Zl)(g,f.replace(/\s/g,""),"value","text"))),this.fontSizeDropDown.setProperties({content:n}),(0,i.hX)(this.parent.fontSize.default)?this.getEditNode().style.removeProperty("font-size"):this.getEditNode().style.fontSize=this.parent.fontSize.default;break;case"items":this.fontSizeDropDown.setProperties({items:this.getUpdateItems(o.fontSize.items,"FontSize")})}}break;case"format":if(this.formatDropDown)for(var b=0,v=Object.keys(o.format);b<v.length;b++){switch(v[b]){case"default":case"width":var y=this.formatDropDown.items;t=(0,i.hX)((0,i.kp)(this.formatDropDown.element,"."+s.Y4))?"toolbar":"quick";var C=(0,i.hX)(this.parent.format.default)?y[0].text:this.parent.format.default;n=this.dropdownContent(this.parent.format.width,t,"quick"===t?"":(0,r.Zl)(y,C,"text","text")),this.formatDropDown.setProperties({content:n});break;case"types":this.formatDropDown.setProperties({items:this.getUpdateItems(o.format.types,"Format")})}}}}},e.prototype.getEditNode=function(){return this.parent.contentModule.getEditPanel()},e.prototype.rowDropDown=function(e,t,n){(n=(0,i.Lt)("#"+this.parent.getID()+"_"+e+"_TableRows",t)).classList.contains(s.YW)||(this.tableRowsDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-rows e-icons",cssClass:s.E1+" "+s.cC+" "+s.tG,itemName:"TableRows",items:l.Kn,element:n}))},e.prototype.columnDropDown=function(e,t,n){(n=(0,i.Lt)("#"+this.parent.getID()+"_"+e+"_TableColumns",t)).classList.contains(s.YW)||(this.tableColumnsDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-columns e-icons",cssClass:s.E1+" "+s.cC+" "+s.tG,itemName:"TableColumns",items:l.Qu,element:n}))},e.prototype.cellDropDown=function(e,t,n){(n=(0,i.Lt)("#"+this.parent.getID()+"_"+e+"_TableCell",t)).classList.contains(s.YW)||(this.tableRowsDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-cell e-icons",cssClass:s.E1+" "+s.cC+" "+s.tG,itemName:"TableCell",items:l.Nu,element:n}))},e.prototype.verticalAlignDropDown=function(e,t,n){(n=(0,i.Lt)("#"+this.parent.getID()+"_"+e+"_TableCellVerticalAlign",t)).classList.contains(s.YW)||(this.tableCellVerticalAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-cell-ver-align e-icons",cssClass:s.E1+" "+s.cC+" "+s.tG,itemName:"TableCellVerticalAlign",items:l.qn,element:n}))},e.prototype.imageDisplayDropDown=function(e,t,n){(n=(0,i.Lt)("#"+this.parent.getID()+"_"+e+"_Display",t)).classList.contains(s.YW)||(this.displayDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-display e-icons",cssClass:s.E1+" "+s.cC+" "+s.tG,itemName:"Display",items:l.ue,element:n}))},e.prototype.imageAlignmentDropDown=function(e,t,n){(n=(0,i.Lt)("#"+this.parent.getID()+"_"+e+"_Align",t)).classList.contains(s.YW)||(this.imageAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-justify-left e-icons",cssClass:s.E1+" "+s.yo+" "+s.tG,itemName:"Align",items:l.$B,element:n}))},e.prototype.tableStylesDropDown=function(e,t,n){(n=(0,i.Lt)("#"+this.parent.getID()+"_"+e+"_Styles",t)).classList.contains(s.YW)||(this.imageAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-style e-icons",cssClass:s.E1+" "+s.yo+" "+s.tG,itemName:"Styles",items:this.parent.tableSettings.styles,element:n}))},e.prototype.removeDropDownClasses=function(e){(0,i.vy)([e],[s.YW,s.E1,s.yo,s.cC])},e.prototype.destroyDropDowns=function(){this.formatDropDown&&(this.removeDropDownClasses(this.formatDropDown.element),this.formatDropDown.destroy()),this.fontNameDropDown&&(this.removeDropDownClasses(this.fontNameDropDown.element),this.fontNameDropDown.destroy()),this.fontSizeDropDown&&(this.removeDropDownClasses(this.fontSizeDropDown.element),this.fontSizeDropDown.destroy()),this.alignDropDown&&(this.removeDropDownClasses(this.alignDropDown.element),this.alignDropDown.destroy()),this.imageAlignDropDown&&(this.removeDropDownClasses(this.imageAlignDropDown.element),this.imageAlignDropDown.destroy()),this.displayDropDown&&(this.removeDropDownClasses(this.displayDropDown.element),this.displayDropDown.destroy()),this.tableRowsDropDown&&(this.removeDropDownClasses(this.tableRowsDropDown.element),this.tableRowsDropDown.destroy()),this.tableColumnsDropDown&&(this.removeDropDownClasses(this.tableColumnsDropDown.element),this.tableColumnsDropDown.destroy()),this.tableCellVerticalAlignDropDown&&(this.removeDropDownClasses(this.tableCellVerticalAlignDropDown.element),this.tableCellVerticalAlignDropDown.destroy()),this.numberFormatListDropDown&&(this.removeDropDownClasses(this.numberFormatListDropDown.element),this.numberFormatListDropDown.destroy()),this.bulletFormatListDropDown&&(this.removeDropDownClasses(this.bulletFormatListDropDown.element),this.bulletFormatListDropDown.destroy())},e.prototype.setRtl=function(e){this.formatDropDown&&this.formatDropDown.setProperties({enableRtl:e.enableRtl}),this.fontNameDropDown&&this.fontNameDropDown.setProperties({enableRtl:e.enableRtl}),this.fontSizeDropDown&&this.fontSizeDropDown.setProperties({enableRtl:e.enableRtl}),this.alignDropDown&&this.alignDropDown.setProperties({enableRtl:e.enableRtl}),this.imageAlignDropDown&&this.imageAlignDropDown.setProperties({enableRtl:e.enableRtl}),this.displayDropDown&&this.displayDropDown.setProperties({enableRtl:e.enableRtl}),this.numberFormatListDropDown&&this.numberFormatListDropDown.setProperties({enableRtl:e.enableRtl}),this.bulletFormatListDropDown&&this.bulletFormatListDropDown.setProperties({enableRtl:e.enableRtl})},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(a.QL,this.beforeRender,this),this.parent.on(a.KK,this.onIframeMouseDown,this),this.parent.on(a.S7,this.setRtl,this),this.parent.on(a.zr,this.removeEventListener,this),this.parent.on(a.Ay,this.onPropertyChanged,this))},e.prototype.onIframeMouseDown=function(){(0,r.Pt)(document,"mousedown")},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(a.KK,this.onIframeMouseDown),this.parent.off(a.S7,this.setRtl),this.parent.off(a.QL,this.beforeRender),this.parent.off(a.zr,this.removeEventListener),this.parent.off(a.Ay,this.onPropertyChanged))},e}()},237:(e,t,n)=>{n.d(t,{D:()=>we});var i=n(5290),o=n(8452),r=n(134),a=n(5537),s=function(){function e(){}return e.prototype.process=function(e,t,n,r){var s,l=this,d=e.contentModule.getDocument().getSelection(),h=d.rangeCount>0?d.getRangeAt(d.rangeCount-1):null;if("HTML"===e.editorMode&&(s=this.editorManager.nodeSelection.save(h,e.contentModule.getDocument())),(0,o.hX)(t)||!t.item.command||"Table"===t.item.command||"Actions"===t.item.command||"Links"===t.item.command||"Images"===t.item.command||"Files"===t.item.command||!h||e.contentModule.getEditPanel().contains(this.getAncestorNode(h.commonAncestorContainer))||e.contentModule.getEditPanel()===h.commonAncestorContainer||e.contentModule.getPanel()===h.commonAncestorContainer){if((0,o.hX)(t)){var p=n.action;if("tab"!==p&&"enter"!==p&&"space"!==p&&"escape"!==p){t={},"Markdown"===e.editorMode&&"insert-table"===p&&(r={headingText:e.localeObj.getConstant("TableHeadingText"),colText:e.localeObj.getConstant("TableColText")});var c={originalEvent:n,cancel:!1,requestType:p||n.key+"Key",itemCollection:r};(0,o.X$)(t,t,c,!0),e.trigger(i.eY,t,(function(e){e.cancel&&("paste"!==p&&"cut"!==p&&"copy"!==p||n.preventDefault())}))}var u=!!(0,o.hX)(e.tableModule)||!!e.tableModule&&e.tableModule.ensureInsideTableList;(9===n.which&&u||9!==n.which)&&(13===n.which&&"HTML"===e.editorMode&&(r={enterAction:e.enterKey}),this.editorManager.observer.notify("keydown"===n.type?a.R:a.gf,{event:n,callBack:this.onSuccess.bind(this,e),value:r,enterAction:e.enterKey}))}else!(0,o.hX)(t)&&t.item.command&&t.item.subCommand&&(t.item.command!==t.item.subCommand&&"Font"!==t.item.command||("FontName"===t.item.subCommand||"FontSize"===t.item.subCommand)&&"dropDownSelect"===t.name||("BackgroundColor"===t.item.subCommand||"FontColor"===t.item.subCommand)&&"colorPickerChanged"===t.name)&&((0,o.X$)(t,t,{requestType:t.item.subCommand,cancel:!1,itemCollection:r,selectType:t.name},!0),e.trigger(i.eY,t,(function(t){if(!t.cancel){0===l.getUndoRedoStack().length&&"Links"!==t.item.command&&"Images"!==t.item.command&&l.saveData(),e.isBlur=!1,e.contentModule.getEditPanel().focus(),"HTML"===e.editorMode&&s.restore();var o=t.item.subCommand.toLocaleLowerCase();"paste"===o||"cut"===o||"copy"===o?e.clipboardAction(o,n):(l.editorManager.observer.notify(i.XZ,{subCommand:t.item.subCommand}),l.editorManager.execCommand(t.item.command,t.item.subCommand,n,l.onSuccess.bind(l,e),t.item.value,"Pre"===t.item.subCommand&&"dropDownSelect"===t.selectType?{name:t.selectType}:r,"#"+e.getID()+" iframe",e.enterKey))}})));((0,o.hX)(n)||n&&"copy"!==n.action)&&this.enableUndo(e)}},e.prototype.getAncestorNode=function(e){return e=3===e.nodeType?e.parentNode:e},e.prototype.onKeyHandler=function(e,t){var n=this;this.editorManager.observer.notify(a.gf,{event:t,callBack:function(){e.notify(i.a7,{}),n.enableUndo(e)}})},e.prototype.onSuccess=function(e,t){e.notify(i.a7,{}),t&&((0,o.hX)(t.event)||"copy"!==t.event.action)&&(this.enableUndo(e),e.notify(i._D,t)),e.trigger(i.wn,t,(function(t){if(e.setPlaceHolder(),"Images"===t.requestType||"Links"===t.requestType&&"HTML"===e.editorMode){var n=t;if("Links"===t.requestType&&t.event&&"keydown"===t.event.type&&32===t.event.keyCode)return;e.notify(i.tq,{args:n.event,type:t.requestType,isNotify:!0,elements:n.elements})}e.autoResize()}))},e.prototype.saveData=function(e){this.editorManager.undoRedoManager.saveData(e)},e.prototype.getUndoStatus=function(){return this.editorManager.undoRedoManager.getUndoStatus()},e.prototype.getUndoRedoStack=function(){return this.editorManager.undoRedoManager.undoRedoStack},e.prototype.enableUndo=function(e){var t=this.getUndoStatus();!e.inlineMode.enable||o.Pw.isDevice&&!(0,r.wU)()?e.toolbarModule&&(0,r.kB)(e.toolbarModule.baseToolbar,t):(0,r.kB)(e.quickToolbarModule.inlineQTBar.quickTBarObj,t)},e}(),l="INSERT-IMAGE",d="INSERT-TABLE",h="INSERT-LINK",p="INSERT-ROW",c="INSERT-COLUMN",u="DELETE-ROW",m="DELETE-COLUMN",g="REMOVE-TABLE",f="TABLE-HEADER",b="TABLE_VERTICAL_ALIGN",v="TABLE_MERGE",y="TABLE_VERTICAL_SPLIT",C="TABLE_HORIZONTAL_SPLIT",S="alignment-type",E="indent-type",w="p",T=["address","article","aside","audio","blockquote","canvas","details","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","section","table","tbody","td","tfoot","th","thead","tr","ul","video","body"],k=["td","th"],N=["table","tbody","td","tfoot","th","thead","tr"],L="selection-type",D="inserthtml-type",x="insert-text-type",M="clear-type",A=function(){function e(){this.startNodeName=[],this.endNodeName=[]}return e.prototype.saveInstance=function(e,t){return this.range=e.cloneRange(),this.rootNode=this.documentFromRange(e),this.body=t,this.startContainer=this.getNodeArray(e.startContainer,!0),this.endContainer=this.getNodeArray(e.endContainer,!1),this.startOffset=e.startOffset,this.endOffset=e.endOffset,this.html=this.body.innerHTML,this},e.prototype.documentFromRange=function(e){return 9===e.startContainer.nodeType?e.startContainer:e.startContainer.ownerDocument},e.prototype.getRange=function(e){var t=this.get(e),n=t&&t.rangeCount>0?t.getRangeAt(t.rangeCount-1):e.createRange();return n.startContainer!==e||n.endContainer!==e||n.startOffset||n.endOffset||(n.setStart(e.body,0),n.collapse(!0)),n},e.prototype.get=function(e){return e.defaultView.getSelection()},e.prototype.save=function(e,t){return e=e?e.cloneRange():this.getRange(t),this.saveInstance(e,t.body)},e.prototype.getIndex=function(e){var t=0;if(e=e.previousSibling||"BR"!==e.tagName?e.previousSibling:e)for(e.nodeType;e;null)t++,e.nodeType,e=e.previousSibling;return t},e.prototype.isChildNode=function(e,t){for(var n=0;n<t.childNodes.length;n++)if(e.indexOf(t.childNodes[n])>-1)return!0;return!1},e.prototype.getNode=function(e,t,n){return t!==e||3!==e.nodeType&&e.firstChild&&-1===n.indexOf(e.firstChild)&&!this.isChildNode(n,e)?-1===n.indexOf(e.firstChild)&&e.firstChild&&!this.isChildNode(n,e)?e.firstChild:e.nextSibling?e.nextSibling:e.parentNode?e.parentNode:null:null},e.prototype.getNodeCollection=function(e){var t=e.startContainer.childNodes[e.startOffset]||e.startContainer,n=e.endContainer.childNodes[e.endOffset>0?e.endOffset-1:e.endOffset]||e.endContainer;if((t===n||"BR"===t.nodeName&&t===e.endContainer.childNodes[e.endOffset])&&0===t.childNodes.length)return[t];if(e.startOffset===e.endOffset&&0!==e.startOffset&&"PRE"===e.startContainer.nodeName)return["BR"===t.nodeName||"#text"===t.nodeName?t:t.childNodes[0]];var i=[];do{-1===i.indexOf(t)&&i.push(t),t=this.getNode(t,n,i)}while(t);return i},e.prototype.getParentNodeCollection=function(e){return this.getParentNodes(this.getNodeCollection(e),e)},e.prototype.getParentNodes=function(e,t){e=e.reverse();for(var n=0;n<e.length;n++)-1!==e.indexOf(e[n].parentNode)||3===e[n].nodeType&&t.startContainer!==t.endContainer&&t.startContainer.parentNode!==t.endContainer.parentNode?(e.splice(n,1),n--):3===e[n].nodeType&&(e[n]=e[n].parentNode);return e},e.prototype.getSelectionNodeCollection=function(e){return this.getSelectionNodes(this.getNodeCollection(e))},e.prototype.getSelectionNodeCollectionBr=function(e){return this.getSelectionNodesBr(this.getNodeCollection(e))},e.prototype.getSelectionNodes=function(e){e=e.reverse();for(var t=new RegExp(String.fromCharCode(8203),"g"),n=0;n<e.length;n++)(3!==e[n].nodeType||""===e[n].textContent.trim()||1===e[n].textContent.length&&e[n].textContent.match(t))&&(e.splice(n,1),n--);return e.reverse()},e.prototype.getSelectionNodesBr=function(e){e=e.reverse();for(var t=new RegExp(String.fromCharCode(8203),"g"),n=0;n<e.length;n++)"BR"!==e[n].nodeName&&(3!==e[n].nodeType||""===e[n].textContent.trim()||1===e[n].textContent.length&&e[n].textContent.match(t))&&(e.splice(n,1),n--);return e.reverse()},e.prototype.getInsertNodeCollection=function(e){return this.getInsertNodes(this.getNodeCollection(e))},e.prototype.getInsertNodes=function(e){e=e.reverse();for(var t=0;t<e.length;t++)(0!==e[t].childNodes.length&&3!==e[t].nodeType||3===e[t].nodeType&&""===e[t].textContent)&&(e.splice(t,1),t--);return e.reverse()},e.prototype.getNodeArray=function(e,t,n){var i=[];for(t?this.startNodeName=[]:this.endNodeName=[];e!==(n||this.rootNode)&&!(0,o.hX)(e);null)t?this.startNodeName.push(e.nodeName.toLowerCase()):this.endNodeName.push(e.nodeName.toLowerCase()),i.push(this.getIndex(e)),e=e.parentNode;return i},e.prototype.setRangePoint=function(e,t,n,i){for(var o=this.rootNode,r=n.length,a=i;r--;null)o=o&&o.childNodes[n[r]];return o&&a>=0&&"html"!==o.nodeName&&e[t?"setStart":"setEnd"](o,a),e},e.prototype.restore=function(){var e=this.range.cloneRange();return e=this.setRangePoint(e,!0,this.startContainer,this.startOffset),e=this.setRangePoint(e,!1,this.endContainer,this.endOffset),this.selectRange(this.rootNode,e),e},e.prototype.selectRange=function(e,t){this.setRange(e,t),this.save(t,e)},e.prototype.setRange=function(e,t){var n=this.get(e);n.removeAllRanges(),n.addRange(t)},e.prototype.setSelectionText=function(e,t,n,i,o){var r=e.createRange();r.setStart(t,i),r.setEnd(n,o),this.setRange(e,r)},e.prototype.setSelectionContents=function(e,t){var n=e.createRange();n.selectNode(t),this.setRange(e,n)},e.prototype.setSelectionNode=function(e,t){var n=e.createRange();n.selectNodeContents(t),this.setRange(e,n)},e.prototype.getSelectedNodes=function(e){return this.getNodeCollection(this.getRange(e))},e.prototype.Clear=function(e){this.get(e).removeAllRanges()},e.prototype.insertParentNode=function(e,t,n){n.surroundContents(t),this.selectRange(e,n)},e.prototype.setCursorPoint=function(e,t,n){var i=e.createRange(),o=e.defaultView.getSelection();i.setStart(t,n),i.collapse(!0),o.removeAllRanges(),o.addRange(i)},e}(),O={"toolbar-focus":"alt+f10",escape:"27","insert-link":"ctrl+k","insert-image":"ctrl+shift+i","insert-table":"ctrl+shift+e",undo:"ctrl+z",redo:"ctrl+y",copy:"ctrl+c",cut:"ctrl+x",paste:"ctrl+v",bold:"ctrl+b",italic:"ctrl+i",underline:"ctrl+u",strikethrough:"ctrl+shift+s",uppercase:"ctrl+shift+u",lowercase:"ctrl+shift+l",superscript:"ctrl+shift+=",subscript:"ctrl+=",indents:"ctrl+]",outdents:"ctrl+[","html-source":"ctrl+shift+h","full-screen":"ctrl+shift+f","decrease-fontsize":"ctrl+shift+<","increase-fontsize":"ctrl+shift+>","justify-center":"ctrl+e","justify-full":"ctrl+j","justify-left":"ctrl+l","justify-right":"ctrl+r","clear-format":"ctrl+shift+r","ordered-list":"ctrl+shift+o","unordered-list":"ctrl+alt+o",space:"32",enter:"13",tab:"tab",delete:"46"},R=["BR","IMG"],I=n(5453),B="e-editor-select-start",P="e-editor-select-end",F=function(){function e(e,t){this.parent=e,this.nodeSelection=new A,this.currentDocument=t}return e.prototype.contents=function(e){return e&&"IFRAME"!==e.tagName?Array.prototype.slice.call(e.childNodes||[]):[]},e.prototype.isBlockNode=function(e){return!!e&&e.nodeType===Node.ELEMENT_NODE&&T.indexOf(e.tagName.toLowerCase())>=0},e.prototype.isLink=function(e){return!!e&&e.nodeType===Node.ELEMENT_NODE&&"a"===e.tagName.toLowerCase()},e.prototype.blockParentNode=function(e){for(;e&&e.parentNode!==this.parent&&(!e.parentNode||!this.hasClass(e.parentNode,"e-node-inner"));null)if(e=e.parentNode,this.isBlockNode(e))return e;return e},e.prototype.rawAttributes=function(e){var t={},n=e.attributes;if(n.length>0)for(var i=0;i<n.length;i++){var o=n[i];t[o.nodeName]=o.value}return t},e.prototype.attributes=function(e){if(!e)return"";for(var t="",n=this.rawAttributes(e),i=Object.keys(n).sort(),o=0;o<i.length;o++){var r=i[o],a=n[r];a.indexOf("'")<0&&a.indexOf('"')>=0?t+=" "+r+"='"+a+"'":a.indexOf('"')>=0&&a.indexOf("'")>=0?t+=" "+r+'="'+(a=a.replace(/"/g,"&quot;"))+'"':t+=" "+r+'="'+a+'"'}return t},e.prototype.clearAttributes=function(e){for(var t=e.attributes,n=t.length-1;n>=0;n--){var i=t[n];e.removeAttribute(i.nodeName)}},e.prototype.openTagString=function(e){return"<"+e.tagName.toLowerCase()+this.attributes(e)+">"},e.prototype.closeTagString=function(e){return"</"+e.tagName.toLowerCase()+">"},e.prototype.createTagString=function(e,t,n){return"<"+e.toLowerCase()+this.attributes(t)+">"+n+"</"+e.toLowerCase()+">"},e.prototype.isList=function(e){return!!e&&["UL","OL"].indexOf(e.tagName)>=0},e.prototype.isElement=function(e){return e===this.parent},e.prototype.isEditable=function(e){return(!e.getAttribute||"true"===e.getAttribute("contenteditable"))&&["STYLE","SCRIPT"].indexOf(e.tagName)<0},e.prototype.hasClass=function(e,t){return e&&e.classList&&e.classList.contains(t)},e.prototype.replaceWith=function(e,t){e.parentNode.insertBefore(this.parseHTMLFragment(t),e),(0,o.Yo)(e)},e.prototype.parseHTMLFragment=function(e){var t=(0,o.n)("template");return t.innerHTML=e,t.content instanceof DocumentFragment?t.content:document.createRange().createContextualFragment(e)},e.prototype.wrap=function(e,t){return e.parentNode.insertBefore(t,e),(t=e.previousSibling).appendChild(e),t},e.prototype.insertAfter=function(e,t){t.parentNode.insertBefore(e,t.nextSibling)},e.prototype.wrapInner=function(e,t){for(e.appendChild(t),(t=e.querySelector(".e-rte-wrap-inner")).classList.remove("e-rte-wrap-inner"),0===t.classList.length&&t.removeAttribute("class");e.firstChild!==t;)t.appendChild(e.firstChild);return t},e.prototype.unWrap=function(e){for(var t=e.parentNode,n=[];e.firstChild;)n.push(e.firstChild),t.insertBefore(e.firstChild,e);return n=n.length>0?n:[e.parentNode],t.removeChild(e),n},e.prototype.getSelectedNode=function(e,t){return e.nodeType===Node.ELEMENT_NODE&&e.childNodes.length>0&&e.childNodes[t-1]&&e.childNodes[t-1].nodeType===Node.ELEMENT_NODE&&(e.childNodes[t-1].classList.contains(B)||e.childNodes[t-1].classList.contains(P))?e=e.childNodes[t-1]:e.nodeType===Node.ELEMENT_NODE&&e.childNodes.length>0&&e.childNodes[t]&&(e=e.childNodes[t]),e.nodeType===Node.TEXT_NODE&&(e=e.parentNode),e},e.prototype.nodeFinds=function(e,t){for(var n=[],i=0;i<t.length;i++)e.contains(t[i])&&e!==t[i]&&n.push(t[i]);return n},e.prototype.isEditorArea=function(){var e;for(e=this.getRangePoint(0).commonAncestorContainer;e&&!this.isElement(e);null)e=e.parentNode;return!!this.isElement(e)},e.prototype.getRangePoint=function(e){var t=this.getSelection(),n=[];if(t&&t.getRangeAt&&t.rangeCount){n=[];for(var i=0;i<t.rangeCount;i++)n.push(t.getRangeAt(i))}else n=[this.currentDocument.createRange()];return"undefined"!==typeof e?n[e]:n},e.prototype.getSelection=function(){return this.nodeSelection.get(this.currentDocument)},e.prototype.getPreviousNode=function(e){for(e=e.previousElementSibling;e&&"\n"===e.textContent;null)e=e.previousElementSibling;return e},e.prototype.encode=function(e){var t=document.createElement("div");return t.innerText=e,t.innerHTML.replace(/<br\s*[\/]?>/gi,"\n")},e.prototype.saveMarker=function(e,t){var n,i,r=this.parent.querySelector("."+B),a=this.parent.querySelector("."+P);if(""===r.textContent&&(0,o.hX)(a)&&"tab"!==t&&(1===r.childNodes.length&&"BR"===r.childNodes[0].nodeName?r.innerHTML="&#65279;&#65279;<br>":r.innerHTML="&#65279;&#65279;"),this.hasClass(r,B)&&r.classList.length>1){var s=this.createTagString(w,r,this.encode(r.textContent));this.replaceWith(r,s),(r=this.parent.querySelector("."+B)).classList.remove(B),n=r.childNodes[0]}else n=this.unWrap(r)[0];if(this.hasClass(a,P)&&a.classList.length>1){s=this.createTagString(w,a,this.encode(a.textContent));this.replaceWith(a,s),(a=this.parent.querySelector("."+P)).classList.remove(P),i=a.childNodes[0]}else i=a?this.unWrap(a)[0]:n;return e.startContainer=e.getNodeArray(n,!0),e.endContainer=e.getNodeArray(i,!1),e},e.prototype.marker=function(e,t){return'<span class="'+e+'">'+t+"</span>"},e.prototype.setMarker=function(e){var t=e.range,n=t.startContainer.childNodes,i=(n.length>1&&"TABLE"===n[0].nodeName?(0,I.Mv)(n[t.startOffset+1]):n[t.startOffset>0?t.startOffset-1:t.startOffset])||t.startContainer,o=t.endContainer.childNodes[t.endOffset>0?t.endOffset-1:t.endOffset]||t.endContainer;if(i.nodeType===Node.ELEMENT_NODE&&o.nodeType===Node.ELEMENT_NODE&&(i.contains(o)||o.contains(i))){var r=i.contains(o)?i:o;if(r.nodeType!==Node.TEXT_NODE){for(var a=[],s=[],l=r;r.contains(l);null)a.indexOf(l)<0&&l.childNodes&&l.childNodes.length?(a.push(l),l=l.childNodes[0]):l.nextSibling?l=l.nextSibling:l.parentNode&&(l=l.parentNode,a.push(l)),s.indexOf(l)<0&&(l.nodeType===Node.TEXT_NODE||k.indexOf(l.parentNode.tagName.toLocaleLowerCase())>=0&&("BR"===l.tagName||"IMG"===l.tagName))&&s.push(l);s.length&&(i=i.contains(o)?s[0]:i,o=s[s.length-1])}}if(i!==o){if(i.nodeType!==Node.TEXT_NODE&&("BR"===i.tagName&&k.indexOf(i.parentNode.tagName.toLocaleLowerCase())>=0||"IMG"===i.tagName))this.replaceWith(i,this.marker(B,this.encode(i.textContent))),t.startContainer.querySelector("."+B).appendChild(i);else this.replaceWith(i,this.marker(B,this.encode(i.textContent)));if(o.nodeType!==Node.TEXT_NODE&&"BR"===o.tagName&&k.indexOf(o.parentNode.tagName.toLocaleLowerCase())>=0)this.replaceWith(o,this.marker(P,this.encode(o.textContent))),t.endContainer.querySelector("."+P).appendChild(o);else this.ensureSelfClosingTag(o,P,t)}else this.ensureSelfClosingTag(i,B,t)},e.prototype.ensureSelfClosingTag=function(e,t,n){var i=!1;if(3===e.nodeType)this.replaceWith(e,this.marker(t,this.encode(e.textContent)));else if("BR"===e.tagName){this.replaceWith(e,this.marker(t,this.encode(e.textContent))),n.startContainer.querySelector("."+t).appendChild(e)}else{if("IMG"===e.tagName){var r=document.createElement("p");e.parentElement.insertBefore(r,e),r.appendChild(e),e=r.children[0]}if("TABLE"===e.tagName)if(i=!0,""===e.textContent){var a=e.querySelectorAll("td");e=a[a.length-1],e=(0,o.hX)(e.childNodes[0])?e:e.childNodes[0]}else{for(var s=e.lastChild;3!==s.nodeType&&"#text"!==s.nodeName&&"BR"!==s.nodeName;)s=s.lastChild;e=s}for(var l=0;l<R.length;l++)e=e.tagName!==R[l]||i?e:e.parentNode;if(3===e.nodeType&&"#text"===e.nodeName)this.replaceWith(e,this.marker(t,this.encode(e.textContent)));else if("BR"===e.nodeName){this.replaceWith(e,this.marker(P,this.encode(e.textContent))),n.endContainer.querySelector("."+P).appendChild(e)}else{var d=this.marker(t,"");(0,o.BC)([this.parseHTMLFragment(d)],e)}}},e.prototype.createTempNode=function(e){var t=e.textContent;if("BR"===e.tagName){var n="<p></p>",i=e.parentNode;k.indexOf(i.tagName.toLocaleLowerCase())>=0&&(e=this.wrap(e,this.parseHTMLFragment(n)))}else if(e.nodeType!==Node.TEXT_NODE&&(e.classList.contains(B)||e.classList.contains(P))||t.replace(/\n/g,"").replace(/(^ *)|( *$)/g,"").length>0||t.length&&t.indexOf("\n")<0){n="<p></p>";var o=e;e=this.wrap(e,this.parseHTMLFragment(n)),!(o.nodeType===Node.ELEMENT_NODE&&o.firstChild&&"BR"===o.firstChild.nodeName&&(o.classList.contains(B)||o.classList.contains(P)))&&e.nextElementSibling&&"BR"===e.nextElementSibling.tagName&&e.appendChild(e.nextElementSibling)}return e},e.prototype.getImageTagInSelection=function(){var e=this.getSelection();return this.isEditorArea()&&e.rangeCount?e.focusNode.querySelectorAll("img"):null},e.prototype.blockNodes=function(){var e=[],t=this.getSelection();if(this.isEditorArea()&&t.rangeCount)for(var n=this.getRangePoint(),i=0;i<n.length;i++){var r=void 0,a=n[i],s=this.getSelectedNode(a.startContainer,a.startOffset),l=this.getSelectedNode(a.endContainer,a.endOffset);if(this.isBlockNode(s)&&e.indexOf(s)<0&&e.push(s),(r=this.blockParentNode(s))&&e.indexOf(r)<0)if(k.indexOf(r.tagName.toLocaleLowerCase())>=0&&("BR"===s.tagName||s.nodeType===Node.TEXT_NODE||s.classList.contains(B)||s.classList.contains(P))){var d=s.previousSibling&&s.previousSibling.nodeType===Node.TEXT_NODE?s.previousSibling:s;s.nextSibling||s.previousSibling||"BR"!==s.tagName?e.push(this.createTempNode(d)):e.push(d)}else e.push(r);for(var h=[],p=s;p!==l&&p!==this.parent;null)h.indexOf(p)<0&&p.childNodes&&p.childNodes.length?(h.push(p),p=p.childNodes[0]):p&&8!==p.nodeType&&("BR"===p.tagName||p.nodeType===Node.TEXT_NODE&&""!==p.textContent.trim()||p.nodeType!==Node.TEXT_NODE&&(p.classList.contains(B)||p.classList.contains(P)))&&k.indexOf(p.parentNode.tagName.toLocaleLowerCase())>=0?p=this.createTempNode(p):p.nextSibling&&8!==p.nextSibling.nodeType&&("BR"===p.nextSibling.tagName||p.nextSibling.nodeType===Node.TEXT_NODE||p.nextSibling.classList.contains(B)||p.nextSibling.classList.contains(P))&&k.indexOf(p.nextSibling.parentNode.tagName.toLocaleLowerCase())>=0?p=this.createTempNode(p.nextSibling):p.nextSibling?p=p.nextSibling:p.parentNode&&(p=p.parentNode,h.push(p)),e.indexOf(p)<0&&p.nodeType===Node.ELEMENT_NODE&&k.indexOf(p.parentNode.tagName.toLocaleLowerCase())>=0&&(p.classList.contains(B)||p.classList.contains(P))&&e.push(this.createTempNode(p)),this.isBlockNode(p)&&this.ignoreTableTag(p)&&h.indexOf(p)<0&&e.indexOf(p)<0&&(p!==l||a.endOffset>0)&&e.push(p),"IMG"===p.nodeName&&"true"===p.parentElement.contentEditable&&e.push(p);(r=this.blockParentNode(l))&&this.ignoreTableTag(r)&&e.indexOf(r)<0&&!(0,o.hX)(r.previousElementSibling)&&"IMG"!==r.previousElementSibling.tagName&&e.push(r)}for(var c=e.length-1;c>0;c--){if((h=this.nodeFinds(e[c],e)).length){var u=e[c].querySelectorAll("ul, ol");if("LI"===e[c].tagName&&u.length>0)continue;e.splice(c,1)}}return e},e.prototype.ignoreTableTag=function(e){return!(N.indexOf(e.tagName.toLocaleLowerCase())>=0)},e}(),H=function(){function e(e){this.parent=e,this.domNode=this.parent.domNode,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(a.qv,this.applyListsHandler,this),this.parent.observer.on(a.ck,this.keyDownHandler,this),this.parent.observer.on(a.Q7,this.spaceKeyAction,this)},e.prototype.testList=function(e){var t=[/^[\d]+[.]+$/,/^(?=[MDCLXVI])M*(C[MD]|D?C{0,3})(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})[.]$/gi,/^[a-zA-Z][.]+$/],n=(0,o.hX)(e)?null:e.innerText.trim().split(".")[0]+".";if(!(0,o.hX)(n))for(var i=0;i<t.length;i++)if(t[i].test(n))return!0;return!1},e.prototype.testCurrentList=function(e){var t=[/^[1]+[.]+$/,/^[i]+[.]+$/,/^[a]+[.]+$/];if(!(0,o.hX)(e.startContainer.textContent.slice(0,e.startOffset)))for(var n=e.startContainer.textContent.replace(/\u200B/g,"").slice(0,e.startOffset).trim(),i=0;i<t.length;i++)if(t[i].test(n)&&2===n.length)return!0;return!1},e.prototype.spaceList=function(e){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument);this.saveSelection=this.parent.nodeSelection.save(t,this.parent.currentDocument);var n=this.parent.domNode.getSelectedNode(t.startContainer,t.startOffset),i=(this.parent.domNode.getSelectedNode(t.endContainer,t.endOffset),n.previousElementSibling),r=n.nextElementSibling,a=(0,o.hX)(i)?null:i.innerText.trim().substring(0,1),s=(0,o.hX)(r)?null:r.innerText.trim().substring(0,1),l=this.testCurrentList(t),d=this.testList(i),h=this.testList(r);d||h||"*"===a||"*"===s||(l?(t.startContainer.textContent=t.startContainer.textContent.slice(t.startOffset,t.startContainer.textContent.length),this.applyListsHandler({subCommand:"OL",callBack:e.callBack}),e.event.preventDefault()):"*"!==t.startContainer.textContent.replace(/\u200B/g,"").slice(0,t.startOffset).trim()&&"-"!==t.startContainer.textContent.replace(/\u200B/g,"").slice(0,t.startOffset).trim()||(t.startContainer.textContent=t.startContainer.textContent.slice(t.startOffset,t.startContainer.textContent.length),this.applyListsHandler({subCommand:"UL",callBack:e.callBack}),e.event.preventDefault()))},e.prototype.enterList=function(e){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument),n="LI"===t.startContainer.nodeName?t.startContainer:t.startContainer.parentElement.closest("LI"),i="LI"===t.endContainer.nodeName?t.endContainer:t.endContainer.parentElement.closest("LI");if(!(0,o.hX)(n)&&!(0,o.hX)(i)&&n===i&&"LI"===n.tagName&&""===n.textContent.trim()&&0===n.querySelectorAll("IMG").length){65279===n.textContent.charCodeAt(0)&&(n.textContent="");var r=n.parentElement;if((0,o.hX)(r.parentElement.closest("UL"))&&(0,o.hX)(r.parentElement.closest("OL"))){if(!(0,o.hX)(n.nextElementSibling)){var a=this.parent.domNode.blockParentNode(n);this.parent.nodeCutter.GetSpliceNode(t,a)}var s=void 0;"DIV"===e.enterAction?(s=(0,o.n)("div")).innerHTML="<br>":"P"===e.enterAction?(s=(0,o.n)("p")).innerHTML="<br>":s=(0,o.n)("br"),this.parent.domNode.insertAfter(s,r),e.event.preventDefault(),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,s,0),""===r.textContent?(0,o.Yo)(r):(0,o.Yo)(n)}}},e.prototype.backspaceList=function(e){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument),n=this.parent.domNode.getSelectedNode(t.startContainer,t.startOffset),i=this.parent.domNode.getSelectedNode(t.endContainer,t.endOffset);if((n="BR"===n.nodeName?n.parentElement:n)===(i="BR"===i.nodeName?i.parentElement:i)&&!(0,o.hX)((0,o.kp)(n,"li"))&&(""===n.textContent.trim()&&65279===n.textContent.charCodeAt(0)||1===n.textContent.length&&8203===n.textContent.charCodeAt(0))&&(n.textContent=""),n===i&&""===n.textContent){if("LI"===n.parentElement.tagName&&"LI"===i.parentElement.tagName)(0,o.Yo)(n);else if(n.closest("ul")||n.closest("ol")){if((r=(0,o.hX)(n.closest("ul"))?n.closest("ol"):n.closest("ul")).firstElementChild===n&&!(0,o.hX)(r.children[1])&&("OL"===r.children[1].tagName||"UL"===r.children[1].tagName))if(r.tagName===r.children[1].tagName){for(;r.children[1].lastChild;)this.parent.domNode.insertAfter(r.children[1].lastChild,r.children[1]);(0,o.Yo)(r.children[1])}else r.parentElement.insertBefore(r.children[1],r)}}else if(!(0,o.hX)(n.firstChild)&&"BR"===n.firstChild.nodeName&&!(0,o.hX)(n.childNodes[1])&&("UL"===n.childNodes[1].nodeName||"OL"===n.childNodes[1].nodeName)){var r;if((r=(0,o.hX)(n.closest("ul"))?n.closest("ol"):n.closest("ul")).tagName===n.childNodes[1].nodeName){for(;n.childNodes[1].lastChild;)this.parent.domNode.insertAfter(n.children[1].lastChild,n);(0,o.Yo)(n.childNodes[1])}else r.parentElement.insertBefore(n.children[1],r)}},e.prototype.keyDownHandler=function(e){if(13===e.event.which&&this.enterList(e),32===e.event.which&&this.spaceList(e),8===e.event.which&&this.backspaceList(e),46===e.event.which&&"delete"===e.event.action){var t=(s=this.parent.nodeSelection.getRange(this.parent.currentDocument)).commonAncestorContainer,n=s.startContainer,i=s.endContainer,r=3===n.nodeType?n.parentElement:n,a=3===i.nodeType?i.parentElement:i;"UL"!==t.nodeName&&"OL"!==t.nodeName||r===a||(0,o.hX)((0,o.kp)(r,"ul"))&&(0,o.hX)((0,o.kp)(r,"ol"))||(0,o.hX)((0,o.kp)(a,"ul"))&&(0,o.hX)((0,o.kp)(a,"ol"))||t.lastElementChild!==(0,o.kp)(a,"li")||s.collapsed||(0,o.Yo)(t)}if(9===e.event.which){var s=this.parent.nodeSelection.getRange(this.parent.currentDocument);e.event.action&&"indent"===e.event.action||(this.saveSelection=this.parent.nodeSelection.save(s,this.parent.currentDocument));var l=void 0,d=s.startOffset,h=s.endOffset;if((r=this.parent.domNode.getSelectedNode(s.startContainer,s.startOffset))===(a=this.parent.domNode.getSelectedNode(s.endContainer,s.endOffset))&&("BR"===r.nodeName||"#text"===r.nodeName)&&k.indexOf(r.parentNode.tagName.toLocaleLowerCase())>=0)return;e.event.action&&"indent"===e.event.action||this.domNode.setMarker(this.saveSelection),l=this.domNode.blockNodes();for(var p=[],c=!0,u=0;u<l.length;u++)"LI"===l[u].parentNode.tagName?p.push(l[u].parentNode):"LI"===l[u].tagName&&"P"!==l[u].childNodes[0].tagName&&"OL"!==l[u].childNodes[0].tagName&&"UL"!==l[u].childNodes[0].tagName&&p.push(l[u]);p.length>1||p.length&&(0===d&&0===h||e.ignoreDefault)?(e.event.preventDefault(),e.event.stopPropagation(),this.currentAction=this.getAction(p[0]),e.event.shiftKey?(this.revertList(p),this.revertClean()):c=this.nestedList(p),c&&(this.cleanNode(),this.parent.editableElement.focus()),e.event.action&&"indent"===e.event.action||(this.saveSelection=this.domNode.saveMarker(this.saveSelection),this.saveSelection.restore(),e.callBack&&e.callBack({requestType:this.currentAction,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes(),event:e.event}))):e.event.action&&"indent"===e.event.action||(e.event&&e.event.shiftKey&&"Tab"===e.event.key&&(e.event.action="tab"),this.saveSelection=this.domNode.saveMarker(this.saveSelection,e.event.action),this.saveSelection.restore())}else switch(e.event.action){case"ordered-list":this.applyListsHandler({subCommand:"OL",callBack:e.callBack}),e.event.preventDefault();break;case"unordered-list":this.applyListsHandler({subCommand:"UL",callBack:e.callBack}),e.event.preventDefault()}},e.prototype.spaceKeyAction=function(e){32===e.event.which&&this.spaceList(e)},e.prototype.getAction=function(e){return"OL"===e.parentNode.nodeName?"OL":"UL"},e.prototype.revertClean=function(){for(var e=this.parent.editableElement.querySelectorAll("ul, ol"),t=0;t<e.length;t++){var n=e[t].querySelectorAll("ul, ol");if(n.length>0)for(var i=0;i<n.length;i++){var o=n[i].previousSibling;o&&"LI"===o.tagName&&o.appendChild(n[i])}}},e.prototype.noPreviousElement=function(e){var t,n,i=e.querySelectorAll("ol, ul"),r=e.querySelectorAll("li"),a=this.domNode.contents(r[0])[0];if(r.length>0&&("OL"===a.nodeName||"UL"===a.nodeName)?t=r[0]:n=i[0],t)for(var s=this.domNode.contents(e)[0];s&&!this.domNode.isList(s);null){var l=s.nextSibling;(0,o.Hs)([s],t),(0,o.sN)(e,{"list-style-type":"none"}),(0,o.sN)(t,{"list-style-type":""}),s=l}else if(n){var d=(0,o.n)("li");(0,o.Hs)([d],n);for(s=this.domNode.contents(e)[0];s&&!this.domNode.isList(s);null){l=s.nextSibling;d.appendChild(s),s=l}(0,o.Hs)([n],e.parentNode),(0,o.Yo)(e);var h=(0,o.n)("li",{styles:"list-style-type: none;"});(0,o.Hs)([h],n.parentNode),(0,o.BC)([n],h)}else{h=(0,o.n)("li",{styles:"list-style-type: none;"});(0,o.Hs)([h],e.parentNode);d=(0,o.n)(e.parentNode.tagName);(0,o.Hs)([d],h),(0,o.BC)([e],d)}},e.prototype.nestedList=function(e){for(var t=!1,n=0;n<e.length;n++){var i=this.domNode.getPreviousNode(e[n]);if(i){t=!0;var r=void 0,a=void 0,s=e[n].querySelectorAll("ol, ul"),l=e[n].querySelectorAll("li"),d=this.domNode.contents(l[0])[0];if(l.length>0&&("OL"===d.nodeName||"UL"===d.nodeName)?a=l[0]:r=s[0],r){var h=(0,o.n)("li");(0,o.Hs)([h],r);for(var p=this.domNode.contents(e[n])[0];p&&!this.domNode.isList(p);null){var c=p.nextSibling;h.appendChild(p),p=c}(0,o.BC)([r],i),(0,o.Yo)(e[n])}else if(a){if("LI"===i.tagName){for(p=this.domNode.contents(e[n])[0];p&&!this.domNode.isList(p);null){c=p.nextSibling;(0,o.Hs)([p],a),(0,o.sN)(e[n],{"list-style-type":"none"}),(0,o.sN)(a,{"list-style-type":""}),p=c}(0,o.BC)([a.parentNode],i),(0,o.Yo)(e[n])}}else if("LI"===i.tagName){h=(0,o.n)(e[n].parentNode.tagName);(0,o.BC)([h],i),(0,o.BC)([e[n]],h)}}else{var u=e[n];t=!0,this.noPreviousElement(u)}}return t},e.prototype.applyListsHandler=function(e){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument);if(t.startContainer===t.endContainer&&t.startContainer===this.parent.editableElement&&t.startOffset===t.endOffset&&0===t.startOffset&&0===this.parent.editableElement.textContent.length&&"TABLE"!=this.parent.editableElement.childNodes[0].nodeName&&"IMG"!=this.parent.editableElement.childNodes[0].nodeName){var n=t.startContainer.childNodes[0];this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,n,n,0,0),t=this.parent.nodeSelection.getRange(this.parent.currentDocument)}this.saveSelection=this.parent.nodeSelection.save(t,this.parent.currentDocument),this.currentAction=e.subCommand,this.currentAction=e.subCommand="NumberFormatList"===this.currentAction?"OL":"BulletFormatList"===this.currentAction?"UL":this.currentAction,this.domNode.setMarker(this.saveSelection);var i=this.domNode.blockNodes();if("BR"===e.enterAction){this.setSelectionBRConfig();var r=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),a=this.parent.nodeSelection.getSelectionNodes(r),s=[];0===a.length&&a.push(i[0]);for(var l=0;l<a.length;l++){for(var d=a[l],h=void 0;!this.parent.domNode.isBlockNode(d)&&d!==this.parent.editableElement;)h=d,d=d.parentElement;this.parent.domNode.isBlockNode(d)&&d===this.parent.editableElement&&s.push(h)}for(l=0;l<s.length;l++)if(!this.parent.domNode.isBlockNode(s[l])){for(var p=d=s[l];d===this.parent.editableElement;)p=d,d=d.parentElement;var c=void 0;this.parent.domNode.isBlockNode(p.parentElement)&&p.parentElement===this.parent.editableElement?(c=(0,o.n)("p"),p.parentElement.insertBefore(c,p),c.appendChild(p)):c=p;for(var u=c.previousSibling;!(0,o.hX)(u)&&"BR"!==u.nodeName&&!this.parent.domNode.isBlockNode(u);)c.firstChild.parentElement.insertBefore(u,c.firstChild),u=c.previousSibling;(0,o.hX)(u)||"BR"!==u.nodeName||(0,o.Yo)(u);for(var m=c.nextSibling;!(0,o.hX)(m)&&"BR"!==m.nodeName&&!this.parent.domNode.isBlockNode(m);)c.appendChild(m),m=c.nextSibling;(0,o.hX)(m)||"BR"!==m.nodeName||(0,o.Yo)(m)}this.setSelectionBRConfig(),i=this.parent.domNode.blockNodes()}for(l=0;l<i.length;l++)"TABLE"!==i[l].tagName||t.collapsed||i.splice(l,1),i.length>0&&"LI"!==i[l].tagName&&"LI"===i[l].parentNode.tagName&&(i[l]=i[l].parentNode);this.applyLists(i,this.currentAction,e.selector,e.item),e.callBack&&e.callBack({requestType:this.currentAction,event:e.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})},e.prototype.setSelectionBRConfig=function(){var e=this.parent.editableElement.querySelector("."+B),t=this.parent.editableElement.querySelector("."+P);(0,o.hX)(t)?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,e,0):this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,e,t,0,0)},e.prototype.applyLists=function(e,t,n,i){if(this.isRevert(e,t)&&(0,o.hX)(i))this.revertList(e),this.removeEmptyListElements();else{this.checkLists(e,t,i);for(var r=0;r<e.length;r++)if((0,o.hX)(i)||(0,o.hX)(i.listStyle)||("listImage"===i.listStyle?(0,o.sN)(e[r],{"list-style-image":i.listImage}):((0,o.sN)(e[r],{"list-style-image":"none"}),(0,o.sN)(e[r],{"list-style-type":i.listStyle.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}))),"true"===e[r].getAttribute("contenteditable")&&1===e[r].childNodes.length&&"TABLE"===e[r].childNodes[0].nodeName){var a=document.createElement(t);a.innerHTML="<li><br/></li>",e[r].appendChild(a)}else if("LI"!==e[r].tagName&&(0,o.hX)(i)){0;var s="<"+t+">",l="</"+t+">",d="li"+("IMG"===e[r].tagName?"":this.domNode.attributes(e[r])),h=e[r].tagName.toLowerCase()===w?e[r].innerHTML:e[r].outerHTML,p=s+this.domNode.createTagString(d,null,h)+l;this.domNode.replaceWith(e[r],p)}else if(!(0,o.hX)(i)&&"LI"!==e[r].tagName){0;s="<"+t+("IMG"===e[r].tagName?"":this.domNode.attributes(e[r]))+">",l="</"+t+">",d="li",h=e[r].tagName.toLowerCase()===w?e[r].innerHTML:e[r].outerHTML,p=s+this.domNode.createTagString(d,null,h)+l;this.domNode.replaceWith(e[r],p)}}this.cleanNode(),this.parent.editableElement.focus(),(0,I.wU)()&&(0,I.WM)(this.parent.editableElement,n),this.saveSelection=this.domNode.saveMarker(this.saveSelection),this.saveSelection.restore()},e.prototype.removeEmptyListElements=function(){for(var e=this.parent.editableElement.querySelectorAll("ol, ul"),t=0;t<e.length;t++)""===e[t].textContent.trim()&&(0,o.Yo)(e[t])},e.prototype.isRevert=function(e,t){for(var n=!0,i=0;i<e.length;i++){if("LI"!==e[i].tagName)return!1;e[i].parentNode.tagName!==t&&(n=!1)}return n},e.prototype.checkLists=function(e,t,n){for(var i=[],r=0;r<e.length;r++){var a=e[r].parentNode;(0,o.hX)(n)||"LI"!==e[r].tagName||(0,o.hX)(n.listStyle)||("listImage"===n.listStyle?(0,o.sN)(a,{"list-style-image":n.listImage}):((0,o.sN)(a,{"list-style-image":"none"}),(0,o.sN)(a,{"list-style-type":n.listStyle.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}))),("LI"===e[r].tagName&&a.tagName!==t&&i.indexOf(a)<0||"LI"===e[r].tagName&&a.tagName===t&&i.indexOf(a)<0&&null!==n)&&i.push(a)}for(var s=i.length-1;s>=0;s--){var l=i[s],d="<"+t.toLowerCase()+" "+this.domNode.attributes(l)+">"+l.innerHTML+"</"+t.toLowerCase()+">";this.domNode.replaceWith(i[s],d)}},e.prototype.cleanNode=function(){for(var e=this.parent.editableElement.querySelectorAll("ol + ol, ul + ul"),t=0;t<e.length;t++){var n=e[t];if(this.domNode.isList(n.previousElementSibling)&&this.domNode.openTagString(n)===this.domNode.openTagString(n.previousElementSibling)){for(var i=this.domNode.contents(n),o=0;o<i.length;o++)n.previousElementSibling.appendChild(i[o]);n.parentNode.removeChild(n)}}},e.prototype.findUnSelected=function(e,t){if((e=e.slice().reverse()).length>0){var n=[],i=[],o=[],r=[];o=t[t.length-1].childNodes;for(var a=0;a<o.length;a++)if("OL"===o[a].tagName||"UL"===o[a].tagName){var s=o[a].querySelectorAll("li");if(s.length>0)for(var l=0;l<s.length;l++)r.push(s[l])}for(var d=0;d<r.length;d++){for(var h=0,p=0;p<e.length;p++)r[d].contains(e[p])||(h+=1);h===e.length&&i.push(r[d])}if(i.length>0)for(var c=0;c<i.length;c++)"OL"!==this.domNode.contents(i[c])[0].nodeName&&"UL"!==this.domNode.contents(i[c])[0].nodeName&&n.push(i[c]);n.length>0&&this.nestedList(n)}},e.prototype.revertList=function(e){for(var t=[],n=e.length-1;n>=0;n--)for(var i=n-1;i>=0;i--)if(e[i].contains(e[n])||e[i]===e[n]){t.push(e[n]),e.splice(n,1);break}this.findUnSelected(t,e);var r=[];for(n=0;n<e.length;n++){var a=e[n];3===this.domNode.contents(a)[0].nodeType&&0===this.domNode.contents(a)[0].textContent.trim().length&&(0,o.Yo)(this.domNode.contents(a)[0]);var s=e[n].parentNode,l=a.getAttribute("class");if(0===t.length){var d=e[n].querySelectorAll("ul, ol")[0];if(d)if(d.querySelectorAll("li")){var h=(0,o.n)(d.tagName);(0,o.BC)([h],d.parentNode);var p=(0,o.n)("li",{styles:"list-style-type: none;"});(0,o.BC)([p],h),(0,o.BC)([d],p)}}if(a.parentNode.insertBefore(this.closeTag(s.tagName),a),"LI"===s.parentNode.tagName)a.parentNode.insertBefore(this.closeTag("LI"),a);else{if(l&&' class="'+l+'"',w&&0===a.querySelectorAll(T.join(", ")).length){var c="<p"+((0,o.hX)(l)?' class="e-rte-wrap-inner"':' class="'+l+' e-rte-wrap-inner"')+this.domNode.attributes(s)+"></"+"p>";this.domNode.wrapInner(a,this.domNode.parseHTMLFragment(c))}else if(3===this.domNode.contents(a)[0].nodeType){var u=this.domNode.createTagString(w,s,this.parent.domNode.encode(this.domNode.contents(a)[0].textContent));this.domNode.replaceWith(this.domNode.contents(a)[0],u)}else if(this.domNode.contents(a)[0].classList.contains(B)||this.domNode.contents(a)[0].classList.contains(P)){u=this.domNode.createTagString(w,s,this.domNode.contents(a)[0].outerHTML);this.domNode.replaceWith(this.domNode.contents(a)[0],u)}else{var m=a.firstChild;l=m.getAttribute("class"),(0,o.uK)(m,this.domNode.rawAttributes(s)),l&&m.getAttribute("class")&&(0,o.uK)(m,{class:l+" "+m.getAttribute("class")})}(0,o.BC)([this.openTag("LI")],a),(0,o.Hs)([this.closeTag("LI")],a)}this.domNode.insertAfter(this.openTag(s.tagName),a),"LI"===s.parentNode.tagName&&(s=s.parentNode.parentNode),r.indexOf(s)<0&&r.push(s)}for(n=0;n<r.length;n++){var g=r[n],f=g.innerHTML;f=(f=f.replace(/<span class="e-rte-list-close-([a-z]*)"><\/span>/g,"</$1>")).replace(/<span class="e-rte-list-open-([a-z]*)"><\/span>/g,"<$1 "+this.domNode.attributes(g)+">"),this.domNode.replaceWith(g,this.domNode.openTagString(g)+f.trim()+this.domNode.closeTagString(g))}var b=this.parent.editableElement.querySelectorAll("ul:empty, ol:empty");for(n=0;n<b.length;n++)(0,o.Yo)(b[n]);var v=this.parent.editableElement.querySelectorAll("li:empty");for(n=0;n<v.length;n++)(0,o.Yo)(v[n])},e.prototype.openTag=function(e){return this.domNode.parseHTMLFragment('<span class="e-rte-list-open-'+e.toLowerCase()+'"></span>')},e.prototype.closeTag=function(e){return this.domNode.parseHTMLFragment('<span class="e-rte-list-close-'+e.toLowerCase()+'"></span>')},e}(),X=function(){function e(){}return e.WrapBefore=function(e,t,n){return t.innerText=e.textContent,n?this.AppendBefore(t,e,!0):this.AppendBefore(t,e),e.parentNode&&e.parentNode.removeChild(e),t.childNodes[0]},e.Wrap=function(e,t){return this.AppendBefore(t,e),t.appendChild(e),e},e.unwrap=function(e){for(var t=e.parentNode,n=[];e.firstChild;null)n.push(t.insertBefore(e.firstChild,e));return t.removeChild(e),n},e.AppendBefore=function(e,t,n){return t.parentNode?n?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.insertBefore(e,t):t},e}(),q=function(){function e(){this.enterAction="P",this.position=-1,this.nodeSelection=new A}return e.prototype.GetSpliceNode=function(e,t){return t=this.SplitNode(e,t,!0),t=this.SplitNode(e,t,!1)},e.prototype.SplitNode=function(e,t,n){if(t){var i=e.cloneRange(),o=t.parentNode,r=this.nodeSelection.getIndex(t);i.collapse(n),n?i.setStartBefore(t):i.setEndAfter(t);var a,s=i.extractContents();if(n){if(t=o.childNodes[r],(s=this.spliceEmptyNode(s,!1))&&s.childNodes.length>0)if(!!(1!==s.childNodes.length||"IMG"===s.childNodes[0].nodeName||!this.isImgElm(s)||""!==s.textContent))if(t)X.AppendBefore(s,t);else o.appendChild(s),(a=document.createElement("div")).innerHTML="&#65279;&#65279;",t=a.firstChild,o.appendChild(t)}else if(t=o.childNodes.length>1?o.childNodes[r]:o.childNodes[0],(s=this.spliceEmptyNode(s,!0))&&s.childNodes.length>0)if(!!(1!==s.childNodes.length||"IMG"===s.childNodes[0].nodeName||!this.isImgElm(s)||""!==s.textContent.trim()))if(t)X.AppendBefore(s,t,!0);else o.appendChild(s),(a=document.createElement("div")).innerHTML="&#65279;&#65279;",o.insertBefore(a.firstChild,o.firstChild),t=o.firstChild;return t}return null},e.prototype.isImgElm=function(e){var t=!0;if(1===e.childNodes.length&&"IMG"!==e.childNodes[0].nodeName)for(var n=e.childNodes[0],i=0;!(0,o.hX)(n.childNodes)&&i<n.childNodes.length;i++)"IMG"===n.childNodes[i].nodeName&&(t=!1);else t=!0;return t},e.prototype.spliceEmptyNode=function(e,t){var n;return(n=1===e.childNodes.length&&"#text"===e.childNodes[0].nodeName&&""===e.childNodes[0].textContent||""===e.textContent?-1:e.childNodes.length-1)>-1&&!t?this.spliceEmptyNode(e.childNodes[n],t):n>-1?this.spliceEmptyNode(e.childNodes[0],t):3!==e.nodeType&&11!==e.nodeType&&e.parentNode.removeChild(e),e},e.prototype.GetCursorStart=function(e,t,n){for(var i=(e=n?e:e.reverse())[0],o=0;o<e.length&&(n?e[o]<t:e[o]>=t);o++)i=e[o];return i},e.prototype.GetCursorRange=function(e,t,n){var i=e.createRange(),o=[];o.push(0);for(var r=this.TrimLineBreak(n.data),a=r.indexOf(" ",0);-1!==a;)o.indexOf(a)<0&&o.push(a),new RegExp("\\s").test(r[a-1])&&o.indexOf(a-1)<0&&o.push(a-1),new RegExp("\\s").test(r[a+1])&&o.push(a+1),a=r.indexOf(" ",a+1);if(o.push(r.length),o.indexOf(t.startOffset)>=0||o.indexOf(t.startOffset-1)>=0&&(1!==t.startOffset||1===t.startOffset&&new RegExp("\\s").test(r[0]))||o[o.length-1]-1===t.startOffset)i=t,this.position=1;else{var s=this.GetCursorStart(o,t.startOffset,!0);this.position=t.startOffset-s,i.setStart(t.startContainer,s),i.setEnd(t.startContainer,this.GetCursorStart(o,t.startOffset,!1))}return i},e.prototype.GetCursorNode=function(e,t,n){return this.GetSpliceNode(this.GetCursorRange(e,t,n),n)},e.prototype.TrimLineBreak=function(e){return e.replace(/(\r\n\t|\n|\r\t)/gm," ")},e}(),z=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(a.VD,this.applyFormats,this),this.parent.observer.on(a.FL,this.onKeyUp,this),this.parent.observer.on(a.ck,this.onKeyDown,this)},e.prototype.getParentNode=function(e){for(;e.parentNode&&e.parentNode!==this.parent.editableElement;null)e=e.parentNode;return e},e.prototype.onKeyUp=function(e){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument),n=t.endContainer,i=n.lastChild;if(13===e.event.which&&t.startContainer===n&&3!==n.nodeType){var r=(0,o.n)("p");if(r.innerHTML="<br>",!(0,o.hX)(i)&&i&&"BR"===i.nodeName&&i.previousSibling&&"TABLE"===i.previousSibling.nodeName)n.replaceChild(r,i),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0);else{var a=this.parent.nodeSelection.getSelectionNodeCollectionBr(t)[0];!(0,o.hX)(a)&&"BR"===a.nodeName&&a.previousSibling&&"TABLE"===a.previousSibling.nodeName&&(n.replaceChild(r,a),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0))}}},e.prototype.onKeyDown=function(e){if(13===e.event.which){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument),n=0===t.startContainer.textContent.length||"PRE"===t.startContainer.nodeName?t.startContainer:t.startContainer.parentElement,i=0===t.endContainer.textContent.length||"PRE"===t.endContainer.nodeName?t.endContainer:t.endContainer.parentElement,r=(0,o.kp)(n,"pre"),a=(0,o.kp)(i,"pre");if(!(0,o.hX)(r)&&!(0,o.hX)(r.parentElement)&&"LI"===r.parentElement.tagName)return;if(((0,o.hX)(r)&&!(0,o.hX)(a)||!(0,o.hX)(r)&&(0,o.hX)(a))&&(e.event.preventDefault(),this.deleteContent(t),this.removeCodeContent(t),t=this.parent.nodeSelection.getRange(this.parent.currentDocument),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,i,0)),13===e.event.which&&!(0,o.hX)(r)&&!(0,o.hX)(a)){e.event.preventDefault(),this.deleteContent(t),this.removeCodeContent(t);var s=(t=this.parent.nodeSelection.getRange(this.parent.currentDocument)).startContainer.childNodes[t.endOffset],l=t.startContainer.childNodes[t.endOffset-1],d=t.startContainer;if((0,o.hX)(s)||(0,o.hX)(l)||!(0,o.hX)(s.nextSibling)||"BR"!==s.nodeName||"BR"!==l.nodeName)if(8203===d.textContent.charCodeAt(0)&&1===d.textContent.length||0===d.textContent.length){for(;"PRE"!==d.parentElement.nodeName&&(1===d.textContent.length||0===d.textContent.length);)d=d.parentElement;!(0,o.hX)(d.previousSibling)&&"BR"===d.previousSibling.nodeName&&(0,o.hX)(d.nextSibling)?this.paraFocus(d.parentElement):this.isNotEndCursor(r,t)}else this.isNotEndCursor(r,t);else this.paraFocus(t.startContainer,e.enterAction)}}},e.prototype.removeCodeContent=function(e){var t=new RegExp(String.fromCharCode(65279),"g");if(!(0,o.hX)(e.endContainer.textContent.match(t))){var n=65279===e.endContainer.textContent.charCodeAt(e.endOffset-1)?e.endOffset-2:e.endOffset;e.endContainer.textContent=e.endContainer.textContent.replace(t,""),""===e.endContainer.textContent?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,e.endContainer.parentElement,0):this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,e.endContainer,n)}},e.prototype.deleteContent=function(e){e.startContainer===e.endContainer&&e.startOffset===e.endOffset||e.deleteContents()},e.prototype.paraFocus=function(e,t){var n;"DIV"===t?(n=(0,o.n)("div")).innerHTML="<br>":"BR"===t?n=(0,o.n)("br"):(n=(0,o.n)("p")).innerHTML="<br>",this.parent.domNode.insertAfter(n,e),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n,0),(0,o.Yo)(e.lastChild)},e.prototype.isNotEndCursor=function(e,t){var n=new q,i=t.startOffset===e.lastChild.textContent.length&&e.lastChild.textContent===t.startContainer.textContent;if(0===e.textContent.indexOf(t.startContainer.textContent)&&(0===t.startOffset&&0===t.endOffset||"PRE"===t.startContainer.nodeName)){this.insertMarker(e,t);var r=(0,o.n)("br");e.childNodes[t.endOffset].parentElement.insertBefore(r,e.childNodes[t.endOffset])}else{var a=n.SplitNode(t,e,!0);this.insertMarker(e,t);var s=e.previousElementSibling;"PRE"===s.tagName&&(s.insertAdjacentHTML("beforeend","<br>"+a.innerHTML),(0,o.Yo)(e))}this.setCursorPosition(i,e)},e.prototype.setCursorPosition=function(e,t){var n=!1,i=this.parent.editableElement.querySelector(".tempSpan"),r=i.parentElement;if(""===i.parentNode.textContent?n=!0:this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,i,0),e)if(n)r===t?(this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,i,0),(0,o.Yo)(i)):this.focusSelectionParent(i,r);else{var a=(0,o.n)("br");this.parent.domNode.insertAfter(a,i),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,i,0),(0,o.Yo)(i)}else n?this.focusSelectionParent(i,r):(0,o.Yo)(i)},e.prototype.focusSelectionParent=function(e,t){(0,o.Yo)(e),t.innerHTML="\u200b",this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,t,0)},e.prototype.insertMarker=function(e,t){var n=(0,o.n)("span",{className:"tempSpan"});"PRE"===t.startContainer.nodeName?e.childNodes[t.endOffset].parentElement.insertBefore(n,e.childNodes[t.endOffset]):t.startContainer.parentElement.insertBefore(n,t.startContainer)},e.prototype.applyFormats=function(e){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument),n=!1;this.parent.editableElement!==t.endContainer||(0,o.hX)(this.parent.editableElement.children[t.endOffset-1])||"TABLE"!==this.parent.editableElement.children[t.endOffset-1].tagName||t.collapsed||(n=!0);var i=this.parent.nodeSelection.save(t,this.parent.currentDocument);this.parent.domNode.setMarker(i);var r=this.parent.domNode.blockNodes();if("BR"===e.enterAction){this.setSelectionBRConfig();var a=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),s=this.parent.nodeSelection.getSelectionNodes(a),l=[];0===s.length&&s.push(r[0]);for(var d=0;d<s.length;d++){for(var h=s[d],p=void 0;!this.parent.domNode.isBlockNode(h)&&h!==this.parent.editableElement;)p=h,h=h.parentElement;this.parent.domNode.isBlockNode(h)&&h===this.parent.editableElement&&l.push(p)}for(d=0;d<l.length;d++)if(!this.parent.domNode.isBlockNode(l[d])){for(var c=h=l[d];h===this.parent.editableElement;)c=h,h=h.parentElement;var u=void 0;this.parent.domNode.isBlockNode(c.parentElement)&&c.parentElement===this.parent.editableElement?(u=(0,o.n)("div"),c.parentElement.insertBefore(u,c),u.appendChild(c)):u=c;for(var m=u.previousSibling;!(0,o.hX)(m)&&"BR"!==m.nodeName&&!this.parent.domNode.isBlockNode(m);)u.firstChild.parentElement.insertBefore(m,u.firstChild),m=u.previousSibling;(0,o.hX)(m)||"BR"!==m.nodeName||(0,o.Yo)(m);for(var g=u.nextSibling;!(0,o.hX)(g)&&"BR"!==g.nodeName&&!this.parent.domNode.isBlockNode(g);)u.appendChild(g),g=u.nextSibling;(0,o.hX)(g)||"BR"!==g.nodeName||(0,o.Yo)(g)}this.setSelectionBRConfig(),r=this.parent.domNode.blockNodes()}for(d=0;d<r.length;d++){var f=void 0,b=void 0;if("blockquote"===e.subCommand.toLowerCase()?(f=this.getParentNode(r[d]),b=this.parent.domNode.isList(f)||"TABLE"===f.tagName?f.outerHTML:f.innerHTML):b=(f=r[d]).innerHTML,!(e.subCommand.toLowerCase()===f.tagName.toLowerCase()&&("pre"!==e.subCommand.toLowerCase()||!(0,o.hX)(e.exeValue)&&"dropDownSelect"===e.exeValue.name)||(0,o.hX)(f.parentNode)||"TABLE"===f.tagName&&"pre"===e.subCommand.toLowerCase())){this.cleanFormats(f,e.subCommand);var v="pre"===e.subCommand.toLowerCase()&&"pre"===f.tagName.toLowerCase()?"p":e.subCommand,y=this.parent.domNode.createTagString(v,f,b.replace(/>\s+</g,"><"));"LI"===f.tagName?(f.innerHTML="",f.insertAdjacentHTML("beforeend",y)):this.parent.domNode.replaceWith(f,y)}}this.preFormatMerge();var C=this.parent.editableElement.querySelector("."+B),S=this.parent.editableElement.querySelector("."+P);(0,o.hX)(C)||(0,o.hX)(S)||(C=C.lastChild,S=S.lastChild),i=this.parent.domNode.saveMarker(i,null),(0,I.wU)()&&(0,I.WM)(this.parent.editableElement,e.selector),n?this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,C,S,0,S.textContent.length):i.restore(),e.callBack&&e.callBack({requestType:e.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})},e.prototype.setSelectionBRConfig=function(){var e=this.parent.editableElement.querySelector("."+B),t=this.parent.editableElement.querySelector("."+P);(0,o.hX)(t)?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,e,0):this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,e,t,0,0)},e.prototype.preFormatMerge=function(){var e=this.parent.editableElement.querySelectorAll("PRE");if(!(0,o.hX)(e))for(var t=0;t<e.length;t++){var n=e[t].previousElementSibling;(0,o.hX)(n)||"PRE"!==n.tagName||(n.insertAdjacentHTML("beforeend","<br>"+e[t].innerHTML),(0,o.Yo)(e[t]))}},e.prototype.cleanFormats=function(e,t){var n=["display","font-size","margin-top","margin-bottom","margin-left","margin-right","font-weight"];t=t.toLowerCase();for(var i=0;i<n.length&&"p"!==t&&"blockquote"!==t&&"pre"!==t;i++)e.style.removeProperty(n[i])},e}(),j=function(){function e(){}return e.Insert=function(e,t,n,i){var r,a;"string"===typeof t?((a=document.createElement("div")).innerHTML=t,r=i?a:a.firstChild):i&&((0,o.hX)(t)||(0,o.hX)(t.classList)||!t.classList.contains("pasteContent"))?((a=document.createElement("div")).appendChild(t),r=a):r=t;var s=new A,l=new q,d=s.getRange(e);d.startContainer===n&&d.startContainer===d.endContainer&&0===d.startOffset&&d.startOffset===d.endOffset&&0===n.textContent.length&&"P"===n.children[0].tagName&&(s.setSelectionText(e,d.startContainer.children[0],d.startContainer.children[0],0,0),d=s.getRange(e));var h=d.startOffset===d.endOffset&&0===d.startOffset&&d.startContainer===d.endContainer,p=d.collapsed,c=this.getNodeCollection(d,s,r),u="table"===r.nodeName.toLowerCase()?this.closestEle(c[0].parentNode,n):c[0];if(i||!(0,o.hX)(r)&&!(0,o.hX)(r.classList)&&r.classList.contains("pasteContent"))this.pasteInsertHTML(c,r,d,s,l,e,p,u,n);else if(n!==d.startContainer&&(!p&&(u.nodeType!==Node.ELEMENT_NODE||-1===N.indexOf(u.tagName.toLocaleLowerCase()))||"table"===r.nodeName.toLowerCase()&&u&&-1===N.indexOf(u.tagName.toLocaleLowerCase()))){var m=l.GetSpliceNode(d,u),g=m.previousSibling,f=m.parentNode;if(1===c.length||"table"===r.nodeName.toLowerCase()&&0===m.childElementCount)s.setSelectionContents(e,m),d=s.getRange(e);else{var b=l.GetSpliceNode(d,c[c.length-1].parentElement);b=(0,o.hX)(b)?m:b,s.setSelectionText(e,m,b,0,3===b.nodeType?b.textContent.length:b.childNodes.length),d=s.getRange(e)}d.extractContents(),"TABLE"===t.tagName&&this.removeEmptyElements(n);for(var v=0;v<c.length;v++)if(3!==c[v].nodeType&&null!=c[v].parentNode){if("IMG"===c[v].nodeName)continue;c[v].parentNode.removeChild(c[v])}if(g)X.AppendBefore(r,g,!0);else{for(var y=null;f!==n&&f.firstChild&&""===f.textContent.trim();){y=f,f=f.parentNode}null!==y&&(f=y),f.firstChild&&(f!==n||"TABLE"===r.nodeName&&h&&f===d.startContainer&&f===d.endContainer)?""===f.textContent.trim()&&f!==n?(X.AppendBefore(r,f,!1),(0,o.Yo)(f)):X.AppendBefore(r,f.firstChild,!1):f.appendChild(r)}"IMG"===r.nodeName?this.imageFocus(r,s,e):3!==r.nodeType?s.setSelectionText(e,r,r,0,r.childNodes.length):s.setSelectionText(e,r,r,0,r.textContent.length)}else{if(d.deleteContents(),h&&""===d.startContainer.textContent&&"BR"!==d.startContainer.nodeName&&(d.startContainer.innerHTML=""),o.Pw.isIE){var C=e.createDocumentFragment();C.appendChild(r),d.insertNode(C)}else if(1===d.startContainer.nodeType&&"hr"===d.startContainer.nodeName.toLowerCase()&&"hr"===d.endContainer.nodeName.toLowerCase()){var S=d.startContainer.nextElementSibling;S&&(S.querySelector("br")&&(0,o.Yo)(S.querySelector("br")),S.appendChild(r))}else"BR"===d.startContainer.nodeName?d.startContainer.parentElement.insertBefore(r,d.startContainer):d.insertNode(r);3!==r.nodeType&&r.childNodes.length>0?s.setSelectionText(e,r,r,1,1):"IMG"===r.nodeName?this.imageFocus(r,s,e):3!==r.nodeType?s.setSelectionContents(e,r):s.setSelectionText(e,r,r,r.textContent.length,r.textContent.length)}},e.pasteInsertHTML=function(e,t,n,i,r,a,s,l,d){var h,p,c,u,m=n.startOffset===n.endOffset&&n.startContainer===n.endContainer;if(m&&n.startContainer===d&&""===d.textContent){var g=this.getImmediateBlockNode(e[e.length-1],d);i.setSelectionText(a,g,g,0,0),n=i.getRange(a)}d!==n.startContainer&&(!s&&(l.nodeType!==Node.ELEMENT_NODE||-1===N.indexOf(l.tagName.toLocaleLowerCase()))||"table"===t.nodeName.toLowerCase()&&l&&-1===N.indexOf(l.tagName.toLocaleLowerCase()))&&(u=r.GetSpliceNode(n,l),p=(0,o.hX)(u.previousSibling)?u.parentNode.previousSibling:u.previousSibling,1===e.length?(i.setSelectionContents(a,u),n=i.getRange(a),c=!0):(h=r.GetSpliceNode(n,e[e.length-1].parentElement),h=(0,o.hX)(h)?u:h,i.setSelectionText(a,u,h,0,3===h.nodeType?h.textContent.length:h.childNodes.length),n=i.getRange(a),c=!1));var f=!1;this.removingComments(t);for(var b,v=t.childNodes,y=0;y<v.length;y++)if(T.indexOf(v[y].nodeName.toLocaleLowerCase())>=0){f=!0;break}var C=document.createDocumentFragment();if(f){this.insertTempNode(n,t,e,r,d);var S=!0,E=void 0,w=void 0,k=void 0;for(n.deleteContents();t.firstChild;)if("#text"!==t.firstChild.nodeName||""!==t.firstChild.textContent.trim())if("#text"===t.firstChild.nodeName&&S||this.inlineNode.indexOf(t.firstChild.nodeName.toLocaleLowerCase())>=0&&S){if(b=t.firstChild,(0,o.hX)(t.previousElementSibling)){var L=(0,o.n)("p");t.parentElement.insertBefore(L,t)}t.previousElementSibling.appendChild(t.firstChild)}else b=t.firstChild,"#text"===t.firstChild.nodeName||this.inlineNode.indexOf(t.firstChild.nodeName.toLocaleLowerCase())>=0?(E?(k.appendChild(t.firstChild),C.appendChild(k)):((w=(0,o.n)("p")).appendChild(t.firstChild),C.appendChild(w)),k=w,E=!0):(C.appendChild(t.firstChild),E=!1),S=!1;else(0,o.Yo)(t.firstChild);t.parentNode.replaceChild(C,t)}else if(m){var D=(0,o.n)("span",{className:"tempSpan"}),x=(0,o.kp)(n.startContainer.parentElement,"a");if(3===n.startContainer.nodeType&&x){var M=this.getImmediateBlockNode(n.startContainer,d);M.querySelectorAll("br").length>0&&(0,o.Yo)(M.querySelector("br")),(0,o.kp)(x,"span").appendChild(D)}else n.insertNode(D);for(;t.firstChild;)b=t.firstChild,C.appendChild(t.firstChild);D.parentNode.replaceChild(C,D)}else{for(;t.firstChild;)b=t.firstChild,C.appendChild(t.firstChild);c?u.parentNode.replaceChild(C,u):(n.deleteContents(),(0,o.Yo)(h),(0,o.hX)(p)?d.appendChild(C):p.parentNode.appendChild(C))}"#text"===b.nodeName?this.placeCursorEnd(b,t,i,a,d):this.cursorPos(b,t,i,a,d)},e.placeCursorEnd=function(e,t,n,i,r){for(e="BR"===e.nodeName?(0,o.hX)(e.previousSibling)?e.parentNode:e.previousSibling:e;!(0,o.hX)(e)&&"#text"!==e.nodeName&&"IMG"!==e.nodeName&&"BR"!==e.nodeName&&"HR"!==e.nodeName;)e=e.lastChild;"IMG"===(e=(0,o.hX)(e)?t:e).nodeName?this.imageFocus(e,n,i):n.setSelectionText(i,e,e,e.textContent.length,e.textContent.length),this.removeEmptyElements(r)},e.getNodeCollection=function(e,t,n){var i=[];return e.startOffset===e.endOffset&&e.startContainer===e.endContainer&&"BR"!=e.startContainer.nodeName&&("TD"===e.startContainer.nodeName||3!==e.startContainer.nodeType&&n.classList&&n.classList.contains("pasteContent"))?i.push(e.startContainer.childNodes[e.endOffset]):i=t.getInsertNodeCollection(e),i},e.insertTempNode=function(e,t,n,i,r){if(e.startContainer!==r||(0,o.hX)(e.startContainer.childNodes[e.endOffset-1])||"TABLE"!==e.startContainer.childNodes[e.endOffset-1].nodeName)if(e.startContainer!==r||(0,o.hX)(e.startContainer.childNodes[e.endOffset])||"TABLE"!==e.startContainer.childNodes[e.endOffset].nodeName)if(e.startContainer===e.endContainer&&3!==e.startContainer.nodeType&&"HR"===t.firstChild.nodeName)e.startContainer.classList.contains("e-content")||"BODY"===e.startContainer.nodeName?e.startContainer.appendChild(t):e.startContainer.parentNode.insertBefore(t,e.startContainer);else{var a=this.getImmediateBlockNode(n[n.length-1],r);if(((0,o.hX)(a)||(0,o.hX)(a.parentElement))&&3!==e.endContainer.nodeType&&(a=e.endContainer,e.setEnd(a,e.endContainer.textContent.length)),"BODY"===a.nodeName&&e.startContainer===e.endContainer&&1===e.startContainer.nodeType&&(a=e.startContainer),a.closest("LI")&&t&&t.firstElementChild&&("OL"===t.firstElementChild.tagName||"UL"===t.firstElementChild.tagName))for(var s=void 0;t.firstElementChild.lastElementChild&&"LI"===t.firstElementChild.lastElementChild.tagName;)(s=t.firstElementChild.lastElementChild).style.removeProperty("margin-left"),s.style.removeProperty("margin-top"),s.style.removeProperty("margin-bottom"),t.firstElementChild.insertAdjacentElement("afterend",s);if("TD"===a.nodeName||"TH"===a.nodeName){var l=(0,o.n)("span",{className:"tempSpan"});e.insertNode(l),l.parentNode.replaceChild(t,l)}else{var d=n[n.length-1],h=void 0;(h="BR"!==d.nodeName&&"HR"!==d.nodeName||(0,o.hX)(d.parentElement)||0!==d.parentElement.textContent.trim().length?i.GetSpliceNode(e,a):d).parentNode.replaceChild(t,h)}}else e.startContainer.insertBefore(t,e.startContainer.childNodes[e.endOffset]);else(0,o.hX)(e.startContainer.childNodes[e.endOffset-1].nextSibling)?e.startContainer.appendChild(t):e.startContainer.insertBefore(t,e.startContainer.childNodes[e.endOffset-1].nextSibling)},e.cursorPos=function(e,t,n,i,r){e.classList.add("lastNode"),r.innerHTML=(0,I.fo)(r.innerHTML),e=r.querySelector(".lastNode"),(0,o.hX)(e)||(this.placeCursorEnd(e,t,n,i,r),e.classList.remove("lastNode"),0===e.classList.length&&e.removeAttribute("class"))},e.imageFocus=function(e,t,n){var i=document.createTextNode(" ");e.parentNode.insertBefore(i,e.nextSibling),t.setSelectionText(n,e.nextSibling,e.nextSibling,0,0)},e.getImmediateBlockNode=function(e,t){do{e=e.parentNode}while(e&&T.indexOf(e.nodeName.toLocaleLowerCase())<0);return e},e.removingComments=function(e){var t=e.innerHTML;t=t.replace(/<!--[\s\S]*?-->/g,""),e.innerHTML=t},e.findDetachEmptyElem=function(e){return(0,o.hX)(e.parentElement)?null:""===e.parentElement.textContent.trim()&&"true"!==e.parentElement.contentEditable?this.findDetachEmptyElem(e.parentElement):e},e.removeEmptyElements=function(e){for(var t=e.querySelectorAll(":empty"),n=0;n<t.length;n++)if("IMG"!==t[n].tagName&&"BR"!==t[n].tagName&&"IFRAME"!==t[n].tagName&&"TD"!==t[n].tagName&&"SOURCE"!==t[n].tagName&&"HR"!==t[n].tagName){var i=this.findDetachEmptyElem(t[n]);(0,o.hX)(i)||(0,o.Yo)(i)}},e.closestEle=function(e,t){for(var n=e;n&&1===n.nodeType;){if(n.parentNode===t||!(0,o.hX)(n.parentNode.tagName)&&-1!==k.indexOf(n.parentNode.tagName.toLocaleLowerCase()))return n;n=n.parentNode}return null},e.inlineNode=["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","font","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","strong","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"],e}(),U=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(h,this.linkCommand,this)},e.prototype.linkCommand=function(e){switch(e.value.toString().toLocaleLowerCase()){case"createlink":case"editlink":this.createLink(e);break;case"openlink":this.openLink(e);break;case"removelink":this.removeLink(e)}},e.prototype.createLink=function(e){var t=!(0,o.hX)(e.item.selectParent)&&e.item.selectParent.length>0&&(0,o.kp)(e.item.selectParent[0],"a");if(t=(0,o.hX)(t)?!(0,o.hX)(e.item.selectParent)&&e.item.selectParent.length>0?e.item.selectParent[0]:null:t,(0,o.hX)(t)||"A"!==t.tagName){var n=new A,i=n.getRange(this.parent.currentDocument);"#text"===i.endContainer.nodeName&&i.startContainer.textContent.length===i.endOffset+1&&" "===i.endContainer.textContent.charAt(i.endOffset)&&"A"===i.endContainer.nextSibling.nodeName&&(n.setSelectionText(this.parent.currentDocument,i.startContainer,i.endContainer,i.startOffset,i.endOffset+1),i=n.getRange(this.parent.currentDocument));var r=!!(0,o.hX)(e.item.text)||e.item.text.replace(/ /g,"").localeCompare(i.toString().replace(/\n/g," ").replace(/ /g,""))<0;if(e.event&&"keydown"===e.event.type&&(32===e.event.keyCode||13===e.event.keyCode)||"Paste"===e.item.action||i.collapsed||r){var a=this.createAchorNode(e);if(a.innerText=""===e.item.text?e.item.url:e.item.text,e.item.selection.restore(),j.Insert(this.parent.currentDocument,a,this.parent.editableElement),!e.event||"keydown"!==e.event.type||32!==e.event.keyCode&&13!==e.event.keyCode){h="Paste"===e.item.action?a.childNodes[0].textContent.length:0;e.item.selection.setSelectionText(this.parent.currentDocument,a.childNodes[0],a.childNodes[0],h,a.childNodes[0].textContent.length)}else{var s=e.item.selection.range.startContainer;s.textContent=this.removeText(s.textContent,e.item.text)}}else this.createLinkNode(e)}else{var l=t,d="";if((0,o.hX)(e.item.url)||l.setAttribute("href",e.item.url),(0,o.hX)(e.item.title)||l.setAttribute("title",e.item.title),(0,o.hX)(e.item.text)||""===e.item.text||(d=l.innerText,l.innerText=e.item.text),(0,o.hX)(e.item.target)?l.removeAttribute("target"):l.setAttribute("target",e.item.target),d===e.item.text)e.item.selection.setSelectionText(this.parent.currentDocument,l,l,1,1),e.item.selection.restore();else{var h="Paste"===e.item.action?l.childNodes[0].textContent.length:0;e.item.selection.setSelectionText(this.parent.currentDocument,l.childNodes[0],l.childNodes[0],h,l.childNodes[0].textContent.length)}}e.callBack&&e.callBack({requestType:"Links",editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e.prototype.createLinkNode=function(e){for(var t,n,i=new A,o=new q,r=i.getRange(this.parent.currentDocument),a=this.getSelectionNodes(i.getNodeCollection(r)),s=i.save(r,this.parent.currentDocument),l=[],d=[],h=[],p=[],c=[],u=0;u<a.length;u++)a[u]=o.GetSpliceNode(r,a[u]),l[u]=a[u];for(var m=0;m<l.length;m++){var g=!0;for(t=l[m];!0===g;){if("A"===t.parentNode.nodeName){var f=t.parentNode;t.parentNode.parentNode.insertBefore(f.firstChild,f),t.parentNode.removeChild(f)}this.isBlockNode(t.parentNode)||0===l.length||0===m||m===l.length-1||3===r.startContainer.nodeType?(d[m]=t,g=!1):t=t.parentNode}}m=0;for(var b=0;m<d.length;m++)if(0===m&&(c[b]=d[m]),d.length>1&&m<d.length-1){if(d[m].parentElement===d[m+1].parentElement&&d[m]===d[m+1])continue;c[b+1]=d[m+1],b++}var v=0;p[v]=this.createAchorNode(e);for(m=0;m<c.length;m++)if(0===m&&(n=c[m].cloneNode(!0),p[m].appendChild(n)),m<c.length-1)if(c[m].parentNode===c[m+1].parentNode){var y=c[m+1].cloneNode(!0);p[v].appendChild(y)}else p[v+=1]=this.createAchorNode(e),n=c[m+1].cloneNode(!0),p[v].appendChild(n);this.parent.nodeSelection.setRange(document,s.range);m=0;for(var C=0,S=0;m<=c.length;m++)0===m&&(c[m].parentNode.insertBefore(p[C],c[m].nextSibling),1===this.parent.domNode.blockNodes().length&&this.parent.nodeSelection.setSelectionNode(this.parent.currentDocument,p[C]),h[S]=c[m],S++),m<c.length-1&&(c[m].parentNode===c[m+1].parentNode?(h[S]=c[m+1],S++):(C+=1,c[m+1].parentNode.insertBefore(p[C],c[m+1]),h[S]=c[m+1],S++));for(m=0;m<h.length;m++)h[m].parentNode&&h[m].parentNode.removeChild(h[m])},e.prototype.createAchorNode=function(e){var t=(0,o.n)("a",{className:"e-rte-anchor",attrs:{href:e.item.url,title:(0,o.hX)(e.item.title)||""===e.item.title?e.item.url:e.item.title}});return(0,o.hX)(e.item.target)||t.setAttribute("target",e.item.target),t},e.prototype.getSelectionNodes=function(e){e=e.reverse();for(var t=0;t<e.length;t++)3===e[t].nodeType&&""!==e[t].textContent.trim()||"IMG"!==e[t].nodeName&&(e.splice(t,1),t--);return e.reverse()},e.prototype.isBlockNode=function(e){return!!e&&e.nodeType===Node.ELEMENT_NODE&&T.indexOf(e.tagName.toLowerCase())>=0},e.prototype.removeText=function(e,t){for(var n=e.split(" "),i=0;i<n.length;i++)n[i]===t&&(n.splice(i,1),i--);return n.join(" ")+" "},e.prototype.openLink=function(e){document.defaultView.open(e.item.url,e.item.target),this.callBack(e)},e.prototype.removeLink=function(e){var t=this.parent.domNode.blockNodes();if(t.length<2){this.parent.domNode.setMarker(e.item.selection);for(var n=(0,o.kp)(e.item.selectParent[0],"a"),i=n||e.item.selectParent[0],r=i.parentNode,a=[];i.firstChild;null)a.push(r.insertBefore(i.firstChild,i));r.removeChild(i),a&&1===a.length&&(e.item.selection.startContainer=e.item.selection.getNodeArray(a[a.length-1],!0),e.item.selection.endContainer=e.item.selection.startContainer),e.item.selection=this.parent.domNode.saveMarker(e.item.selection)}else for(var s=0;s<t.length;s++)for(var l=t[s].querySelectorAll("a"),d=0;d<l.length;d++)document.getSelection().containsNode(l[d],!0)&&(l[d].outerHTML=l[d].innerHTML);e.item.selection.restore(),this.callBack(e)},e.prototype.callBack=function(e){e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e}(),Q=function(){function e(e){this.alignments={JustifyLeft:"left",JustifyCenter:"center",JustifyRight:"right",JustifyFull:"justify"},this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(S,this.applyAlignment,this),this.parent.observer.on(a.ck,this.onKeyDown,this)},e.prototype.onKeyDown=function(e){switch(e.event.action){case"justify-center":this.applyAlignment({subCommand:"JustifyCenter",callBack:e.callBack}),e.event.preventDefault();break;case"justify-full":this.applyAlignment({subCommand:"JustifyFull",callBack:e.callBack}),e.event.preventDefault();break;case"justify-left":this.applyAlignment({subCommand:"JustifyLeft",callBack:e.callBack}),e.event.preventDefault();break;case"justify-right":this.applyAlignment({subCommand:"JustifyRight",callBack:e.callBack}),e.event.preventDefault()}},e.prototype.getTableNode=function(e){var t=e.startContainer.nodeType===Node.ELEMENT_NODE?e.startContainer:e.startContainer.parentNode;return[(0,o.kp)(t,"td,th")]},e.prototype.applyAlignment=function(e){var t="Table"===e.value,n=this.parent.nodeSelection.getRange(this.parent.currentDocument),i=this.parent.nodeSelection.save(n,this.parent.currentDocument);if(t)(0,o.sN)(this.getTableNode(n)[0],{"text-align":this.alignments[e.subCommand]});else{this.parent.domNode.setMarker(i);for(var r=this.parent.domNode.blockNodes(),a=0;a<r.length;a++){var s=r[a];(0,o.sN)(s,{"text-align":this.alignments[e.subCommand]})}var l=this.parent.domNode.getImageTagInSelection();for(a=0;a<l.length;a++){var d=[];d.push(l[a]),this.parent.imgObj.imageCommand({item:{selectNode:d},subCommand:e.subCommand,value:e.subCommand,callBack:e.callBack,selector:e.selector})}this.parent.editableElement.focus(),i=this.parent.domNode.saveMarker(i),(0,I.wU)()&&(0,I.WM)(this.parent.editableElement,e.selector),i.restore()}e.callBack&&e.callBack({requestType:e.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:t?this.getTableNode(n):this.parent.domNode.blockNodes()})},e}(),W=function(){function e(e){this.indentValue=20,this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(E,this.applyIndents,this),this.parent.observer.on(a.ck,this.onKeyDown,this)},e.prototype.onKeyDown=function(e){switch(e.event.action){case"indents":this.applyIndents({subCommand:"Indent",callBack:e.callBack}),e.event.preventDefault();break;case"outdents":this.applyIndents({subCommand:"Outdent",callBack:e.callBack}),e.event.preventDefault()}},e.prototype.applyIndents=function(e){var t=this.parent.editableElement,n=t.classList.contains("e-rtl"),i=this.parent.nodeSelection.getRange(this.parent.currentDocument),o=this.parent.nodeSelection.save(i,this.parent.currentDocument);this.parent.domNode.setMarker(o);for(var r=this.parent.domNode.blockNodes(),s=r.slice(),l=[],d=0;d<s.length;d++)"LI"!==s[d].tagName&&"LI"===s[d].parentNode.tagName?(r.splice(r.indexOf(s[d]),1),l.push(s[d].parentNode)):"LI"===s[d].tagName&&(r.splice(r.indexOf(s[d]),1),l.push(s[d]));l.length>0&&this.parent.observer.notify(a.ck,{event:{preventDefault:function(){},stopPropagation:function(){},shiftKey:"Indent"!==e.subCommand,which:9,action:"indent"},ignoreDefault:!0});for(d=0;d<r.length;d++){var h=r[d],p=n?h.style.marginRight:h.style.marginLeft,c=void 0;"Indent"===e.subCommand?(c=""===p?this.indentValue+"px":parseInt(p,null)+this.indentValue+"px",n?h.style.marginRight=c:h.style.marginLeft=c):(c=""===p||"0px"===p?"":parseInt(p,null)-this.indentValue+"px",n?h.style.marginRight=c:h.style.marginLeft=c)}t.focus(),(0,I.wU)()&&(0,I.WM)(t,e.selector),(o=this.parent.domNode.saveMarker(o)).restore(),e.callBack&&e.callBack({requestType:e.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})},e}(),_="e-imgright",J="e-imgleft",Y="e-imgcenter",V="e-imgbreak",K="e-img-caption",G="e-caption-inline",$=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(l,this.imageCommand,this)},e.prototype.imageCommand=function(e){switch(e.value.toString().toLowerCase()){case"image":case"replace":this.createImage(e);break;case"insertlink":this.insertImageLink(e);break;case"openimagelink":this.openImageLink(e);break;case"editimagelink":this.editImageLink(e);break;case"removeimagelink":this.removeImageLink(e);break;case"remove":this.removeImage(e);break;case"alttext":this.insertAltTextImage(e);break;case"dimension":this.imageDimension(e);break;case"caption":this.imageCaption(e);break;case"justifyleft":this.imageJustifyLeft(e);break;case"justifycenter":this.imageJustifyCenter(e);break;case"justifyright":this.imageJustifyRight(e);break;case"inline":this.imageInline(e);break;case"break":this.imageBreak(e)}},e.prototype.createImage=function(e){var t=this,n=!1;if(e.item.url=(0,o.hX)(e.item.url)||"undefined"===e.item.url?e.item.src:e.item.url,(0,o.hX)(e.item.selectParent)||"IMG"!==e.item.selectParent[0].tagName){var i=(0,o.n)("img");this.setStyle(i,e),(0,o.hX)(e.item.selection)||e.item.selection.restore(),(0,o.hX)(e.selector)||"pasteCleanupModule"!==e.selector?j.Insert(this.parent.currentDocument,i,this.parent.editableElement):e.callBack({requestType:"Images",editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:[i]})}else{var r=e.item.selectParent[0];this.setStyle(r,e),n=!0}if(e.callBack&&((0,o.hX)(e.selector)||!(0,o.hX)(e.selector)&&"pasteCleanupModule"!==e.selector)){var a=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)[0],s="Replace"===e.value||n?e.item.selectParent[0]:o.Pw.isIE?a.previousSibling:a.previousElementSibling;s.addEventListener("load",(function(){"Replace"===e.value&&n||e.callBack({requestType:"Images",editorMode:"HTML",event:e.event,range:t.parent.nodeSelection.getRange(t.parent.currentDocument),elements:[s]})}))}},e.prototype.setStyle=function(e,t){(0,o.hX)(t.item.url)||e.setAttribute("src",t.item.url),e.setAttribute("class","e-rte-image"+((0,o.hX)(t.item.cssClass)?"":" "+t.item.cssClass)),(0,o.hX)(t.item.altText)||e.setAttribute("alt",t.item.altText),(0,o.hX)(t.item.width)||(0,o.hX)(t.item.width.width)||e.setAttribute("width",this.calculateStyleValue(t.item.width.width)),(0,o.hX)(t.item.height)||(0,o.hX)(t.item.height.height)||e.setAttribute("height",this.calculateStyleValue(t.item.height.height)),(0,o.hX)(t.item.width)||(0,o.hX)(t.item.width.minWidth)||(e.style.minWidth=this.calculateStyleValue(t.item.width.minWidth)),(0,o.hX)(t.item.width)||(0,o.hX)(t.item.width.maxWidth)||(e.style.maxWidth=this.calculateStyleValue(t.item.width.maxWidth)),(0,o.hX)(t.item.height)||(0,o.hX)(t.item.height.minHeight)||(e.style.minHeight=this.calculateStyleValue(t.item.height.minHeight)),(0,o.hX)(t.item.height)||(0,o.hX)(t.item.height.maxHeight)||(e.style.maxHeight=this.calculateStyleValue(t.item.height.maxHeight))},e.prototype.calculateStyleValue=function(e){return"string"===typeof e&&(e.indexOf("px")||e.indexOf("%")||e.indexOf("auto"))?e:e+"px"},e.prototype.insertImageLink=function(e){var t=(0,o.n)("a",{attrs:{href:e.item.url}});e.item.selectNode[0].parentElement.classList.contains("e-img-wrap")&&(e.item.selection.restore(),t.setAttribute("contenteditable","true")),t.appendChild(e.item.selectNode[0]),(0,o.hX)(e.item.target)||t.setAttribute("target",e.item.target),j.Insert(this.parent.currentDocument,t,this.parent.editableElement),this.callBack(e)},e.prototype.openImageLink=function(e){document.defaultView.open(e.item.url,e.item.target),this.callBack(e)},e.prototype.removeImageLink=function(e){var t=e.item.selectParent[0];if(t.classList.contains("e-img-caption")){var n=(0,o.Lt)(".e-img-wrap",t),i=(0,o.Lt)(".e-img-inner",t),r=i.cloneNode(!0);(0,o.Yo)((0,o.Lt)("a",t)),(0,o.Yo)(i),n.appendChild(e.item.insertElement),n.appendChild(r)}else(0,o.Yo)(t),o.Pw.isIE&&e.item.selection.restore(),j.Insert(this.parent.currentDocument,e.item.insertElement,this.parent.editableElement);this.callBack(e)},e.prototype.editImageLink=function(e){e.item.selectNode[0].parentElement.href=e.item.url,(0,o.hX)(e.item.target)?e.item.selectNode[0].parentElement.removeAttribute("target"):e.item.selectNode[0].parentElement.target=e.item.target,this.callBack(e)},e.prototype.removeImage=function(e){(0,o.kp)(e.item.selectNode[0],"a")&&("A"!==e.item.selectNode[0].parentElement.nodeName||(0,o.hX)(e.item.selectNode[0].parentElement.innerText))?(0,o.Yo)((0,o.kp)(e.item.selectNode[0],"a")):(0,o.hX)((0,o.kp)(e.item.selectNode[0],"."+K))?(0,o.Yo)(e.item.selectNode[0]):(0,o.Yo)((0,o.kp)(e.item.selectNode[0],"."+K)),this.callBack(e)},e.prototype.insertAltTextImage=function(e){e.item.selectNode[0].setAttribute("alt",e.item.altText),this.callBack(e)},e.prototype.imageDimension=function(e){var t=e.item.selectNode[0];t.style.height="",t.style.width="","auto"!==e.item.width?t.style.width=(0,o.IV)(e.item.width):t.removeAttribute("width"),"auto"!==e.item.height?t.style.height=(0,o.IV)(e.item.height):t.removeAttribute("height"),this.callBack(e)},e.prototype.imageCaption=function(e){j.Insert(this.parent.currentDocument,e.item.insertElement,this.parent.editableElement),this.callBack(e)},e.prototype.imageJustifyLeft=function(e){var t=e.item.selectNode[0];(0,o.hX)(t)||(t.removeAttribute("class"),(0,o.iQ)([t],"e-rte-image"),(0,o.hX)((0,o.kp)(t,"."+K))||((0,o.vy)([(0,o.kp)(t,"."+K)],_),(0,o.iQ)([(0,o.kp)(t,"."+K)],J)),"A"===t.parentElement.nodeName?((0,o.vy)([t.parentElement],_),(0,o.iQ)([t.parentElement],J),(0,o.iQ)([t],J)):(0,o.iQ)([t],J),this.callBack(e))},e.prototype.imageJustifyCenter=function(e){var t=e.item.selectNode[0];(0,o.hX)(t)||(t.removeAttribute("class"),(0,o.iQ)([t],"e-rte-image"),(0,o.hX)((0,o.kp)(t,"."+K))||((0,o.vy)([(0,o.kp)(t,"."+K)],J),(0,o.vy)([(0,o.kp)(t,"."+K)],_),(0,o.iQ)([(0,o.kp)(t,"."+K)],Y)),"A"===t.parentElement.nodeName?((0,o.vy)([t.parentElement],J),(0,o.vy)([t.parentElement],_),(0,o.iQ)([t.parentElement],Y),(0,o.iQ)([t],Y)):(0,o.iQ)([t],Y),this.callBack(e))},e.prototype.imageJustifyRight=function(e){var t=e.item.selectNode[0];(0,o.hX)(t)||(t.removeAttribute("class"),(0,o.iQ)([t],"e-rte-image"),(0,o.hX)((0,o.kp)(t,"."+K))||((0,o.vy)([(0,o.kp)(t,"."+K)],J),(0,o.iQ)([(0,o.kp)(t,"."+K)],_)),"A"===t.parentElement.nodeName?((0,o.vy)([t.parentElement],J),(0,o.iQ)([t.parentElement],_),(0,o.iQ)([t],_)):(0,o.iQ)([t],_),this.callBack(e))},e.prototype.imageInline=function(e){var t=e.item.selectNode[0];t.removeAttribute("class"),(0,o.iQ)([t],"e-rte-image"),(0,o.iQ)([t],"e-imginline"),(0,o.hX)((0,o.kp)(t,"."+K))||((0,o.vy)([(0,o.kp)(t,"."+K)],V),(0,o.vy)([(0,o.kp)(t,"."+K)],Y),(0,o.vy)([(0,o.kp)(t,"."+K)],J),(0,o.vy)([(0,o.kp)(t,"."+K)],_),(0,o.iQ)([(0,o.kp)(t,"."+K)],G)),this.callBack(e)},e.prototype.imageBreak=function(e){var t=e.item.selectNode[0];t.removeAttribute("class"),(0,o.iQ)([t],V),(0,o.iQ)([t],"e-rte-image"),(0,o.hX)((0,o.kp)(t,"."+K))||((0,o.vy)([(0,o.kp)(t,"."+K)],G),(0,o.vy)([(0,o.kp)(t,"."+K)],Y),(0,o.vy)([(0,o.kp)(t,"."+K)],J),(0,o.vy)([(0,o.kp)(t,"."+K)],_),(0,o.iQ)([(0,o.kp)(t,"."+K)],V)),this.callBack(e)},e.prototype.callBack=function(e){e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e}(),Z=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(d,this.createTable,this),this.parent.observer.on(p,this.insertRow,this),this.parent.observer.on(c,this.insertColumn,this),this.parent.observer.on(u,this.deleteRow,this),this.parent.observer.on(m,this.deleteColumn,this),this.parent.observer.on(g,this.removeTable,this),this.parent.observer.on(f,this.tableHeader,this),this.parent.observer.on(b,this.tableVerticalAlign,this),this.parent.observer.on(v,this.cellMerge,this),this.parent.observer.on(C,this.HorizontalSplit,this),this.parent.observer.on(y,this.VerticalSplit,this),this.parent.observer.on("TABLE_MOVE",this.tableMove,this)},e.prototype.createTable=function(e){var t=(0,o.n)("table",{className:"e-rte-table"}),n=(0,o.n)("tbody");(0,o.hX)(e.item.width.width)||(t.style.width=this.calculateStyleValue(e.item.width.width)),(0,o.hX)(e.item.width.minWidth)||(t.style.minWidth=this.calculateStyleValue(e.item.width.minWidth)),(0,o.hX)(e.item.width.maxWidth)||(t.style.maxWidth=this.calculateStyleValue(e.item.width.maxWidth));for(var i=parseInt(e.item.width.width,10)>100?100/e.item.columns:parseInt(e.item.width.width,10)/e.item.columns,r=0;r<e.item.rows;r++){for(var a=(0,o.n)("tr"),s=0;s<e.item.columns;s++){var l=(0,o.n)("td");l.appendChild((0,o.n)("br")),l.style.width=i+"%",a.appendChild(l)}n.appendChild(a)}if(t.appendChild(n),e.item.selection.restore(),j.Insert(this.parent.currentDocument,t,this.parent.editableElement),this.removeEmptyNode(),e.item.selection.setSelectionText(this.parent.currentDocument,t.querySelector("td"),t.querySelector("td"),0,0),null===t.nextElementSibling){var d=void 0;"DIV"===e.enterAction?(d=(0,o.n)("div")).appendChild((0,o.n)("br")):"BR"===e.enterAction?d=(0,o.n)("br"):(d=(0,o.n)("p")).appendChild((0,o.n)("br")),this.insertAfter(d,t)}return t.querySelector("td").classList.add("e-cell-select"),e.callBack&&e.callBack({requestType:"Table",editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:[t]}),t},e.prototype.calculateStyleValue=function(e){return"string"===typeof e&&(e.indexOf("px")||e.indexOf("%")||e.indexOf("auto"))?e:e+"px"},e.prototype.removeEmptyNode=function(){for(var e=this.parent.editableElement.querySelectorAll("ul:empty, ol:empty"),t=0;t<e.length;t++)(0,o.Yo)(e[t]);var n=this.parent.editableElement.querySelectorAll("li *:empty");for(t=0;t<n.length;t++)(0,o.Yo)(n[t]),n.length===t+1&&(n=this.parent.editableElement.querySelectorAll("li *:empty"),t=-1);var i=this.parent.editableElement.querySelectorAll("li:empty");for(t=0;t<i.length;t++)(0,o.Yo)(i[t])},e.prototype.insertAfter=function(e,t){t.parentNode.insertBefore(e,t.nextSibling)},e.prototype.getSelectedCellMinMaxIndex=function(e){for(var t=this.curTable.querySelectorAll(".e-cell-select"),n=0,i=e.length,o=0,r=e[0].length,a=0;n<t.length;n++){var s=this.getCorrespondingIndex(t[n],e),l=this.FindIndex(s[0],s[1],e);i=Math.min(s[0],i),o=Math.max(l[0],o),r=Math.min(s[1],r),a=Math.max(l[1],a)}return{startRow:i,endRow:o,startColumn:r,endColumn:a}},e.prototype.insertRow=function(e){var t="InsertRowBefore"!==e.item.subCommand,n=e.item.selection.range.startContainer;if("TH"!==n.nodeName&&"TD"!==n.nodeName&&(n=(0,o.kp)(n.parentElement,"td,th")),"th"!==n.nodeName.toLowerCase()||"InsertRowBefore"!==e.item.subCommand){if(this.curTable=(0,o.kp)(this.parent.nodeSelection.range.startContainer.parentElement,"table"),0===this.curTable.querySelectorAll(".e-cell-select").length){var i=this.curTable.rows[this.curTable.rows.length-1],r=i.cloneNode(!0);r.removeAttribute("rowspan"),this.insertAfter(r,i)}else{for(var a=this.getCorrespondingColumns(),s=this.getSelectedCellMinMaxIndex(a),l=t?s.endRow:s.startRow,d=(0,o.n)("tr"),h=this.curTable.querySelectorAll("th.e-cell-select").length>0,p=0;p<a[l].length;p++)if(t&&l<a.length-1&&a[l][p]===a[l+1][p]||!t&&0<l&&a[l][p]===a[l-1][p])(0===p||0<p&&a[l][p]!==a[l][p-1])&&a[l][p].setAttribute("rowspan",(parseInt(a[l][p].getAttribute("rowspan"),10)+1).toString());else{var c=(0,o.n)("td");c.appendChild((0,o.n)("br")),d.appendChild(c),c.setAttribute("style",a[h&&t?l+1:l][p].getAttribute("style"))}var u=void 0;u=h&&t?this.curTable.querySelector("tbody").childNodes[0]:this.curTable.rows[l],"InsertRowBefore"===e.item.subCommand||h?u.parentElement.insertBefore(d,u):this.insertAfter(d,u)}e.item.selection.setSelectionText(this.parent.currentDocument,e.item.selection.range.startContainer,e.item.selection.range.startContainer,0,0),e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},e.prototype.insertColumn=function(e){var t=e.item.selection.range.startContainer;"TH"!==t.nodeName&&"TD"!==t.nodeName&&(t=(0,o.kp)(t.parentElement,"td,th"));for(var n,i=(0,o.kp)(t,"tr"),r=(0,o.kp)(i,"table").rows,a=Array.prototype.slice.call(i.querySelectorAll(":scope > td, :scope > th")).indexOf(t),s=parseInt(e.item.width,10)/i.querySelectorAll(":scope > td, :scope > th").length,l=parseInt(e.item.width,10)/(i.querySelectorAll(":scope > td, :scope > th").length+1),d=(0,o.kp)(i,"table"),h=(0,o.kp)(i,"table").querySelectorAll("th,td"),p=0;p<h.length;p++)h[p].dataset.oldWidth=h[p].offsetWidth/d.offsetWidth*100+"%";for(p=0;p<r.length;p++){var c=(n=r[p].querySelectorAll(":scope > td, :scope > th")[a]).cloneNode(!0);c.innerHTML="",c.appendChild((0,o.n)("br")),c.removeAttribute("class"),c.removeAttribute("colspan"),c.removeAttribute("rowspan"),"InsertColumnLeft"===e.item.subCommand?n.parentElement.insertBefore(c,n):this.insertAfter(c,n),c.style.width=l.toFixed(4)+"%",delete c.dataset.oldWidth}for(p=0;p<h.length;p++)h[p].style.width=(Number(h[p].dataset.oldWidth.split("%")[0])*l/s).toFixed(4)+"%",delete h[p].dataset.oldWidth;e.item.selection.setSelectionText(this.parent.currentDocument,t,t,0,0),e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e.prototype.deleteColumn=function(e){var t=e.item.selection.range.startContainer;3===t.nodeType&&(t=(0,o.kp)(t.parentElement,"td,th"));var n=(0,o.kp)(t,"TH"===t.tagName?"thead":"tbody"),i=n&&Array.prototype.indexOf.call(n.childNodes,t.parentNode);if(this.curTable=(0,o.kp)(t,"table"),1===(0,o.kp)(t,"tr").querySelectorAll("th,td").length)e.item.selection.restore(),(0,o.Yo)((0,o.kp)(t.parentElement,"table"));else{for(var r=void 0,a=this.getCorrespondingColumns(),s=this.getSelectedCellMinMaxIndex(a),l=s.startColumn,d=s.endColumn,h=0;h<a.length;h++)for(var p=a[h],c=0;c<p.length;c++){var u=p[c],m=this.getCorrespondingIndex(u,a),g=parseInt(u.getAttribute("colspan"),10)||1;m[1]+(g-1)>=l&&m[1]<=d&&(g>1?u.setAttribute("colspan",(g-1).toString()):((0,o.Yo)(u),r=c,o.Pw.isIE&&(e.item.selection.setSelectionText(this.parent.currentDocument,this.curTable.querySelector("td"),this.curTable.querySelector("td"),0,0),this.curTable.querySelector("td, th").classList.add("e-cell-select"))))}if(r>-1){var f=n.children[i],b=f&&f.children[r<=f.children.length-1?r:r-1];b&&(e.item.selection.setSelectionText(this.parent.currentDocument,b,b,0,0),b.classList.add("e-cell-select"))}}if(e.callBack){var v=this.parent.nodeSelection.getRange(this.parent.currentDocument).startContainer;if("TD"!==v.nodeName){var y=this.parent.nodeSelection.getRange(this.parent.currentDocument).startOffset,C=v.children[y];C&&this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,C,0)}e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},e.prototype.deleteRow=function(e){var t=e.item.selection.range.startContainer;3===t.nodeType&&(t=(0,o.kp)(t.parentElement,"td,th"));var n,i=Array.prototype.indexOf.call(t.parentNode.childNodes,t);this.curTable=(0,o.kp)(t,"table");var r,a,s=this.getCorrespondingColumns(),l=this.getSelectedCellMinMaxIndex(s);if(1===this.curTable.rows.length)e.item.selection.restore(),(0,o.Yo)((0,o.kp)(t.parentElement,"table"));else for(r=l.endRow;r>=l.startRow;r--){for(n=this.curTable.rows[r],a=0;a<s[r].length;a++){if((0===a||s[r][a]!==s[r][a-1])&&1<parseInt(s[r][a].getAttribute("rowspan"),10)){var d=parseInt(s[r][a].getAttribute("rowspan"),10)-1;1===d?s[r][a].removeAttribute("rowspan"):s[r][a].setAttribute("rowspan",d.toString())}if(r<s.length-1&&s[r][a]===s[r+1][a]&&(0===r||s[r][a]!==s[r-1][a])){var h=s[r][a],p=void 0;for(p=a;0<p&&s[r][p]===s[r][p-1];p--)0===p?this.curTable.rows[r+1].prepend(h):s[r+1][p-1].insertAdjacentElement("afterend",h)}}var c=n.rowIndex;this.curTable.deleteRow(c);var u=(0,o.hX)(this.curTable.rows[c])?this.curTable.querySelectorAll("tbody tr")[c-1]:this.curTable.querySelectorAll("tbody tr")[c],m=u&&u.querySelectorAll("td")[i];m?(e.item.selection.setSelectionText(this.parent.currentDocument,m,m,0,0),m.classList.add("e-cell-select")):(e.item.selection.setSelectionText(this.parent.currentDocument,this.curTable.querySelector("td"),this.curTable.querySelector("td"),0,0),this.curTable.querySelector("td, th").classList.add("e-cell-select"))}e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e.prototype.removeTable=function(e){var t=e.item.selection.range.startContainer;t=3===t.nodeType?t.parentNode:t;var n=(0,o.kp)(t.parentElement,"table");n&&(e.item.selection.restore(),(0,o.Yo)(n)),e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e.prototype.tableHeader=function(e){var t=!1,n=e.item.selection.range.startContainer;n=3===n.nodeType?n.parentNode:n;var i=(0,o.kp)(n.parentElement,"table");if([].slice.call(i.childNodes).forEach((function(e){"THEAD"===e.nodeName&&(t=!0)})),i&&!t){for(var r=i.querySelector("tr").childElementCount,a=0,s=0;s<r;s++)a+=parseInt(i.querySelector("tr").children[s].getAttribute("colspan"),10)||1;for(var l=i.createTHead().insertRow(0),d=0;d<a;d++){var h=(0,o.n)("th");h.appendChild((0,o.n)("br")),l.appendChild(h)}}else i.deleteTHead();e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e.prototype.tableVerticalAlign=function(e){"AlignTop"===e.item.subCommand?e.item.tableCell.style.verticalAlign="top":"AlignMiddle"===e.item.subCommand?e.item.tableCell.style.verticalAlign="middle":e.item.tableCell.style.verticalAlign="bottom",e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e.prototype.cellMerge=function(e){(0,o.hX)(this.curTable)&&(this.curTable=(0,o.kp)(this.parent.nodeSelection.range.startContainer.parentElement,"table"));var t=this.curTable.querySelectorAll(".e-cell-select");if(!(t.length<2)){this.mergeCellContent();var n=this.getSelectedMinMaxIndexes(this.getCorrespondingColumns()),i=t[0],r=i.parentElement.querySelectorAll(".e-cell-select");n.startColumn<n.endColumn&&i.setAttribute("colspan",(n.endColumn-n.startColumn+1).toString()),n.startRow<n.endRow&&i.setAttribute("rowspan",(n.endRow-n.startRow+1).toString());for(var a=0,s=r.length-1;s>=0;s--)a+=parseFloat(r[s].style.width);i.style.width=a+"%";for(var l=1;l<=t.length-1;l++)(0,o.Yo)(t[l]);for(l=0;l<this.curTable.rows.length;l++)""===this.curTable.rows[l].innerHTML&&(0,o.Yo)(this.curTable.rows[l]);this.updateRowSpanStyle(n.startRow,n.endRow,this.getCorrespondingColumns()),this.updateColSpanStyle(n.startColumn,n.endColumn,this.getCorrespondingColumns()),e.item.selection.setSelectionText(this.parent.currentDocument,e.item.selection.range.startContainer,e.item.selection.range.startContainer,0,0),this.parent.nodeSelection.range&&this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,this.parent.nodeSelection.range.endContainer,0),e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},e.prototype.updateColSpanStyle=function(e,t,n){var i,o,r,a,s=0,l=0,d=n;if(e<(t=Math.min(t,d[0].length-1))){for(;o<=t;o++)if(!(e<o&&d[0][o]===d[0][o-1])&&1<(s=Math.min(parseInt(d[0][o].getAttribute("colspan"),10)||1,t-e+1))&&d[0][o]===d[0][o+1])for(l=s-1,i=1;i<d.length;i++){if(d[i][o]!==d[i-1][o])for(r=o;r<o+s;r++)if(1<(a=parseInt(d[i][r].getAttribute("colspan"),10)||1)&&d[i][r]===d[i][r+1])r+=l=Math.min(l,a-1);else if(!(l=Math.max(0,l-1)))break;if(!l)break}l&&this.updateCellAttribute(d,l,"colspan",0,d.length-1,e,t)}},e.prototype.updateRowSpanStyle=function(e,t,n){var i,o,r,a,s=0,l=0,d=n;if(e<(t=Math.min(t,d.length-1))){for(i=e;i<=t;i++)if(!(e<i&&d[i][0]===d[i-1][0])&&1<(s=Math.min(parseInt(d[i][0].getAttribute("rowspan"),10)||1,t-e+1))&&d[i][0]===d[i+1][0])for(l=s-1,o=1;o<d[0].length;o++)if(d[i][o]!==d[i][o-1]){for(r=i;r<i+s;r++)if(1<(a=parseInt(d[r][o].getAttribute("rowspan"),10)||1)&&d[r][o]===d[r+1][o])r+=l=Math.min(l,a-1);else if(!(l=Math.max(0,l-1)))break;if(!l)break}l&&this.updateCellAttribute(d,l,"rowspan",e,t,0,d[0].length-1)}},e.prototype.updateCellAttribute=function(e,t,n,i,o,r,a){var s,l,d;for(s=i;s<=o;s++)for(l=r;l<=a;l++)i<s&&e[s][l]===e[s-1][l]||r<l&&e[s][l]===e[s][l-1]||1<(d=parseInt(e[s][l].getAttribute(n),10)||1)&&(1<d-t?e[s][l].setAttribute(n,(d-t).toString()):e[s][l].removeAttribute(n))},e.prototype.mergeCellContent=function(){for(var e=this.curTable.querySelectorAll(".e-cell-select"),t=e[0].innerHTML,n=1;n<e.length-1;n++)"<br>"!==e[n].innerHTML&&(t+=e[n].innerHTML);e[0].innerHTML=t},e.prototype.getSelectedMinMaxIndexes=function(e){var t=this.curTable.querySelectorAll(".e-cell-select");if(0<t.length){for(var n=e.length,i=0,o=e[0].length,r=0,a=0;a<t.length;a++){var s=this.getCorrespondingIndex(t[a],e),l=this.FindIndex(s[0],s[1],e);n=Math.min(s[0],n),i=Math.max(l[0],i),o=Math.min(s[1],o),r=Math.max(l[1],r)}return{startRow:n,endRow:i,startColumn:o,endColumn:r}}return null},e.prototype.HorizontalSplit=function(e){var t=e.item.selection.range.startContainer;if(this.curTable=(0,o.kp)(t.parentElement,"table"),!(this.curTable.querySelectorAll(".e-cell-select").length>1)){this.activeCell=this.curTable.querySelector(".e-cell-select");var n=this.activeCell.cloneNode(!0);n.removeAttribute("class"),n.innerHTML="</br>";var i=this.getCorrespondingIndex(this.activeCell,this.getCorrespondingColumns()),r=this.getCorrespondingColumns(),a=this.activeCell.getAttribute("rowspan")?parseInt(this.activeCell.getAttribute("rowspan"),10):1;if(a>1){var s=Math.ceil(a/2);1<s?this.activeCell.setAttribute("rowspan",s.toString()):this.activeCell.removeAttribute("rowspan"),1<a-s?n.setAttribute("rowspan",(a-s).toString()):n.removeAttribute("rowspan");var l,d=void 0;for(l=i[0]+Math.ceil(a/2),d=0===i[1]?i[1]:i[1]-1;0<=d&&(r[l][d]===r[l][d-1]||0<l&&r[l][d]===r[l-1][d]);)d--;-1===d?this.curTable.rows[l].firstChild?this.curTable.rows[l].prepend(n):this.curTable.appendChild(n):r[l][d].insertAdjacentElement("afterend",n)}else{var h=(0,o.n)("tr");h.appendChild(n);for(var p=r[i[0]],c=0;c<=p.length-1;c++)p[c]!==p[c-1]&&p[c]!==this.activeCell&&p[c].setAttribute("rowspan",((parseInt(p[c].getAttribute("rowspan"),10)?parseInt(p[c].getAttribute("rowspan"),10):1)+1).toString());this.activeCell.parentNode.insertAdjacentElement("afterend",h)}e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},e.prototype.VerticalSplit=function(e){var t=e.item.selection.range.startContainer;if(this.curTable=(0,o.kp)(t.parentElement,"table"),!(this.curTable.querySelectorAll(".e-cell-select").length>1)){this.activeCell=this.curTable.querySelector(".e-cell-select");var n=this.curTable.rows,i=this.activeCell.cloneNode(!0);i.removeAttribute("class"),i.innerHTML="</br>";var r=parseFloat(this.activeCell.style.width)/2;if("TH"===this.activeCell.tagName&&isNaN(r)){for(var a=this.curTable.querySelector("tr").childElementCount,s=0;s<a;s++)parseInt(this.curTable.querySelector("tr").children[s].getAttribute("colspan"),10)||1;r=parseFloat((this.activeCell.offsetWidth/2/this.curTable.offsetWidth*100).toFixed(1))}var l=this.getCorrespondingIndex(this.activeCell,this.getCorrespondingColumns()),d=this.getCorrespondingColumns(),h=parseInt(this.activeCell.getAttribute("colspan"),10);if(h>1)1<Math.ceil(h/2)?this.activeCell.setAttribute("colspan",(h/2).toString()):this.activeCell.removeAttribute("colspan"),1<h-h/2?i.setAttribute("colspan",(h-h/2).toString()):i.removeAttribute("colspan");else for(s=0;s<=n.length-1;s++)if(0===s||d[s][l[1]]!==d[s-1][l[1]]){var p=d[s][l[1]];p!==this.activeCell&&p.setAttribute("colspan",((parseInt(p.getAttribute("colspan"),10)?parseInt(p.getAttribute("colspan"),10):1)+1).toString())}this.activeCell.style.width=r+"%",i.style.width=r+"%",this.activeCell.parentNode.insertBefore(i,this.activeCell.nextSibling),e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},e.prototype.getCorrespondingColumns=function(){for(var e=[],t=this.curTable.rows,n=0;n<=t.length-1;n++)for(var i=t[n],o=0,r=0;r<=i.children.length-1;r++){for(var a=i.children[r],s=a,l=parseInt(s.getAttribute("colspan"),10)||1,d=parseInt(s.getAttribute("rowspan"),10)||1,h=n;h<n+d;h++)for(var p=o;p<o+l;p++)e[h]||(e[h]=[]),e[h][p]?o++:e[h][p]=a;o+=0}return e},e.prototype.FindIndex=function(e,t,n){var i,o;for(i=e+1,o=t+1;i<n.length;){if(n[i][t]!==n[e][t]){i--;break}i++}for(i===n.length&&i--;o<n[e].length;){if(n[e][o]!==n[e][t]){o--;break}o++}return o===n[e].length&&o--,[i,o]},e.prototype.getCorrespondingIndex=function(e,t){for(var n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)if(t[n][i]===e)return[n,i];return[]},e.prototype.highlightCells=function(e,t,n,i,o){var r,a,s,l,d=e,h=t,p=n,c=i,u=new ee;for(r=d;r<=h;r++){for(((1<(parseInt(o[r][p].getAttribute("rowspan"),10)||1)||1<(parseInt(o[r][p].getAttribute("colspan"),10)||1))&&(l=this.FindIndex((s=this.getCorrespondingIndex(o[r][p],o))[0],s[1],o))||(1<(parseInt(o[r][c].getAttribute("rowspan"),10)||1)||1<(parseInt(o[r][c].getAttribute("colspan"),10)||1))&&(l=this.FindIndex((s=this.getCorrespondingIndex(o[r][c],o))[0],s[1],o)))&&(d=Math.min(s[0],d),h=Math.max(l[0],h),p=Math.min(s[1],p),c=Math.max(l[1],c)),a=p;a<=c;a++)((1<(parseInt(o[d][a].getAttribute("rowspan"),10)||1)||1<(parseInt(o[d][a].getAttribute("colspan"),10)||1))&&(l=this.FindIndex((s=this.getCorrespondingIndex(o[d][a],o))[0],s[1],o))||(1<(parseInt(o[h][a].getAttribute("rowspan"),10)||1)||1<(parseInt(o[h][a].getAttribute("colspan"),10)||1))&&(l=this.FindIndex((s=this.getCorrespondingIndex(o[h][a],o))[0],s[1],o)))&&(d=Math.min(s[0],d),h=Math.max(l[0],h),p=Math.min(s[1],p),c=Math.max(l[1],c));u=d===e&&h===t&&p===n&&c===i?{startRow:e,endRow:t,startColumn:n,endColumn:i}:this.highlightCells(d,h,p,c,o)}return u},e.prototype.tableMove=function(e){this.activeCell=e.selectNode[0];var t=e.event.target,n=this.activeCell.tagName,i=t.tagName;if(this.curTable=(0,o.kp)(t,"table"),this.curTable.querySelectorAll(".e-cell-select").length>1&&this.parent.nodeSelection.Clear(this.parent.currentDocument),"TD"===t.tagName||"TH"===t.tagName||n===i){for(var r=Array.prototype.slice.call(this.activeCell.parentElement.parentElement.children).indexOf(this.activeCell.parentElement),a=Array.prototype.slice.call(this.activeCell.parentElement.children).indexOf(this.activeCell),s=Array.prototype.slice.call(t.parentElement.parentElement.children).indexOf(t.parentElement),l=Array.prototype.slice.call(t.parentElement.children).indexOf(t),d=this.curTable.querySelectorAll(".e-cell-select"),h=d.length-1;h>=0;h--)this.activeCell!==d[h]&&d[h].classList.remove("e-cell-select");if(r!==s||a!==l){for(var p=this.getCorrespondingColumns(),c=this.getCorrespondingIndex(this.activeCell,p),u=this.getCorrespondingIndex(t,p),m=this.highlightCells(Math.min(c[0],u[0]),Math.max(c[0],u[0]),Math.min(c[1],u[1]),Math.max(c[1],u[1]),p),g=m.startRow;g<=m.endRow;g++)for(var f=m.startColumn;f<=m.endColumn;f++)p[g][f].classList.add("e-cell-select");this.parent.nodeSelection.range&&(this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,this.parent.nodeSelection.range.endContainer,this.parent.nodeSelection.range.endContainer,0,0),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,this.parent.nodeSelection.range.endContainer,0))}}},e}(),ee=function(){},te=function(){function e(){}return e.prototype.getFormattedNode=function(e,t,n){var i=this.getFormatParent(e,t,n);return null!==i&&i!==n?i:null},e.prototype.getFormatParent=function(e,t,n){do{e=e.parentNode}while(e&&e!==n&&!this.isFormattedNode(e,t));return e},e.prototype.isFormattedNode=function(t,n){switch(n){case"bold":return e.isBold(t);case"italic":return e.isItalic(t);case"underline":return e.isUnderline(t);case"strikethrough":return e.isStrikethrough(t);case"superscript":return e.isSuperscript(t);case"subscript":return e.isSubscript(t);case"fontcolor":return this.isFontColor(t);case"fontname":return this.isFontName(t);case"fontsize":return this.isFontSize(t);case"backgroundcolor":return this.isBackgroundColor(t);default:return!1}},e.isBold=function(e){return-1!==["strong","b"].indexOf(e.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(e.nodeName.toLowerCase())||!e.style||"bold"!==e.style.fontWeight)},e.isItalic=function(e){return-1!==["em","i"].indexOf(e.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(e.nodeName.toLowerCase())||!e.style||"italic"!==e.style.fontStyle)},e.isUnderline=function(e){return-1!==["u"].indexOf(e.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(e.nodeName.toLowerCase())||!e.style||"underline"!==e.style.textDecoration)},e.isStrikethrough=function(e){return-1!==["del","strike"].indexOf(e.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(e.nodeName.toLowerCase())||!e.style||"line-through"!==e.style.textDecoration)},e.isSuperscript=function(e){return-1!==["sup"].indexOf(e.nodeName.toLowerCase())},e.isSubscript=function(e){return-1!==["sub"].indexOf(e.nodeName.toLowerCase())},e.prototype.isFontColor=function(t){var n=t.style&&t.style.color;return-1!==e.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==n&&""!==n&&void 0!==n},e.prototype.isBackgroundColor=function(t){var n=t.style&&t.style.backgroundColor;return-1!==e.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==n&&""!==n&&void 0!==n},e.prototype.isFontSize=function(t){var n=t.style&&t.style.fontSize;return-1!==e.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==n&&""!==n&&void 0!==n},e.prototype.isFontName=function(t){var n=t.style&&t.style.fontFamily;return-1!==e.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==n&&""!==n&&void 0!==n},e.inlineTags=["a","abbr","acronym","b","bdo","big","cite","code","dfn","em","i","kbd","label","q","samp","small","span","strong","sub","sup","tt","u","var","del"],e}(),ne=function(){function e(){}return e.applyFormat=function(e,t,n,i,r,a){this.enterAction=i;if(["bold","italic","underline","strikethrough","superscript","subscript","uppercase","lowercase","fontcolor","fontname","fontsize","backgroundcolor"].indexOf(t)>-1){"backgroundcolor"===t&&""===r&&(r="transparent");var s,l=new A,d=new F(n,e),h=new q,p=new te,c=l.getRange(e),u=l.save(c,e),m=c.collapsed?l.getSelectionNodeCollection(c):l.getSelectionNodeCollectionBr(c),g=!1,f=!1,b=!1,v=["fontcolor","fontname","fontsize","backgroundcolor"].indexOf(t)>-1;if(c.collapsed)if(m.length>0)g=!0,c=h.GetCursorRange(e,c,m[0]);else if(3===c.startContainer.nodeType&&c.startContainer.parentElement.childElementCount>0&&c.startOffset>0&&"br"!==c.startContainer.parentElement.firstElementChild.tagName.toLowerCase())g=!0,c=h.GetCursorRange(e,c,c.startContainer),m.push(c.startContainer);else{var y=this.insertCursorNode(e,l,c,p,h,t,r,n);l.endContainer=l.startContainer=l.getNodeArray(y,!0);var C="BR"===y.nodeName&&y.parentNode.childNodes;(0,o.hX)(C)||1!==C.length||"BR"!==C[0].nodeName||0!==m.length?l.endOffset=l.startOffset=1:(l.setSelectionText(e,c.startContainer,c.endContainer,0,0),b=!0),"BR"===y.nodeName&&0===y.parentNode.textContent.length&&(b=!0)}s=c.collapsed;for(var S=!1,E=0;E<m.length;E++){var w=p.getFormattedNode(m[E],t,n);null===w&&("subscript"===t?S=null!==(w=p.getFormattedNode(m[E],"superscript",n)):"superscript"===t&&(S=null!==(w=p.getFormattedNode(m[E],"subscript",n)))),0===E&&null===w&&(f=!0),m[E]=null===w||f&&!v?this.insertFormat(e,m,E,w,s,f,v,c,h,t,r):this.removeFormat(m,E,w,s,f,v,c,h,t,r,l,n,d),l=this.applySelection(m,l,h,E,g)}(0,I.wU)()&&(0,I.WM)(n,a),b||u.restore(),S&&this.applyFormat(e,t,n,i)}},e.insertCursorNode=function(e,t,n,i,r,a,s,l){var d=t.getNodeCollection(n),h=new F(l,e),p=d.length>0?d.length>1&&n.startContainer===n.endContainer?this.getCursorFormat(i,d,a,l):i.getFormattedNode(d[0],a,l):null,c=null;if(p){if(c=d[0],8203===p.firstChild.textContent.charCodeAt(0)&&3===p.firstChild.nodeType){var u=new RegExp(String.fromCharCode(8203),"g"),m=void 0;p.firstChild===c?(c.textContent=p.parentElement&&(h.isBlockNode(p.parentElement)&&p.parentElement.textContent.length<=1?p.parentElement.childElementCount>1:0===p.childElementCount)&&(p.parentElement.textContent.length>1||p.parentElement.firstChild&&1===p.parentElement.firstChild.nodeType)?c.textContent:c.textContent.replace(u,""),m=c,!0):(p.firstChild.textContent=p.firstChild.textContent.replace(u,""),m=p.firstChild);var g=void 0;if(0===m.textContent.length)if((0,o.hX)(m.previousSibling)){if(!(0,o.hX)(m.parentElement)&&0===m.parentElement.textContent.length){var f=document.createElement("BR");m.parentElement.appendChild(f),(0,o.Yo)(m),c=f,t.setCursorPoint(e,c.parentElement,0)}}else c=m.previousSibling,g=m.textContent.length-1,t.setCursorPoint(e,m,g)}["fontcolor","fontname","fontsize","backgroundcolor"].indexOf(a)>-1?("fontcolor"===a?p.style.color=s:"fontname"===a?p.style.fontFamily=s:"fontsize"===a?p.style.fontSize=s:p.style.backgroundColor=s,c=p):X.unwrap(p)}else d.length>1&&n.startOffset>0&&d[0].firstElementChild&&"br"===d[0].firstElementChild.tagName.toLowerCase()&&(d[0].innerHTML=""),1!==d.length||0!==n.startOffset||"BR"!==d[0].nodeName&&"BR"!==d[0].nextSibling.nodeName||(0,o.Yo)("#text"===d[0].nodeName?d[0].nextSibling:d[0]),c=this.getInsertNode(e,n,a,s).firstChild;return c},e.getCursorFormat=function(e,t,n,i){for(var o,r=0;r<t.length;r++)o=t[r].lastElementChild?t[r].lastElementChild:t[r];return e.getFormattedNode(o,n,i)},e.removeFormat=function(e,t,n,i,r,a,s,l,d,h,p,c,u){var m,g,f=null,b="#text"===s.startContainer.nodeName?s.startContainer.textContent.substring(s.startOffset,s.startContainer.textContent.length):s.startContainer.textContent;if(s.startContainer!==s.endContainer||0!==s.startOffset||s.endOffset!==s.startContainer.length){var v=[],y=e[t];do{v.push(p.getIndex(y)),y=y.parentNode}while(y&&y!==n);if("BR"!==e[t].nodeName&&(y=f=i&&n.textContent.length-1===s.startOffset?l.SplitNode(s,n,!0):l.GetSpliceNode(s,n)),i){for(var C=f;null!==C.firstChild&&3!==C.firstChild.nodeType;null)C=C.firstChild;C.innerHTML="&#8203;",e[t]=C.firstChild}else{for(;y&&y.childNodes.length>0&&v.length-1>=0&&y.childNodes.length>v[v.length-1];)y=y.childNodes[v[v.length-1]],v.pop();if("BR"!==e[t].nodeName)if(3!==y.nodeType||i&&""===y.nodeValue){var S=document.createElement("div");S.innerHTML="&#8203;",3!==y.nodeType?(y.insertBefore(S.firstChild,y.firstChild),e[t]=y.firstChild):(y.parentNode.insertBefore(S.firstChild,y),e[t]=y.previousSibling,y.parentNode.removeChild(y))}else e[t]=y}}if("backgroundcolor"===d&&(m=n.style.fontSize),"fontsize"===d){var E=(0,o.kp)(e[t].parentElement,"span[style*=background-color]");(0,o.hX)(E)||(g=E.style.backgroundColor)}var w=n.getAttribute("style"),T=n.tagName,k=X.unwrap(n);if(k[0]&&!a)for(var N=k[t]?k[t]:k[0],L=N;N&&N.parentElement&&N.parentElement!==c;N)if(N.parentElement&&N.parentElement.tagName.toLocaleLowerCase()===n.tagName.toLocaleLowerCase()&&(N.parentElement.childElementCount>1||s.startOffset>1)){if(L.parentElement&&L.parentElement.tagName.toLocaleLowerCase()===n.tagName.toLocaleLowerCase()&&s.startOffset===s.endOffset&&1!==L.nodeType&&!(0,o.hX)(L.textContent)&&L.parentElement.childElementCount>1&&(s.setStart(L,0),s.setEnd(L,L.textContent.length),l.SplitNode(s,L.parentElement,!1)),"span"===N.parentElement.tagName.toLocaleLowerCase()&&"underline"===n.style.textDecoration&&"underline"!==N.parentElement.style.textDecoration){N=N.parentElement;continue}X.unwrap(N.parentElement),N=(0,o.hX)(N.parentElement)||u.isBlockNode(N.parentElement)?N.parentElement:L}else N=N.parentElement;if(k.length>0&&a){for(var D=0;D<k.length;D++)(3!==k[D].nodeType||k[D].textContent&&k[D].textContent.trim().length>0)&&(k[D]=X.Wrap(k[D],this.GetFormatNode(d,h,T,w)),k[D].textContent===b&&(0===D?s.setStartBefore(k[D]):D===k.length-1&&s.setEndAfter(k[D])));var x=e[t].parentElement;if((0,o.hX)(m)||""===m||(x.style.fontSize=m),(0,o.hX)(g)||""===g||(x.style.backgroundColor=g),"backgroundcolor"===d&&!(0,o.hX)(m)&&""!==m&&x.parentElement.innerHTML===x.outerHTML){var M=x.parentElement;M.parentElement.insertBefore(x,M),(0,o.Yo)(M)}if("fontsize"===d||"fontcolor"===d){for(var A=e[t].parentElement,O=e[t].parentElement;!(0,o.hX)(O)&&"li"!==O.tagName.toLowerCase();)A=O=O.parentElement;(0,o.hX)(A)||"li"!==A.tagName.toLowerCase()||A.textContent.trim()!==e[t].textContent.trim()||("fontsize"===d?A.style.fontSize=h:(A.style.color=h,A.style.textDecoration="inherit"))}}return e[t]},e.insertFormat=function(e,t,n,i,r,a,s,l,d,h,p){if(r)if("uppercase"!==h&&"lowercase"!==h){c=this.getInsertNode(e,l,h,p);t[n]=c.firstChild,d.position=1}else d.position=l.startOffset;else if(null===i&&a||s){if("BR"!==t[n].nodeName&&(t[n]=d.GetSpliceNode(l,t[n]),t[n].textContent=d.TrimLineBreak(t[n].textContent)),"uppercase"===h||"lowercase"===h)t[n].textContent="uppercase"===h?t[n].textContent.toLocaleUpperCase():t[n].textContent.toLocaleLowerCase();else if(!0!==s||""!==p){var c=this.GetFormatNode(h,p);if("fontsize"===h||"fontcolor"===h){for(var u=t[n].parentElement,m=t[n].parentElement;!(0,o.hX)(m)&&"li"!==m.tagName.toLowerCase();)u=m=m.parentElement;if((0,o.hX)(u)||"li"!==u.tagName.toLowerCase()||u.textContent.trim()!==t[n].textContent.trim()||("fontsize"===h?u.style.fontSize=p:(u.style.color=p,u.style.textDecoration="inherit")),t[n]=this.applyStyles(t,n,c),"fontsize"===h){var g=(0,o.kp)(t[n].parentElement,"span[style*=background-color]");(0,o.hX)(g)||(t[n].parentElement.style.backgroundColor=g.style.backgroundColor)}}else t[n]=this.applyStyles(t,n,c)}}else t[n]=d.GetSpliceNode(l,t[n]);return t[n]},e.applyStyles=function(e,t,n){return"BR"===e[t].nodeName&&"BR"===this.enterAction||(e[t]=t===e.length-1||"BR"===e[t].nodeName?X.Wrap(e[t],n):X.WrapBefore(e[t],n,!0),e[t]=this.getChildNode(e[t],n)),e[t]},e.getInsertNode=function(e,t,n,i){var r=this.GetFormatNode(n,i);if(r.innerHTML="&#8203;",o.Pw.isIE){var a=e.createDocumentFragment();a.appendChild(r),t.insertNode(a)}else t.insertNode(r);return r},e.getChildNode=function(e,t){return void 0!==e&&null!==e||(t.innerHTML="&#8203;",e=t.firstChild),e},e.applySelection=function(e,t,n,i,o){return 1!==e.length||o?1===e.length&&o?(t.startContainer=t.getNodeArray(e[i],!0),t.endContainer=t.startContainer,t.startOffset=n.position,t.endOffset=n.position):0===i?(t.startContainer=t.getNodeArray(e[i],!0),t.startOffset=0):i===e.length-1&&(t.endContainer=t.getNodeArray(e[i],!1),t.endOffset=e[i].textContent.length):(t.startContainer=t.getNodeArray(e[i],!0),t.endContainer=t.startContainer,t.startOffset=0,t.endOffset=e[i].textContent.length),t},e.GetFormatNode=function(e,t,n,i){var o;switch(e){case"bold":return document.createElement("strong");case"italic":return document.createElement("em");case"underline":return o=document.createElement("span"),this.updateStyles(o,n,i),o.style.textDecoration="underline",o;case"strikethrough":return o=document.createElement("span"),this.updateStyles(o,n,i),o.style.textDecoration="line-through",o;case"superscript":return document.createElement("sup");case"subscript":return document.createElement("sub");case"fontcolor":return o=document.createElement("span"),this.updateStyles(o,n,i),o.style.color=t,o.style.textDecoration="inherit",o;case"fontname":return o=document.createElement("span"),this.updateStyles(o,n,i),o.style.fontFamily=t,o;case"fontsize":return o=document.createElement("span"),this.updateStyles(o,n,i),o.style.fontSize=t,o;default:return o=document.createElement("span"),this.updateStyles(o,n,i),o.style.backgroundColor=t,o}},e.updateStyles=function(e,t,n){null!==n&&"SPAN"===t&&e.setAttribute("style",n)},e.enterAction="P",e}(),ie=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(L,this.applySelection,this),this.parent.observer.on(a.ck,this.keyDownHandler,this)},e.prototype.keyDownHandler=function(e){e.event.ctrlKey&&["bold","italic","underline","strikethrough","superscript","subscript","uppercase","lowercase"].indexOf(e.event.action)>-1&&(e.event.preventDefault(),ne.applyFormat(this.parent.currentDocument,e.event.action,this.parent.editableElement,e.enterAction),this.callBack(e,e.event.action))},e.prototype.applySelection=function(e){ne.applyFormat(this.parent.currentDocument,e.subCommand.toLocaleLowerCase(),this.parent.editableElement,e.enterAction,e.value,e.selector),this.callBack(e,e.subCommand)},e.prototype.callBack=function(e,t){e.callBack&&e.callBack({requestType:t,event:e.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e}(),oe=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(D,this.applyHtml,this)},e.prototype.applyHtml=function(e){if(j.Insert(this.parent.currentDocument,e.value,this.parent.editableElement,!0),"pasteCleanup"===e.subCommand){var t=this.parent.editableElement.querySelectorAll(".pasteContent_RTE"),n=[].slice.call(t),i=this.parent.editableElement.querySelectorAll(".pasteContent_Img"),o=[].slice.call(i);e.callBack({requestType:e.subCommand,editorMode:"HTML",elements:n,imgElem:o})}else e.callBack&&e.callBack({requestType:e.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e}(),re=function(){function e(){}return e.clear=function(e,t,n,i){this.domNode=new F(t,e),this.defaultTag="P"===n?this.defaultTag:"div";var r=new A,a=new q,s=r.getRange(e),l=s.collapsed,d=r.getInsertNodeCollection(s),h=r.save(s,e);if(!l){var p=void 0;if(p="BR"===d[0].nodeName&&(0,o.kp)(d[0],"table")?a.GetSpliceNode(s,(0,o.kp)(d[0],"table")):a.GetSpliceNode(s,d[d.length>1&&"IMG"===d[0].nodeName?1:0]),1===d.length)r.setSelectionContents(e,p),s=r.getRange(e);else{for(var c=1,u=d[d.length-c];d.length<=c&&"BR"===d[d.length-c].nodeName;)c++,u=d[d.length-c];var m=a.GetSpliceNode(s,u);r.setSelectionText(e,p,m,0,3===m.nodeType?m.textContent.length:m.childNodes.length),s=r.getRange(e)}var g=r.getNodeCollection(s),f=g.slice();this.clearInlines(r.getSelectionNodes(f),f,r.getRange(e),a,t),this.reSelection(e,h,g),s=r.getRange(e);var b=(g=r.getNodeCollection(s)).slice();this.clearBlocks(e,b,t,a,r),(0,I.wU)()&&(0,I.WM)(t,i),this.reSelection(e,h,g)}},e.reSelection=function(e,t,n){var i=t.getInsertNodes(n);t.startContainer=t.getNodeArray(i[0],!0,e),t.startOffset=0,t.endContainer=t.getNodeArray(i[i.length-1],!1,e);var o=i[i.length-1];t.endOffset=3===o.nodeType?o.textContent.length:o.childNodes.length,t.restore()},e.clearBlocks=function(e,t,n,i,o){for(var r=[],a=0;a<t.length;a++)this.BLOCK_TAGS.indexOf(t[a].nodeName.toLocaleLowerCase())>-1&&-1===r.indexOf(t[a])?r.push(t[a]):this.BLOCK_TAGS.indexOf(t[a].parentNode.nodeName.toLocaleLowerCase())>-1&&-1===r.indexOf(t[a].parentNode)&&n!==t[a].parentNode&&r.push(t[a].parentNode);r=this.spliceParent(r,t)[0],r=this.removeParent(r),this.unWrap(e,r,i,o)},e.spliceParent=function(e,t){for(var n=0;n<e.length;n++)for(var i=e[n].childNodes.length,o=0;o<i;o++)if(t.indexOf(e[n].childNodes[o])>0&&e[n].childNodes[o].childNodes.length>0&&(t=this.spliceParent([e[n].childNodes[o]],t)[1]),t.indexOf(e[n].childNodes[o])<=-1&&""!==e[n].childNodes[o].textContent.trim()){for(var r=0;r<i;r++)t.indexOf(e[n].childNodes[r])>-1&&t.splice(t.indexOf(e[n].childNodes[r]),1);o=e[n].childNodes.length;var a=e.indexOf(e[n].parentNode),s=t.indexOf(e[n].parentNode);a>-1&&e.splice(a,1),s>-1&&t.splice(s,1);var l=t.indexOf(e[n]);l>-1&&t.splice(l,1),e.splice(n,1),n--}return[e,t]},e.removeChild=function(e,t){var n=t.childNodes.length;if(n>0)for(var i=0;i<n;i++)e.indexOf(t.childNodes[i])>-1&&(e=this.removeChild(e,t.childNodes[i])).splice(e.indexOf(t.childNodes[i]),1);return e},e.removeParent=function(e){for(var t=0;t<e.length;t++)e.indexOf(e[t].parentNode)>-1&&((e=this.removeChild(e,e[t])).splice(t,1),t--);return e},e.unWrap=function(e,t,n,i){for(var o=0;o<t.length;o++)if(this.NONVALID_TAGS.indexOf(t[o].nodeName.toLowerCase())>-1&&t[o].parentNode&&this.NONVALID_PARENT_TAGS.indexOf(t[o].parentNode.nodeName.toLowerCase())>-1&&(i.setSelectionText(e,t[o],t[o],0,t[o].childNodes.length),X.unwrap(n.GetSpliceNode(i.getRange(e),t[o].parentNode))),"p"!==t[o].nodeName.toLocaleLowerCase()){!(this.NONVALID_PARENT_TAGS.indexOf(t[o].nodeName.toLowerCase())<0&&"p"!==t[o].parentNode.nodeName.toLocaleLowerCase())||("blockquote"===t[o].nodeName.toLocaleLowerCase()||"li"===t[o].nodeName.toLocaleLowerCase())&&this.IGNORE_PARENT_TAGS.indexOf(t[o].childNodes[0].nodeName.toLocaleLowerCase())>-1||1===t[o].childNodes.length&&"p"===t[o].childNodes[0].nodeName.toLocaleLowerCase()||X.Wrap(t[o],e.createElement(this.defaultTag));var r=X.unwrap(t[o]);1===r.length&&"p"===r[0].parentNode.nodeName.toLocaleLowerCase()&&(X.Wrap(t[o],e.createElement(this.defaultTag)),X.unwrap(t[o]));for(var a=0;a<r.length;a++)if(this.NONVALID_TAGS.indexOf(r[a].nodeName.toLowerCase())>-1)this.unWrap(e,[r[a]],n,i);else if(this.BLOCK_TAGS.indexOf(r[a].nodeName.toLocaleLowerCase())>-1&&"p"!==r[a].nodeName.toLocaleLowerCase()){var s=this.removeParent([r[a]]);this.unWrap(e,s,n,i)}else this.BLOCK_TAGS.indexOf(r[a].nodeName.toLocaleLowerCase())>-1&&r[a].parentNode.nodeName.toLocaleLowerCase()===r[a].nodeName.toLocaleLowerCase()?X.unwrap(r[a]):this.BLOCK_TAGS.indexOf(r[a].nodeName.toLocaleLowerCase())>-1&&"p"===r[a].nodeName.toLocaleLowerCase()&&(X.Wrap(r[a],e.createElement(this.defaultTag)),X.unwrap(r[a]))}else X.Wrap(t[o],e.createElement(this.defaultTag)),X.unwrap(t[o])},e.clearInlines=function(e,t,n,i,o){for(var r=0;r<e.length;r++){for(var a=e[r],s=void 0;!this.domNode.isBlockNode(a);)s=a,a=a.parentElement;s&&te.inlineTags.indexOf(s.nodeName.toLocaleLowerCase())>-1&&(i.GetSpliceNode(n,s),this.removeInlineParent(s))}},e.removeInlineParent=function(e){for(var t=X.unwrap(e),n=0;n<t.length;n++)1===t[n].parentNode.childNodes.length&&te.inlineTags.indexOf(t[n].parentNode.nodeName.toLocaleLowerCase())>-1?this.removeInlineParent(t[n].parentNode):te.inlineTags.indexOf(t[n].nodeName.toLocaleLowerCase())>-1&&this.removeInlineParent(t[n])},e.BLOCK_TAGS=["address","article","aside","blockquote","details","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","li","main","nav","noscript","ol","p","pre","section","ul"],e.NONVALID_PARENT_TAGS=["thead","tbody","ul","ol","table","tfoot","tr"],e.IGNORE_PARENT_TAGS=["ul","ol","table"],e.NONVALID_TAGS=["thead","tbody","figcaption","td","tr","th","tfoot","figcaption","li"],e.defaultTag="p",e}(),ae=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(M,this.applyClear,this),this.parent.observer.on(a.ck,this.onKeyDown,this)},e.prototype.onKeyDown=function(e){if("clear-format"===e.event.action)this.applyClear({subCommand:"ClearFormat",callBack:e.callBack,enterAction:e.enterAction}),e.event.preventDefault()},e.prototype.applyClear=function(e){"ClearFormat"===e.subCommand&&(re.clear(this.parent.currentDocument,this.parent.editableElement,e.enterAction,e.selector),e.callBack&&e.callBack({requestType:e.subCommand,event:e.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)}))},e}(),se=function(){function e(e,t){this.undoRedoStack=[],this.parent=e,this.undoRedoSteps=(0,o.hX)(t)?30:t.undoRedoSteps,this.undoRedoTimer=(0,o.hX)(t)?300:t.undoRedoTimer,this.addEventListener()}return e.prototype.addEventListener=function(){var e=(0,o.sg)(this.keyUp,this.undoRedoTimer);this.parent.observer.on(a.FL,e,this),this.parent.observer.on(a.ck,this.keyDown,this),this.parent.observer.on(a.hr,this.onAction,this),this.parent.observer.on(a.R8,this.onPropertyChanged,this)},e.prototype.onPropertyChanged=function(e){for(var t=0,n=Object.keys(e.newProp);t<n.length;t++){switch(n[t]){case"undoRedoSteps":this.undoRedoSteps=e.newProp.undoRedoSteps;break;case"undoRedoTimer":this.undoRedoTimer=e.newProp.undoRedoTimer}}},e.prototype.removeEventListener=function(){this.parent.observer.off(a.FL,this.keyUp),this.parent.observer.off(a.ck,this.keyDown),this.parent.observer.off(a.hr,this.onAction)},e.prototype.onAction=function(e){"Undo"===e.subCommand?this.undo(e):this.redo(e)},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.keyDown=function(e){var t=e.event;switch(t.action){case"undo":t.preventDefault(),this.undo(e);break;case"redo":t.preventDefault(),this.redo(e)}},e.prototype.keyUp=function(e){17===e.event.keyCode||e.event.ctrlKey||this.saveData(e)},e.prototype.saveData=function(e){for(var t=(new A).getRange(this.parent.currentDocument),n=t.startContainer,i=n.childNodes.length-1;i>=0;i--)!(0,o.hX)(n.childNodes[i])&&"#text"===n.childNodes[i].nodeName&&0===n.childNodes[i].textContent.length&&"IMG"!==n.childNodes[i].nodeName&&"BR"!==n.childNodes[i].nodeName&&n.childNodes[i].nodeName&&(0,o.Yo)(n.childNodes[i]);t=(new A).getRange(this.parent.currentDocument);var r=(new A).save(t,this.parent.currentDocument),a={text:this.parent.editableElement.innerHTML,range:r};this.undoRedoStack.length>=this.steps&&(this.undoRedoStack=this.undoRedoStack.slice(0,this.steps+1)),this.undoRedoStack.length>1&&this.undoRedoStack[this.undoRedoStack.length-1].range.range.collapsed===t.collapsed&&this.undoRedoStack[this.undoRedoStack.length-1].range.startOffset===r.range.startOffset&&this.undoRedoStack[this.undoRedoStack.length-1].range.endOffset===r.range.endOffset&&this.undoRedoStack[this.undoRedoStack.length-1].range.range.startContainer===r.range.startContainer&&this.undoRedoStack[this.undoRedoStack.length-1].text.trim()===a.text.trim()||(this.undoRedoStack.push(a),this.steps=this.undoRedoStack.length-1,this.steps>this.undoRedoSteps&&(this.undoRedoStack.shift(),this.steps--),e&&e.callBack&&e.callBack())},e.prototype.undo=function(e){if(this.steps>0){var t=this.undoRedoStack[this.steps-1].range,n=this.undoRedoStack[this.steps-1].text;this.parent.editableElement.innerHTML=n,this.parent.editableElement.focus(),(0,I.wU)()&&(0,I.WM)(this.parent.editableElement,e.selector),t.restore(),this.steps--,e.callBack&&e.callBack({requestType:"Undo",editorMode:"HTML",range:t,elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),event:e.event})}},e.prototype.redo=function(e){if(null!=this.undoRedoStack[this.steps+1]){var t=this.undoRedoStack[this.steps+1].range;this.parent.editableElement.innerHTML=this.undoRedoStack[this.steps+1].text,this.parent.editableElement.focus(),(0,I.wU)()&&(0,I.WM)(this.parent.editableElement,e.selector),t.restore(),this.steps++,e.callBack&&e.callBack({requestType:"Redo",editorMode:"HTML",range:t,elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),event:e.event})}},e.prototype.getUndoStatus=function(){var e={undo:!1,redo:!1};return this.steps>0&&(e.undo=!0),null!=this.undoRedoStack[this.steps+1]&&(e.redo=!0),e},e}(),le=function(){function e(e){this.olData=["decimal","lower-alpha","lower-roman","upper-alpha","upper-roman","lower-greek"],this.ulData=["disc","square","circle","disc","square","circle"],this.ignorableNodes=["A","APPLET","B","BLOCKQUOTE","BR","BUTTON","CENTER","CODE","COL","COLGROUP","DD","DEL","DFN","DIR","DIV","DL","DT","EM","FIELDSET","FONT","FORM","FRAME","FRAMESET","H1","H2","H3","H4","H5","H6","HR","I","IMG","IFRAME","INPUT","INS","LABEL","LI","OL","OPTION","P","PARAM","PRE","Q","S","SELECT","SPAN","STRIKE","STRONG","SUB","SUP","TABLE","TBODY","TD","TEXTAREA","TFOOT","TH","THEAD","TITLE","TR","TT","U","UL"],this.blockNode=["div","p","h1","h2","h3","h4","h5","h6","address","blockquote","button","center","dd","dir","dl","dt","fieldset","frameset","hr","iframe","isindex","li","map","menu","noframes","noscript","object","ol","pre","table","tbody","td","tfoot","th","thead","tr","ul","header","article","nav","footer","section","aside","main","figure","figcaption"],this.borderStyle=["border-top","border-right","border-bottom","border-left"],this.removableElements=["o:p","style"],this.listContents=[],this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(a.hU,this.wordCleanup,this)},e.prototype.wordCleanup=function(e){var t=(0,o.hX)(e.allowedStylePropertiesArray)?[]:e.allowedStylePropertiesArray,n=[],i=e.args.clipboardData.getData("text/HTML"),r=e.args.clipboardData.getData("text/rtf"),a=(0,o.n)("p");a.setAttribute("id","MSWord-Content"),a.innerHTML=i;var s=/style='mso-width-source:/i;/class='?Mso|style='[^ ]*\bmso-/i.test(i)||/class="?Mso|style="[^ ]*\bmso-/i.test(i)||/(class="?Mso|class='?Mso|class="?Xl|class='?Xl|class=Xl|style="[^"]*\bmso-|style='[^']*\bmso-|w:WordDocument)/gi.test(i)||s.test(i)?(this.imageConversion(a,r),i=i.replace(/<img[^>]+>/i,""),this.addListClass(a),n=this.cleanUp(a,n),(0,o.hX)(n[0])||"UL"===n[0].parentElement.tagName||"OL"===n[0].parentElement.tagName||this.listConverter(n),this.styleCorrection(a,t),this.removingComments(a),this.removeUnwantedElements(a),this.removeEmptyElements(a),this.breakLineAddition(a),this.removeClassName(a),s.test(i)&&this.addTableBorderClass(a),e.callBack(a.innerHTML)):e.callBack(a.innerHTML)},e.prototype.addListClass=function(e){for(var t=e.querySelectorAll("*"),n=0;n<t.length;n++)!(0,o.hX)(t[n].getAttribute("style"))&&t[n].getAttribute("style").replace(/ /g,"").replace("\n","").indexOf("mso-list:l")>=0&&-1===t[n].className.toLowerCase().indexOf("msolistparagraph")&&"H"!==t[n].tagName.charAt(0)&&t[n].classList.add("msolistparagraph")},e.prototype.addTableBorderClass=function(e){for(var t=e.querySelectorAll("table"),n=!1,i=0;i<t.length;i++){for(var o=0;o<this.borderStyle.length;o++)if(t[i].innerHTML.indexOf(this.borderStyle[o])>=0){n=!0;break}n&&(t[i].classList.add("e-rte-table-border"),n=!1)}},e.prototype.imageConversion=function(e,t){this.checkVShape(e);var n=e.querySelectorAll("img"),i=[],o=[],r=[],a=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi);if(n.length>0){for(var s=0;s<n.length;s++)i.push(n[s].getAttribute("src")),r.push(n[s].getAttribute("src").split("/")[n[s].getAttribute("src").split("/").length-1].split(".")[0]);var l=this.hexConversion(t);for(s=0;s<l.length;s++)o.push(this.convertToBase64(l[s]));for(s=0;s<n.length;s++)i[s].match(a)?n[s].setAttribute("src",i[s]):n[s].setAttribute("src",o[s]),n[s].setAttribute("id","msWordImg-"+r[s])}},e.prototype.checkVShape=function(e){for(var t=e.querySelectorAll("*"),n=0;n<t.length;n++)switch(t[n].nodeName){case"V:SHAPETYPE":(0,o.Yo)(t[n]);break;case"V:SHAPE":if("V:IMAGEDATA"===t[n].firstElementChild.nodeName){var i=t[n].firstElementChild.getAttribute("src"),r=(0,o.n)("img");r.setAttribute("src",i),t[n].parentElement.insertBefore(r,t[n]),(0,o.Yo)(t[n])}}},e.prototype.convertToBase64=function(e){var t=this.conHexStringToBytes(e.hex),n=this.conBytesToBase64(t);return e.type?"data:"+e.type+";base64,"+n:null},e.prototype.conBytesToBase64=function(e){for(var t="",n=e.length,i=0;i<n;i+=3){var o=e.slice(i,i+3),r=o.length,a=[];if(r<3)for(var s=r;s<3;s++)o[s]=0;a[0]=(252&o[0])>>2,a[1]=(3&o[0])<<4|o[1]>>4,a[2]=(15&o[1])<<2|(192&o[2])>>6,a[3]=63&o[2];for(s=0;s<4;s++)t+=s<=r?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a[s]):"="}return t},e.prototype.conHexStringToBytes=function(e){for(var t=[],n=e.length/2,i=0;i<n;i++)t.push(parseInt(e.substr(2*i,2),16));return t},e.prototype.hexConversion=function(e){var t,n=/\{\\pict[\s\S]+?\\bliptag\-?\d+(\\blipupi\-?\d+)?(\{\\\*\\blipuid\s?[\da-fA-F]+)?[\s\}]*?/,i=new RegExp("(?:("+n.source+"))([\\da-fA-F\\s]+)\\}","g"),r=e.match(i),a=[];if(!(0,o.hX)(r))for(var s=0;s<r.length;s++)if(n.test(r[s])){if(-1!==r[s].indexOf("\\pngblip"))t="image/png";else{if(-1===r[s].indexOf("\\jpegblip"))continue;t="image/jpeg"}a.push({hex:t?r[s].replace(n,"").replace(/[^\da-fA-F]/g,""):null,type:t})}return a},e.prototype.removeClassName=function(e){for(var t=e.querySelectorAll("*[class]"),n=0;n<t.length;n++)t[n].removeAttribute("class")},e.prototype.breakLineAddition=function(e){for(var t=e.querySelectorAll("*"),n=0;n<t.length;n++)if(0===t[n].children.length&&"&nbsp;"===t[n].innerHTML&&"&nbsp;"===t[n].innerHTML&&!t[n].closest("li")&&!t[n].closest("td")){var i=this.findDetachElem(t[n]),r=(0,o.n)("br");(0,o.hX)(i.parentElement)||(i.parentElement.insertBefore(r,i),(0,o.Yo)(i))}},e.prototype.findDetachElem=function(e){return!(0,o.hX)(e.parentElement)&&""===e.parentElement.textContent.trim()&&"TD"!==e.parentElement.tagName&&(0,o.hX)(e.parentElement.querySelector("img"))?this.findDetachElem(e.parentElement):e},e.prototype.removeUnwantedElements=function(e){for(var t=e.innerHTML,n=0;n<this.removableElements.length;n++){var i=new RegExp("<"+this.removableElements[n]+">","g"),o=new RegExp("</"+this.removableElements[n]+">","g");t=(t=t.replace(i,"")).replace(o,"")}e.innerHTML=t,e.querySelectorAll(":empty")},e.prototype.findDetachEmptyElem=function(e){return(0,o.hX)(e.parentElement)?null:""===e.parentElement.textContent.trim()&&"MSWord-Content"!==e.parentElement.getAttribute("id")&&(0,o.hX)(e.parentElement.querySelector("img"))?this.findDetachEmptyElem(e.parentElement):e},e.prototype.removeEmptyElements=function(e){for(var t=e.querySelectorAll(":empty"),n=0;n<t.length;n++)if((0,o.hX)(t[n].closest("td"))||(0,o.hX)(t[n].closest("td").querySelector(".MsoNormal"))||(t[n].innerHTML="-"),"IMG"!==t[n].tagName&&"BR"!==t[n].tagName&&"IFRAME"!==t[n].tagName&&"TD"!==t[n].tagName&&"HR"!==t[n].tagName){var i=this.findDetachEmptyElem(t[n]);(0,o.hX)(i)||(0,o.Yo)(i)}},e.prototype.styleCorrection=function(e,t){var n=e.querySelectorAll("style");if(n.length>0){var i=n[0].innerHTML.match(/[\S ]+\s+{[\s\S]+?}/gi),r=(0,o.hX)(i)?null:this.findStyleObject(i),a=Object.keys(r),s=a.map((function(e){return r[e]}));s=this.removeUnwantedStyle(s,t),this.filterStyles(e,t);for(var l=void 0,d=!1,h=0;h<a.length;h++){if(""===a[h].split(".")[0])l=e.getElementsByClassName(a[h].split(".")[1]),d=!0;else{if(1===a[h].split(".").length&&a[h].split(".")[0].indexOf("@")>=0)continue;l=1===a[h].split(".").length&&a[h].split(".")[0].indexOf("@")<0?e.getElementsByTagName(a[h]):e.querySelectorAll(a[h])}for(var p=0;p<l.length;p++){var c=l[p].getAttribute("style");if((0,o.hX)(c)||""===c.trim())s[h]=s[h].replace(/text-indent:-(.*?)(?=;|$)/gm,""),l[p].setAttribute("style",s[h]);else{var u=s[h].split(";");if(!d)for(var m=0;m<u.length;m++)c.indexOf(u[m].split(":")[0])>=0&&(u.splice(m,1),m--);s[h]=u.join(";")+";";var g=c+s[h];l[p].setAttribute("style",g)}}d=!1}}},e.prototype.filterStyles=function(e,t){for(var n=e.querySelectorAll("*[style]"),i=0;i<n.length;i++){for(var o=n[i].getAttribute("style").split(";"),r="",a=0;a<o.length;a++)t.indexOf(o[a].split(":")[0].trim())>=0&&(r+=o[a]+";");n[i].setAttribute("style",r)}},e.prototype.removeUnwantedStyle=function(e,t){for(var n=0;n<e.length;n++){var i=e[n].split(";");e[n]="";for(var o=0;o<i.length;o++)t.indexOf(i[o].split(":")[0])>=0&&(e[n]+=i[o]+";")}return e},e.prototype.findStyleObject=function(e){for(var t={},n=0;n<e.length;n++){var i=e[n],o=i.replace(/([\S ]+\s+){[\s\S]+?}/gi,"$1"),r=i.replace(/[\S ]+\s+{([\s\S]+?)}/gi,"$1");o=o.replace(/^[\s]|[\s]$/gm,""),r=r.replace(/^[\s]|[\s]$/gm,""),o=o.replace(/\n|\r|\n\r/g,""),r=r.replace(/\n|\r|\n\r/g,"");for(var a=o.split(", "),s=0;s<a.length;s++)t[a[s]]=r}return t},e.prototype.removingComments=function(e){var t=e.innerHTML;t=t.replace(/<!--[\s\S]*?-->/g,""),e.innerHTML=t},e.prototype.cleanUp=function(e,t){for(var n,i=[],r=e.querySelectorAll("*"),a=0;a<r.length;a++)-1===this.ignorableNodes.indexOf(r[a].nodeName)||3===r[a].nodeType&&""===r[a].textContent.trim()?i.push(r[a]):(r[a].className&&-1!==r[a].className.toLowerCase().indexOf("msolistparagraph")&&1!==r[a].childElementCount&&!(0,o.hX)(r[a].getAttribute("style"))&&r[a].getAttribute("style").indexOf("mso-list:")>=0&&(r[a].className.indexOf("MsoListParagraphCxSpFirst")>=0&&t.length>0&&null!==t[t.length-1]&&t.push(null),t.push(r[a])),!n||-1===this.blockNode.indexOf(r[a].nodeName.toLowerCase())||r[a].className&&-1!==r[a].className.toLowerCase().indexOf("msolistparagraph")&&!(0,o.hX)(r[a].getAttribute("style"))&&r[a].getAttribute("style").indexOf("mso-list:")>=0||t.push(null),-1!==this.blockNode.indexOf(r[a].nodeName.toLowerCase())&&(n=!!(r[a].className&&-1!==r[a].className.toLowerCase().indexOf("msolistparagraph")&&!(0,o.hX)(r[a].getAttribute("style"))&&r[a].getAttribute("style").indexOf("mso-list:")>=0)));return t.length&&null!==t[t.length-1]&&t.push(null),t},e.prototype.listConverter=function(e){for(var t,n,i=[],r=[],a="",s="",l=0;l<e.length;l++)if(null!==e[l]){e[l].getAttribute("style")&&-1!==e[l].getAttribute("style").indexOf("mso-outline-level")&&e[l].setAttribute("style",e[l].getAttribute("style").replace("mso-outline-level","mso-outline")),t=(a=e[l].getAttribute("style"))&&-1!==a.indexOf("level")?parseInt(a.charAt(a.indexOf("level")+5),null):1,this.listContents=[],this.getListContent(e[l]);var d=void 0,h=void 0;if(!(0,o.hX)(this.listContents[0])){d=this.listContents[0].trim().length>1?"ol":"ul",h=this.getlistStyleType(this.listContents[0],d);for(var p=[],c=1;c<this.listContents.length;c++)p.push(this.listContents[c]);var u=void 0;(0,o.hX)(e[l].className)||(u=e[l].className),(0,o.hX)(e[l].getAttribute("style"))||(e[l].setAttribute("style",e[l].getAttribute("style").replace("text-align:start;","")),""!==e[l].style.textAlign&&(e[l].setAttribute("style","text-align:"+e[l].style.textAlign),s=e[l].getAttribute("style"))),r.push({listType:d,content:p,nestedLevel:t,class:u,listStyle:s,listStyleTypeName:h})}}else i.push({content:this.makeConversion(r),node:e[l-1]}),r=[];for(n=e.shift();n;){for(var m=[],g=0;g<i.length;g++)if(i[g].node===n){for(var f=0;f<i[g].content.childNodes.length;f++)m.push(i[g].content.childNodes[f]);for(f=0;f<m.length;f++)n.parentElement.insertBefore(m[f],n);break}n.remove(),(n=e.shift())||(n=e.shift())}},e.prototype.getlistStyleType=function(e,t){var n;if("ol"===t)switch(e.split(".")[0]){case"A":n="upper-alpha";break;case"a":n="lower-alpha";break;case"I":n="upper-roman";break;case"i":n="lower-roman";break;case"\u03b1":n="lower-greek";break;default:n="decimal"}else switch(e.split(".")[0]){case"o":n="circle";break;case"\xa7":n="square";break;default:n="disc"}return n},e.prototype.makeConversion=function(e){for(var t,n,i,r=(0,o.n)("div"),a=1,s=0,l=0;l<e.length;l++){var d=(0,o.n)("p");if(d.innerHTML=e[l].content.join(" "),1===e[l].nestedLevel&&0===s&&e[l].content)r.appendChild(t=(0,o.n)(e[l].listType)),(n=(0,o.n)("li")).appendChild(d),t.appendChild(n),t.setAttribute("level",e[l].nestedLevel.toString()),t.style.listStyleType=e[l].listStyleTypeName;else if(e[l].nestedLevel===a)n.parentElement.tagName.toLowerCase()===e[l].listType?(n.parentElement.appendChild(n=(0,o.n)("li")),n.appendChild(d)):((t=(0,o.n)(e[l].listType)).style.listStyleType=e[l].listStyleTypeName,n.parentElement.parentElement.appendChild(t),(n=(0,o.n)("li")).appendChild(d),t.appendChild(n),t.setAttribute("level",e[l].nestedLevel.toString()));else if(e[l].nestedLevel>a)if((0,o.hX)(n))r.appendChild(t=(0,o.n)(e[l].listType)),(n=(0,o.n)("li")).appendChild(d),t.appendChild(n),t.setAttribute("level",e[l].nestedLevel.toString()),t.style.listStyleType=e[l].listStyleTypeName;else{for(var h=0;h<e[l].nestedLevel-a;h++)n.appendChild(t=(0,o.n)(e[l].listType)),n=(0,o.n)("li"),h!=e[l].nestedLevel-a-1&&e[l].nestedLevel-a>1&&(n.style.listStyleType="none"),t.appendChild(n);n.appendChild(d),t.setAttribute("level",e[l].nestedLevel.toString()),t.style.listStyleType=e[l].listStyleTypeName}else if(1===e[l].nestedLevel)r.lastChild.tagName.toLowerCase()===e[l].listType?t=r.lastChild:(r.appendChild(t=(0,o.n)(e[l].listType)),t.style.listStyleType=e[l].listStyleTypeName),(n=(0,o.n)("li")).appendChild(d),t.appendChild(n),t.setAttribute("level",e[l].nestedLevel.toString());else for(i=n;i.parentElement;)if((i=i.parentElement).attributes.getNamedItem("level")){if(parseInt(i.attributes.getNamedItem("level").textContent,null)===e[l].nestedLevel){(n=(0,o.n)("li")).appendChild(d),i.appendChild(n);break}if(e[l].nestedLevel>parseInt(i.attributes.getNamedItem("level").textContent,null)){i.appendChild(t=(0,o.n)(e[l].listType)),(n=(0,o.n)("li")).appendChild(d),t.appendChild(n),t.setAttribute("level",e[l].nestedLevel.toString()),t.style.listStyleType=e[l].listStyleTypeName;break}}n.setAttribute("class",e[l].class);var p=n.getAttribute("style");n.setAttribute("style",(0,o.hX)(p)?"":p),a=e[l].nestedLevel,s++}return r},e.prototype.getListContent=function(e){var t="",n=e.firstElementChild;if(""!==n.textContent.trim()||(0,o.hX)(n.firstElementChild)||"IMG"!==n.firstElementChild.nodeName){var i=["b","em"];if(n.childNodes.length>0&&(n.querySelectorAll("b").length>0||n.querySelectorAll("em").length>0))for(var r=0;r<n.childNodes.length;r++){var a=n.childNodes[r].nodeName.toLowerCase();n.childNodes[r].textContent.trim().length>1&&-1!==i.indexOf(a)?(t="<"+a+">"+n.childNodes[r].textContent+"</"+a+">",this.listContents.push(t)):1===n.childNodes[r].textContent.trim().length&&this.listContents.push(n.childNodes[r].textContent.trim())}else t=n.textContent.trim(),this.listContents.push(t)}else t=e.innerHTML.trim(),this.listContents.push(""),this.listContents.push(t);(0,o.Yo)(n),this.listContents.push(e.innerHTML)},e}(),de=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(x,this.insertText,this)},e.prototype.insertText=function(e){var t=document.createTextNode(e.value);j.Insert(this.parent.currentDocument,t),e.callBack&&e.callBack({requestType:e.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e}(),he=function(){function e(e){this.currentDocument=e.document,this.editableElement=e.editableElement,this.nodeSelection=new A,this.nodeCutter=new q,this.domNode=new F(this.editableElement,this.currentDocument),this.observer=new o.nu(this),this.listObj=new H(this),this.formatObj=new z(this),this.alignmentObj=new Q(this),this.indentsObj=new W(this),this.linkObj=new U(this),this.imgObj=new $(this),this.selectionObj=new ie(this),this.inserthtmlObj=new oe(this),this.insertTextObj=new de(this),this.clearObj=new ae(this),this.tableObj=new Z(this),this.undoRedoManager=new se(this,e.options),this.msWordPaste=new le(this),this.wireEvents()}return e.prototype.wireEvents=function(){this.observer.on(a.R,this.editorKeyDown,this),this.observer.on(a.gf,this.editorKeyUp,this),this.observer.on(a.gf,this.editorKeyUp,this),this.observer.on(a.Hj,this.onPropertyChanged,this),this.observer.on(a.fh,this.onWordPaste,this),this.observer.on(a.Oh,this.onBegin,this)},e.prototype.onWordPaste=function(e){this.observer.notify(a.hU,e)},e.prototype.onPropertyChanged=function(e){this.observer.notify(a.R8,e)},e.prototype.editorKeyDown=function(e){this.observer.notify(a.ck,e)},e.prototype.editorKeyUp=function(e){this.observer.notify(a.FL,e)},e.prototype.onBegin=function(e){this.observer.notify(a.Q7,e)},e.prototype.execCommand=function(e,t,n,i,o,r,s,w){switch(e.toLowerCase()){case"lists":this.observer.notify(a.qv,{subCommand:t,event:n,callBack:i,selector:s,item:r,enterAction:w});break;case"formats":this.observer.notify(a.VD,{subCommand:t,event:n,callBack:i,selector:s,exeValue:r,enterAction:w});break;case"alignments":this.observer.notify(S,{subCommand:t,event:n,callBack:i,selector:s,value:r});break;case"indents":this.observer.notify(E,{subCommand:t,event:n,callBack:i,selector:s});break;case"links":this.observer.notify(h,{command:e,value:t,item:r,event:n,callBack:i});break;case"files":this.observer.notify(l,{command:e,value:"Image",item:r,event:n,callBack:i,selector:s});break;case"images":this.observer.notify(l,{command:e,value:t,item:r,event:n,callBack:i,selector:s});break;case"table":switch(t.toString().toLocaleLowerCase()){case"createtable":this.observer.notify(d,{item:r,event:n,callBack:i,enterAction:w});break;case"insertrowbefore":case"insertrowafter":this.observer.notify(p,{item:r,event:n,callBack:i});break;case"insertcolumnleft":case"insertcolumnright":this.observer.notify(c,{item:r,event:n,callBack:i});break;case"deleterow":this.observer.notify(u,{item:r,event:n,callBack:i});break;case"deletecolumn":this.observer.notify(m,{item:r,event:n,callBack:i});break;case"tableremove":this.observer.notify(g,{item:r,event:n,callBack:i});break;case"tableheader":this.observer.notify(f,{item:r,event:n,callBack:i});break;case"aligntop":case"alignmiddle":case"alignbottom":this.observer.notify(b,{item:r,event:n,callBack:i});break;case"merge":this.observer.notify(v,{item:r,event:n,callBack:i});break;case"horizontalsplit":this.observer.notify(C,{item:r,event:n,callBack:i});break;case"verticalsplit":this.observer.notify(y,{item:r,event:n,callBack:i})}break;case"font":case"style":case"effects":case"casing":this.observer.notify(L,{subCommand:t,event:n,callBack:i,value:o,selector:s,enterAction:w});break;case"inserthtml":this.observer.notify(D,{subCommand:t,callBack:i,value:o});break;case"inserttext":this.observer.notify(x,{subCommand:t,callBack:i,value:o});break;case"clear":this.observer.notify(M,{subCommand:t,event:n,callBack:i,selector:s,enterAction:w});break;case"actions":this.observer.notify(a.hr,{subCommand:t,event:n,callBack:i,selector:s})}},e}(),pe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ce=function(e){function t(t){var n=e.call(this)||this;return n.initialize(),(0,o.X$)(n,n,t,!0),n.currentDocument&&n.element&&n.updateFormatter(n.element,n.currentDocument,t.options),n}return pe(t,e),t.prototype.initialize=function(){this.keyConfig=O},t.prototype.updateFormatter=function(e,t,n){e&&t&&(this.editorManager=new he({document:t,editableElement:e,options:n}))},t}(s),ue=n(1411),me=n(5624),ge=(0,I.l2)(),fe=function(){function e(){}return e.get=function(e,t,n,i,o,r){for(var a=JSON.parse(JSON.stringify(ge)),s=JSON.parse(JSON.stringify(ge)),l=new A,d=r?[r]:l.getNodeCollection(l.getRange(e)),h=d.length,p=!1,c=l.getRange(e),u=0;u<d.length;u++){for(;3===d[u].nodeType&&3===c.startContainer.nodeType&&d[u].parentNode&&d[u].parentNode.lastElementChild&&"BR"!==d[u].parentNode.lastElementChild.nodeName&&0===this.getImmediateBlockNode(d[u].parentNode).textContent.replace(/\u200B/g,"").length&&0===c.startContainer.textContent.replace(/\u200B/g,"").length&&0===l.get(e).toString().replace(/\u200B/g,"").length;)d[u]=d[u].parentNode.lastElementChild.firstChild,p=!0;p&&d[u]&&(l.setCursorPoint(e,d[u],d[u].textContent.length),p=!1),("BR"!==d[u].nodeName&&3!==d[u].nodeType||h>1&&3===d[u].nodeType&&""===d[u].textContent.trim())&&(d.splice(u,1),u--)}for(u=0;u<d.length;u++)a=this.getFormatParent(e,a,d[u],t,n,i,o),(0===u&&a.bold||!a.bold)&&(s.bold=a.bold),(0===u&&a.insertcode||!a.insertcode)&&(s.insertcode=a.insertcode),(0===u&&a.italic||!a.italic)&&(s.italic=a.italic),(0===u&&a.underline||!a.underline)&&(s.underline=a.underline),(0===u&&a.strikethrough||!a.strikethrough)&&(s.strikethrough=a.strikethrough),(0===u&&a.superscript||!a.superscript)&&(s.superscript=a.superscript),(0===u&&a.subscript||!a.subscript)&&(s.subscript=a.subscript),(0===u&&a.fontcolor||!a.fontcolor)&&(s.fontcolor=a.fontcolor),(0===u&&a.fontname||!a.fontname)&&(s.fontname=a.fontname),(0===u&&a.fontsize||!a.fontsize)&&(s.fontsize=a.fontsize),(0===u&&a.backgroundcolor||!a.backgroundcolor)&&(s.backgroundcolor=a.backgroundcolor),(0===u&&a.orderedlist||!a.orderedlist)&&(s.orderedlist=a.orderedlist),(0===u&&a.unorderedlist||!a.unorderedlist)&&(s.unorderedlist=a.unorderedlist),(0===u&&a.alignments||!a.alignments)&&(s.alignments=a.alignments),(0===u&&a.formats||!a.formats)&&(s.formats=a.formats),(0===u&&a.createlink||!a.createlink)&&(s.createlink=a.createlink),(0===u&&a.numberFormatList||!a.numberFormatList)&&(s.numberFormatList=a.numberFormatList),(0===u&&a.bulletFormatList||!a.bulletFormatList)&&(s.bulletFormatList=a.bulletFormatList),a=JSON.parse(JSON.stringify(ge));return s},e.getImmediateBlockNode=function(e){do{e=e.parentNode}while(e&&T.indexOf(e.nodeName.toLocaleLowerCase())<0);return e},e.getFormatParent=function(e,t,n,i,o,r,a){if(i.contains(n)||3===n.nodeType&&3!==i.nodeType&&i.contains(n.parentNode))do{t=this.isFormattedNode(e,t,n,o,r,a),n=n.parentNode}while(n&&n!==i);return t},e.isFormattedNode=function(e,t,n,i,o,r){return t.bold||(t.bold=te.isBold(n)),t.italic||(t.italic=te.isItalic(n)),t.underline||(t.underline=te.isUnderline(n)),t.strikethrough||(t.strikethrough=te.isStrikethrough(n)),t.superscript||(t.superscript=te.isSuperscript(n)),t.subscript||(t.subscript=te.isSubscript(n)),t.fontcolor||(t.fontcolor=this.isFontColor(e,n)),t.fontname||(t.fontname=this.isFontName(e,n,r)),t.fontsize||(t.fontsize=this.isFontSize(n,o)),t.backgroundcolor||(t.backgroundcolor=this.isBackgroundColor(n)),t.orderedlist||(t.orderedlist=this.isOrderedList(n)),t.unorderedlist||(t.unorderedlist=this.isUnorderedList(n)),t.alignments||(t.alignments=this.isAlignment(n)),t.formats||(t.formats=this.isFormats(n,i),"pre"===t.formats&&(t.insertcode=!0)),t.createlink||(t.createlink=this.isLink(n)),t.numberFormatList||(t.numberFormatList=this.isNumberFormatList(n)),t.bulletFormatList||(t.bulletFormatList=this.isBulletFormatList(n)),t},e.isFontColor=function(e,t){var n=t.style&&t.style.color;return null!==n&&void 0!==n&&""!==n||3===t.nodeType||(n=this.getComputedStyle(e,t,"color")),null!==n&&""!==n&&void 0!==n?n:null},e.isLink=function(e){return"a"===e.nodeName.toLocaleLowerCase()},e.isBackgroundColor=function(e){var t=e.style&&e.style.backgroundColor;return null!==t&&""!==t&&void 0!==t?t:null},e.isFontSize=function(e,t){var n=e.style&&e.style.fontSize;return null!==n&&""!==n&&void 0!==n&&(null===t||void 0===t||t.indexOf(n)>-1)?n:null},e.isFontName=function(e,t,n){var i=t.style&&t.style.fontFamily;null!==i&&void 0!==i&&""!==i||3===t.nodeType||(i=this.getComputedStyle(e,t,"font-family"));var o=null;return null!==i&&""!==i&&void 0!==i&&(null===n||void 0===n||n.filter((function(e,t){var n=new RegExp(i,"i");(e.replace(/"/g,"").replace(/ /g,"")===i.replace(/"/g,"").replace(/ /g,"")||e.search(n)>-1)&&(o=t)}))&&null!==o)?null!==o?n[o]:i.replace(/"/g,""):null},e.isOrderedList=function(e){return"ol"===e.nodeName.toLocaleLowerCase()},e.isUnorderedList=function(e){return"ul"===e.nodeName.toLocaleLowerCase()},e.isAlignment=function(e){var t=e.style&&e.style.textAlign;return"left"===t?"justifyleft":"center"===t?"justifycenter":"right"===t?"justifyright":"justify"===t?"justifyfull":null},e.isFormats=function(e,t){return(void 0===t||null===t)&&T.indexOf(e.nodeName.toLocaleLowerCase())>-1||null!==t&&void 0!==t&&t.indexOf(e.nodeName.toLocaleLowerCase())>-1?e.nodeName.toLocaleLowerCase():null},e.getComputedStyle=function(e,t,n){return e.defaultView.getComputedStyle(t,null).getPropertyValue(n)},e.isNumberFormatList=function(e){var t=e.style&&e.style.listStyleType;return"lower-alpha"===t?"Lower Alpha":"number"===t?"Number":"upper-alpha"===t?"Upper Alpha":"lower-roman"===t?"Lower Roman":"upper-roman"===t?"Upper Roman":"lower-greek"===t?"Lower Greek":"none"===t?"None":null},e.isBulletFormatList=function(e){var t=e.style&&e.style.listStyleType;return"circle"===t?"Circle":"square"===t?"Square":"none"===t?"None":"disc"===t?"Disc":null},e}(),be=function(){function e(e){this.parent=e,this.toolbarStatus=this.prevToolbarStatus=(0,I.l2)(),this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on(i.Vx,this.onRefreshHandler,this),this.parent.on(i.zr,this.removeEventListener,this)},e.prototype.removeEventListener=function(){this.parent.off(i.Vx,this.onRefreshHandler),this.parent.off(i.zr,this.removeEventListener)},e.prototype.onRefreshHandler=function(e){if(!this.parent.readonly){var t=[],n=[],o=[];this.parent.fontSize.items.forEach((function(e){t.push(e.value)})),this.parent.fontFamily.items.forEach((function(e){n.push(e.value)})),this.parent.format.types.forEach((function(e){o.push(e.value.toLocaleLowerCase())})),this.toolbarStatus=fe.get(this.parent.contentModule.getDocument(),this.parent.contentModule.getEditPanel(),o,t,n,e.documentNode);var r=JSON.stringify(this.toolbarStatus);this.parent.notify(i.tt,this.toolbarStatus),JSON.stringify(this.prevToolbarStatus)!==r&&(this.parent.notify(i.e4,{html:JSON.parse(r),markdown:null}),this.prevToolbarStatus=JSON.parse(r))}},e}(),ve=function(){function e(e,t){this.parent=e,this.serviceLocator=t}return e.prototype.renderPanel=function(){var e=this.parent,t=this.parent.createElement("div",{className:"e-rte-content",id:this.parent.getID()+"rte-view"}),n=(0,r.kf)(e.value,e);this.editableElement=this.parent.createElement("div",{className:"e-content",id:this.parent.getID()+"_rte-edit-view",attrs:{contenteditable:"true"},innerHTML:n}),t.appendChild(this.editableElement),this.setPanel(t),e.element.appendChild(t)},e.prototype.getPanel=function(){return this.contentPanel},e.prototype.getEditPanel=function(){return this.editableElement},e.prototype.getText=function(){return this.getEditPanel().innerText},e.prototype.setPanel=function(e){this.contentPanel=e},e.prototype.getDocument=function(){return this.getEditPanel().ownerDocument},e}(),ye=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ye(t,e),t.prototype.renderPanel=function(){var e=this.parent,t="\n<!DOCTYPE html> \n    <html>\n         <head>\n            <meta charset='utf-8' /> \n            <style>\n                @charset \"UTF-8\";\n                body {\n                    font-family: \"Roboto\", sans-serif;\n                    font-size: 14px;\n                }\n                html, body{height: 100%;margin: 0;}\n                body.e-cursor{cursor:default}\n                span.e-selected-node\t{background-color: #939393;color: white;}\n                span.e-selected-node.e-highlight {background-color: #1d9dd8;}\n                body{color:#333;word-wrap:break-word;padding: 8px;box-sizing: border-box;}\n                .e-rte-image {border: 0;cursor: pointer;display:\n                    block;float: none;height: auto;margin: 5px auto;max-width: 100%;position: relative;}\n                .e-img-caption { display: inline-block; float: none; margin: 5px auto; max-width: 100%;position: relative;}\n                .e-img-caption.e-caption-inline {display: inline-block;float: none;\n                    margin: 5px auto;margin-left: 5px;margin-right: 5px;max-width: calc(100% - (2 * 5px));\n                    position: relativetext-align: center;vertical-align: bottom;}\n                .e-img-inner {box-sizing: border-box;display: block;font-size: 16px;font-weight: initial;\n                    margin: auto;opacity: .9;text-align: center;width: 100%;}\n                .e-img-wrap {display: inline-block;margin: auto;padding: 0;text-align: center;width: 100%;}\n                .e-imgleft {float: left;margin: 0 5px 0 0;text-align: left;}\n                .e-imgright {float: right;margin: 0 0 0 5px;text-align: right;}\n                .e-imgcenter {cursor: pointer;display: block;float: none;height: auto;margin: 5px auto;max-width: 100%;position: relative;}\n                .e-control img:not(.e-resize) {border: 2px solid transparent; z-index: 1000}\n                .e-imginline {display: inline-block;float: none;margin-left: 5px;margin-right: 5px;\n                    max-width: calc(100% - (2 * 5px));vertical-align: bottom;}\n                .e-imgbreak {border: 0;cursor: pointer;\n                    display: block;float: none;height: auto;margin: 5px auto;max-width: 100%;position: relative;}\n                .e-rte-image.e-img-focus:not(.e-resize) {border: solid 2px #4a90e2;}\n                img.e-img-focus::selection { background: transparent;color: transparent;}\n                span.e-rte-imageboxmark {  width: 10px; height: 10px; position: absolute; display: block;\n                    background: #4a90e2; border: 1px solid #fff; z-index: 1000;}\n                .e-mob-rte.e-mob-span span.e-rte-imageboxmark { background: #4a90e2; border: 1px solid #fff; }\n                .e-mob-rte span.e-rte-imageboxmark { background: #fff; border: 1px solid #4a90e2;\n                    border-radius: 15px; height: 20px; width: 20px; }\n                .e-mob-rte.e-mob-span span.e-rte-imageboxmark { background: #4a90e2; border: 1px solid #fff; }\n                .e-rte-content .e-content img.e-resize { z-index: 1000; }\n                .e-img-caption .e-img-inner { outline: 0; }\n                .e-img-caption a:focus-visible { outline: none; }\n                .e-img-caption .e-rte-image.e-imgright, .e-img-caption .e-rte-image.e-imgleft { float: none; margin: 0;}\n                body{box-sizing: border-box;min-height: 100px;outline: 0 solid transparent;\n                    overflow-x: auto;padding: 16px;position: relative;text-align: inherit;z-index: 2;}\n                p{margin: 0 0 10px;margin-bottom: 10px;}\n                li{margin-bottom: 10px;}\n                h1{font-size: 2.17em;font-weight: 400;line-height: 1;margin: 10px 0;}\n                h2{font-size: 1.74em;font-weight: 400;margin: 10px 0;}\n                h3{font-size: 1.31em;font-weight: 400;margin: 10px 0;}\n                h4{font-size: 16px;font-weight: 400;line-height: 1.5;margin: 0;}\n                h5{font-size: 00.8em;font-weight: 400;margin: 0;}\n                h6{font-size: 00.65em;font-weight: 400;margin: 0;}\n                blockquote{margin: 10px 0;margin-left: 0;padding-left: 5px;border-left: solid 2px #5c5c5c;}\n                pre{background-color: inherit;border: 0;border-radius: 0;color: #333;\n                    font-size: inherit;line-height: inherit;margin: 0 0 10px;overflow: visible;padding: 0;\n                    white-space: pre-wrap;word-break: inherit;word-wrap: break-word;}\n                strong, b{font-weight: 700;}\n                a{text-decoration: none;user-select: auto;}\n                a:hover{text-decoration: underline;};\n                p:last-child, pre:last-child, blockquote:last-child{margin-bottom: 0;}\n                h3+h4, h4+h5, h5+h6{margin-top: 00.6em;}\n                ul:last-child{margin-bottom: 0;}\n                table { border-collapse: collapse; empty-cells: show;}\n                table td,table th {border: 1px solid #BDBDBD; height: 20px; vertical-align: middle;}\n                table.e-alternate-border tbody tr:nth-child(2n) {background-color: #F5F5F5;}\n                table th {background-color: #E0E0E0;}\n                table.e-dashed-border td,table.e-dashed-border th { border: 1px dashed #BDBDBD} \n                table .e-cell-select {border: 1px double #4a90e2;}\n                span.e-table-box { cursor: nwse-resize; display: block; height: 10px; position: absolute; width: 10px; }\n                span.e-table-box.e-rmob {height: 14px;width: 14px;}\n                .e-row-resize, .e-column-resize { background-color: transparent; background-repeat: repeat;\n                    bottom: 0;cursor: col-resize;height: 1px;overflow: visible;position: absolute;width: 1px; }\n                .e-row-resize { cursor: row-resize; height: 1px;}\n                .e-table-rhelper { cursor: col-resize; opacity: .87;position: absolute;}\n                .e-table-rhelper.e-column-helper { width: 1px; }\n                .e-table-rhelper.e-row-helper {height: 1px;}\n                .e-reicon::before { border-bottom: 6px solid transparent; border-right: 6px solid;\n                    border-top: 6px solid transparent; content: ''; display: block; height: 0;\n                    position: absolute; right: 4px; top: 4px; width: 20px; }\n                .e-reicon::after { border-bottom: 6px solid transparent; border-left: 6px solid;\n                    border-top: 6px solid transparent; content: ''; display: block;\n                    height: 0; left: 4px; position: absolute; top: 4px; width: 20px; z-index: 3; }\n                .e-row-helper.e-reicon::after { top: 10px; transform: rotate(90deg); }\n                .e-row-helper.e-reicon::before { left: 4px; top: -20px; transform: rotate(90deg); }\n                span.e-table-box { background-color: #ffffff; border: 1px solid #BDBDBD; }\n                span.e-table-box.e-rbox-select { background-color: #BDBDBD; border: 1px solid #BDBDBD; }\n                .e-table-rhelper { background-color: #4a90e2;}\n                .e-rtl { direction: rtl; }\n            </style>\n        </head>"+('<body spellcheck="false" autocorrect="off" contenteditable="true">'+(0,r.kf)(e.value,e)+"</body></html>"),n=this.parent.createElement("iframe",{id:this.parent.getID()+"_rte-view",className:"e-rte-content",styles:"display:block;",attrs:{srcdoc:t}});this.setPanel(n),e.element.appendChild(n),n.contentDocument.body.id=this.parent.getID()+"_rte-edit-view",n.contentDocument.body.setAttribute("aria-owns",this.parent.getID()),n.contentDocument.open(),t=this.setThemeColor(t,{color:"#333"}),n.contentDocument.write(t),n.contentDocument.close(),e.enableRtl&&this.contentPanel.contentDocument.body.setAttribute("class","e-rtl")},t.prototype.setThemeColor=function(e,t){var n=getComputedStyle(this.parent.element,".e-richtexteditor").getPropertyValue("color");return e.replace(t.color,n)},t.prototype.getEditPanel=function(){return(0,o.hX)(this.contentPanel.contentDocument)?this.parent.inputElement:this.contentPanel.contentDocument.body},t.prototype.getDocument=function(){return this.getEditPanel().ownerDocument},t}(ve),Se=n(4217),Ee=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on(i.hM,this.enableXhtmlValidation,this),this.parent.on(i.zr,this.removeEventListener,this)},e.prototype.removeEventListener=function(){this.parent.off(i.hM,this.enableXhtmlValidation),this.parent.off(i.zr,this.removeEventListener)},e.prototype.enableXhtmlValidation=function(){this.parent.enableXhtml&&((0,o.hX)(this.parent.inputElement)?this.currentElement=this.parent.element:this.currentElement=this.parent.inputElement,this.clean(this.currentElement),this.AddRootElement(),this.ImageTags(),this.removeTags(),this.RemoveUnsupported(),this.currentElement.innerHTML=this.selfEncloseValidation(this.currentElement.innerHTML,"\n"===this.currentElement.innerText?this.currentElement.innerText.length:this.currentElement.innerText.trim().length),this.parent.setProperties({value:this.currentElement.innerHTML},!0))},e.prototype.selfEncloseValidation=function(e,t){if(0===t&&e.indexOf("table")<0&&e.indexOf("img")<0){var n=e.split("&nbsp;");n[n.length-1]="&#8203;"+n[n.length-1],e=n.join("")}var i;e=e.replace(/<br>/g,"<br/>").replace(/<hr>/g,"<hr/>").replace(/ /g," ");for(var o=[],r=[],a=[/<img(.*?)>/gi,/<area(.*?)>/gi,/<base(.*?)>/gi,/<col (.*?)>/gi,/<embed(.*?)>/gi,/<input(.*?)>/gi,/<link(.*?)>/gi,/<meta(.*?)>/gi,/<param(.*?)>/gi,/<source(.*?)>/gi,/<track(.*?)>/gi,/<wbr(.*?)>/gi],s=0;s<a.length;s++){for(i=a[s].exec(e);null!==i;)o.push(i[0].toString()),i=a[s].exec(e);r=o.slice(0);for(var l=0;l<o.length;l++)-1!==o[l].indexOf("/")&&o[l].lastIndexOf("/")===o[l].length-2||(o[l]=o[l].substr(0,o[l].length-1)+" /"+o[l].substr(o[l].length-1,o[l].length));for(var d=0;d<=o.length-1;d++)e=e.replace(r[d],o[d])}return e},e.prototype.AddRootElement=function(){if(1===this.currentElement.childNodes.length&&"DIV"!==this.currentElement.firstChild.nodeName||this.currentElement.childNodes.length>1){for(var e=this.parent.createElement("div");this.currentElement.childNodes.length>0;)e.appendChild(this.currentElement.childNodes[0]);this.currentElement.appendChild(e)}},e.prototype.clean=function(e){for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];8===n.nodeType||"V:IMAGE"===n.nodeName?(e.removeChild(n),t--):1===n.nodeType&&this.clean(n)}return this.currentElement.innerHTML},e.prototype.ImageTags=function(){for(var e=this.currentElement.querySelectorAll("IMG"),t=e.length-1;t>=0;t--){if(!e[t].hasAttribute("alt"))e[t].setAttribute("alt","")}},e.prototype.removeTags=function(){for(var e=[["br","ul"],["br","ol"],["table","span"],["div","span"],["p","span"]],t=0;t<e.length;t++)this.RemoveElementNode(e[t][0],e[t][1])},e.prototype.RemoveElementNode=function(e,t){for(var n=this.currentElement.querySelectorAll(t),i=0;i<n.length;i++)for(var r=n[i].querySelectorAll(e),a=r.length;a>0;a--)(0,o.Yo)(r[a-1])},e.prototype.RemoveUnsupported=function(){for(var e=this.currentElement.querySelectorAll("u"),t=e.length-1;t>=0;t--){var n=this.parent.createElement("span");n.style.textDecoration="underline",n.innerHTML=e[t].innerHTML,e[t].parentNode.insertBefore(n,e[t]),(0,o.Yo)(e[t])}var i=this.currentElement.querySelectorAll("strong");for(t=i.length-1;t>=0;t--){var r=this.parent.createElement("b");r.innerHTML=i[t].innerHTML,i[t].parentNode.insertBefore(r,i[t]),(0,o.Yo)(i[t])}var a=["language","role","target","contenteditable","cellspacing","cellpadding","border","valign","colspan"];for(t=0;t<=a.length;t++)this.RemoveAttributeByName(a[t])},e.prototype.RemoveAttributeByName=function(e){if(null!==this.currentElement.firstChild&&3!==this.currentElement.firstChild.nodeType)for(var t=0;t<this.currentElement.childNodes.length;t++){var n=this.currentElement.childNodes[t];if(3!==n.nodeType&&"TABLE"!==n.nodeName&&"TBODY"!==n.nodeName&&"THEAD"!==n.nodeName&&"TH"!==n.nodeName&&"TR"!==n.nodeName&&"TD"!==n.nodeName&&(n.hasAttribute(e)&&n.removeAttribute(e),n.hasChildNodes()))for(var i=0;i<n.childNodes.length;i++){var o=n.childNodes[i];if(3!==o.nodeType&&"TABLE"!==o.nodeName&&"TBODY"!==o.nodeName&&"THEAD"!==o.nodeName&&"TH"!==o.nodeName&&"TR"!==o.nodeName&&"TD"!==o.nodeName&&o.hasAttribute(e)&&o.removeAttribute(e),o.hasChildNodes())for(var r=0;r<o.childNodes.length;r++)3!==o.childNodes[r].nodeType&&"TABLE"!==o.childNodes[r].nodeName&&"TBODY"!==o.childNodes[r].nodeName&&"THEAD"!==o.childNodes[r].nodeName&&"TH"!==o.childNodes[r].nodeName&&"TR"!==o.childNodes[r].nodeName&&"TD"!==o.childNodes[r].nodeName&&o.childNodes[r].hasAttribute(e)&&o.childNodes[r].removeAttribute(e)}}},e}(),we=function(){function e(e,t){this.rangeCollection=[],this.isImageDelete=!1,this.parent=e,this.locator=t,this.renderFactory=this.locator.getService("rendererFactory"),this.xhtmlValidation=new Ee(e),this.addEventListener()}return e.prototype.destroy=function(){this.removeEventListener()},e.prototype.sanitizeHelper=function(e){return e=(0,r.mr)(e,this.parent)},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.nodeSelectionObj=new A,this.colorPickerModule=new Se.i(this.parent,this.locator),this.parent.on(i.X0,this.instantiateRenderer,this),this.parent.on(i.dU,this.onToolbarClick,this),this.parent.on(i.u2,this.onKeyDown,this),this.parent.on(i.LL,this.onKeyUp,this),this.parent.on(i.Iw,this.renderColorPicker,this),this.parent.on(i.qO,this.render,this),this.parent.on(i.Ay,this.onPropertyChanged,this),this.parent.on(i.zr,this.destroy,this),this.parent.on(i.Ub,this.selectAll,this),this.parent.on(i.N$,this.selectRange,this),this.parent.on(i.no,this.getSelectedHtml,this),this.parent.on(i.qm,this.onSelectionSave,this),this.parent.on(i.jN,this.onSelectionRestore,this),this.parent.on(i.QH,this.updateReadOnly,this),this.parent.on(i.oh,this.onPaste,this))},e.prototype.updateReadOnly=function(){this.parent.readonly?((0,o.uK)(this.parent.contentModule.getEditPanel(),{contenteditable:"false"}),(0,o.iQ)([this.parent.element],me.YP)):((0,o.uK)(this.parent.contentModule.getEditPanel(),{contenteditable:"true"}),(0,o.vy)([this.parent.element],me.YP))},e.prototype.onSelectionSave=function(){var e=this.contentRenderer.getDocument(),t=this.nodeSelectionObj.getRange(e);this.saveSelection=this.nodeSelectionObj.save(t,e)},e.prototype.onSelectionRestore=function(e){this.parent.isBlur=!1,this.contentRenderer.getEditPanel().focus(),((0,o.hX)(e.items)||e.items)&&this.saveSelection.restore()},e.prototype.onKeyUp=function(e){var t,n=e.args,i=this.parent.getRange(),r=new RegExp(String.fromCharCode(8203),"g");[8,9,13,16,17,18,20,27,37,38,39,40,44,45,46,91,112,113,114,115,116,117,118,119,120,121,122,123].indexOf(n.keyCode)<0&&!n.shiftKey&&!n.ctrlKey&&!n.altKey&&(8203===i.startContainer.textContent.charCodeAt(0)&&(t=i.startOffset-1,i.startContainer.textContent=i.startContainer.textContent.replace(r,""),this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),i.startContainer,t)),!(0,o.hX)(i.startContainer.previousSibling)&&!(0,o.hX)(i.startContainer.previousSibling.parentElement)&&i.startContainer.parentElement===i.startContainer.previousSibling.parentElement&&8203===i.startContainer.previousSibling.textContent.charCodeAt(0)&&i.startContainer.previousSibling.textContent.length<=1&&(i.startContainer.previousSibling.textContent=i.startContainer.previousSibling.textContent.replace(r,"")),8203===i.endContainer.textContent.charCodeAt(i.endOffset)&&(t=i.startOffset,i.endContainer.textContent=i.endContainer.textContent.replace(r,""),this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),i.startContainer,t)))},e.prototype.onKeyDown=function(e){var t,n=this,r=e.args;if("chrome"===o.Pw.info.name&&(t=this.parent.getRange(),this.backSpaceCleanup(e,t),this.deleteCleanup(e,t)),9===r.keyCode&&this.parent.enableTabKey&&!(0,o.hX)(r.target)&&(0,o.hX)((0,o.kp)(r.target,".e-rte-toolbar"))){var s=this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()),l=this.nodeSelectionObj.getParentNodeCollection(s);if("LI"!==l[0].nodeName&&!(0,o.kp)(l[0],"li")&&!(0,o.kp)(l[0],"table")||0!==s.startOffset)if(r.preventDefault(),r.shiftKey){if(this.rangeCollection.length>0&&4===this.rangeCollection[this.rangeCollection.length-1].startContainer.textContent.length){var d=this.rangeCollection[this.rangeCollection.length-1].startContainer;this.nodeSelectionObj.setSelectionText(this.contentRenderer.getDocument(),d,d,0,d.textContent.length),j.Insert(this.contentRenderer.getDocument(),document.createTextNode("")),this.rangeCollection.pop()}}else j.Insert(this.contentRenderer.getDocument(),"&nbsp;&nbsp;&nbsp;&nbsp;"),this.rangeCollection.push(this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()))}if("space"!==e.args.action&&"enter"!==e.args.action&&13!==e.args.keyCode||(this.spaceLink(e.args),"HTML"!==this.parent.editorMode||this.parent.readonly||this.parent.notify(i.tn,{args:e.args})),"space"===e.args.action){var h=this.parent.getRange(),p=h.startContainer.textContent.slice(0,h.startOffset),c=this.isOrderedList(p),u=this.isUnOrderedList(p);if(c&&!u||u&&!c){var m={callBack:null,event:e.args,name:"keydown-handler"},g={cancel:!1,item:{command:"Lists",subCommand:c?"OL":"UL"},name:"actionBegin",originalEvent:e.args,requestType:c?"OL":"UL"};this.parent.trigger(i.eY,g,(function(t){t.cancel||(n.parent.formatter.editorManager.observer.notify(a.Oh,m),n.parent.trigger(i.wn,{editorMode:n.parent.editorMode,elements:n.parent.formatter.editorManager.domNode.blockNodes(),event:e.args,name:i.wn,range:n.parent.getRange(),requestType:c?"OL":"UL"}))}))}}"chrome"!==o.Pw.info.name||((0,o.hX)(this.rangeElement)||(0,o.hX)(this.oldRangeElement))&&((0,o.hX)(this.deleteRangeElement)||(0,o.hX)(this.deleteOldRangeElement))||"TD"===t.startContainer.parentElement.tagName||"TH"===t.startContainer.parentElement.tagName||(this.rangeElement=null,this.oldRangeElement=null,this.deleteRangeElement=null,this.deleteOldRangeElement=null,this.isImageDelete||r.preventDefault())},e.prototype.isOrderedList=function(e){e=e.replace(/\u200B/g,"");var t=[/^[1]+[.]+$/,/^[i]+[.]+$/,/^[a]+[.]+$/];if(!(0,o.hX)(e))for(var n=0;n<t.length;n++)if(t[n].test(e))return!0;return!1},e.prototype.isUnOrderedList=function(e){e=e.replace(/\u200B/g,"");var t=[/^[*]$/,/^[-]$/];if(!(0,o.hX)(e))for(var n=0;n<t.length;n++)if(t[n].test(e))return!0;return!1},e.prototype.backSpaceCleanup=function(e,t){var n=!1;if("Backspace"===e.args.code&&8===e.args.keyCode&&0===t.startOffset&&0===t.endOffset&&0===this.parent.getSelection().length&&t.startContainer.textContent.length>0&&"TD"!==t.startContainer.parentElement.tagName&&"TH"!==t.startContainer.parentElement.tagName){if(this.rangeElement=this.getRootBlockNode(t.startContainer),"OL"===this.rangeElement.tagName||"UL"===this.rangeElement.tagName){var i=this.getRangeLiNode(t.startContainer);i.previousElementSibling&&i.previousElementSibling.childElementCount>0&&(this.oldRangeElement="BR"===i.previousElementSibling.lastElementChild.nodeName?i.previousElementSibling:i.previousElementSibling.lastElementChild,(0,o.hX)(i.lastElementChild)||"BR"===i.lastElementChild.nodeName?this.rangeElement=i:(this.rangeElement=i.lastElementChild,n=!0))}else{if("TABLE"===this.rangeElement.tagName||!(0,o.hX)(this.rangeElement.previousElementSibling)&&"TABLE"===this.rangeElement.previousElementSibling.tagName)return;this.oldRangeElement=this.rangeElement.previousElementSibling}if((0,o.hX)(this.oldRangeElement))return;if("OL"!==this.oldRangeElement.tagName&&"UL"!==this.oldRangeElement.tagName||(this.oldRangeElement=this.oldRangeElement.lastElementChild.lastElementChild?this.oldRangeElement.lastElementChild.lastElementChild:this.oldRangeElement.lastElementChild),this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),this.oldRangeElement,this.oldRangeElement.childNodes.length),this.oldRangeElement.querySelector("BR")&&(0,o.Yo)(this.oldRangeElement.querySelector("BR")),!(0,o.hX)(this.rangeElement)&&this.oldRangeElement!==this.rangeElement){for(;this.rangeElement.firstChild;)this.oldRangeElement.appendChild(this.rangeElement.childNodes[0]);n?(0,o.Yo)(this.rangeElement.parentElement):(0,o.Yo)(this.rangeElement),this.oldRangeElement.normalize()}}},e.prototype.deleteCleanup=function(e,t){var n,i,r=!1;if("Delete"===e.args.code&&46===e.args.keyCode&&0!==this.parent.contentModule.getText().trim().length&&0===this.parent.getSelection().length&&"TD"!==t.startContainer.parentElement.tagName&&"TH"!==t.startContainer.parentElement.tagName){if(this.deleteRangeElement=i=this.getRootBlockNode(t.startContainer),"OL"===this.deleteRangeElement.tagName||"UL"===this.deleteRangeElement.tagName)(n=this.getRangeLiNode(t.startContainer)).nextElementSibling&&n.nextElementSibling.childElementCount>0&&!n.nextElementSibling.querySelector("BR")?(0,o.hX)(n.lastElementChild)?this.deleteRangeElement=n:(this.deleteRangeElement=n.lastElementChild,r=!0):this.deleteRangeElement=this.getRangeElement(n);else if(3===this.deleteRangeElement.nodeType||"TABLE"===this.deleteRangeElement.tagName||!(0,o.hX)(this.deleteRangeElement.nextElementSibling)&&"TABLE"===this.deleteRangeElement.nextElementSibling.tagName)return;if(this.getCaretIndex(t,this.deleteRangeElement)===this.deleteRangeElement.textContent.length){if((0,o.hX)(n)?this.deleteOldRangeElement=this.deleteRangeElement.nextElementSibling:r||!(0,o.hX)(n.nextElementSibling)?this.deleteOldRangeElement=this.getRangeElement(n.nextElementSibling):this.deleteOldRangeElement=i.nextElementSibling,(0,o.hX)(this.deleteOldRangeElement))return;if(0===t.startOffset&&1===t.endOffset&&"IMG"===this.deleteRangeElement.childNodes[0].nodeName?(this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.parent.contentModule.getDocument(),this.deleteRangeElement,this.deleteRangeElement,0,1),this.isImageDelete=!0):(this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),this.deleteRangeElement,this.deleteRangeElement.childNodes.length),this.isImageDelete=!1),this.deleteRangeElement.querySelector("BR")&&(0,o.Yo)(this.deleteRangeElement.querySelector("BR")),(0,o.hX)(this.deleteRangeElement)||"OL"===this.deleteOldRangeElement.tagName||"UL"===this.deleteOldRangeElement.tagName||this.deleteOldRangeElement===this.deleteRangeElement)this.deleteRangeElement=null,this.deleteOldRangeElement=null;else{for(;this.deleteOldRangeElement.firstChild;)this.deleteRangeElement.appendChild(this.deleteOldRangeElement.childNodes[0]);r?(0,o.Yo)(this.deleteOldRangeElement.parentElement):(0,o.Yo)(this.deleteOldRangeElement),this.deleteRangeElement.normalize()}}else this.deleteRangeElement=null}},e.prototype.getCaretIndex=function(e,t){var n=0;if(0!==this.parent.contentModule.getDocument().getSelection().rangeCount){var i=e.cloneRange();i.selectNodeContents(t),i.setEnd(e.endContainer,e.endOffset),n=i.toString().length}return n},e.prototype.getRangeElement=function(e){return e.lastElementChild?"BR"===e.lastElementChild.tagName?e.lastElementChild.previousElementSibling?e.lastElementChild.previousElementSibling:e:e.lastElementChild:e},e.prototype.getRootBlockNode=function(e){for(;e&&this.parent&&this.parent.inputElement!==e&&e.parentElement!==this.parent.inputElement;e)e=e.parentElement;return e},e.prototype.getRangeLiNode=function(e){for(var t=e.parentElement;t!==this.parent.inputElement&&(1!==t.nodeType||"LI"!==t.tagName);)t=t.parentElement;return t},e.prototype.onPaste=function(e){var t=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi);if(e.text.match(t)){if(e.isWordPaste)return;e.args.preventDefault();for(var n=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),i=(this.parent.formatter.editorManager.nodeSelection.save(n,this.parent.contentModule.getDocument()),new RegExp(/([^\S]|^)(((https?\:\/\/)))/gi)),a=new RegExp(/([^\S]|^)(((www\.))(\S+))/gi),s=e.text.split("\n"),l="",d=0;d<s.length;d++)if(""===s[d].trim())l+=(0,r.Bu)(this.parent);else{for(var h="",p=!0,c=s[d].split(" "),u=0;u<c.length;u++)""===c[u].trim()?h+=p?"&nbsp;":" ":(p=!1,h+=c[u]+" ");l+=0===d?"<span>"+h.trim()+"</span>":"<p>"+h.trim()+"</p>"}var m=this.parent.createElement("div");m.setAttribute("class","pasteContent"),m.style.display="inline",m.innerHTML=l.replace("&para","&amp;para");var g=m.querySelectorAll("span, p");for(d=0;d<g.length;d++){var f=g[d].innerHTML.split(" "),b="";for(u=0;u<f.length;u++)f[u].match(i)||f[u].match(a)?b+='<a className="e-rte-anchor" href="'+f[u]+'" title="'+f[u]+'"target="_blank">'+f[u]+" </a>":b+=f[u]+" ";g[d].innerHTML=b.trim()}(0,o.hX)(this.parent.pasteCleanupModule)?this.parent.formatter.editorManager.execCommand("insertHTML",null,null,null,m):e.callBack(m.innerHTML)}},e.prototype.spaceLink=function(e){var t=this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()),n=this.nodeSelectionObj.getParentNodeCollection(t),i=t.startContainer.textContent.substr(0,t.endOffset),o=i.split(" "),r=o[o.length-1],a=t.startOffset-(i.length-o[o.length-1].length);r=r.slice(0,a);var s=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi);if("A"!==n[0].nodeName&&r.match(s)){var l=this.nodeSelectionObj.save(t,this.parent.contentModule.getDocument()),d={url:r.indexOf("http")>-1?r:"http://"+r,selection:l,selectParent:this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(t),text:r,title:"",target:"_blank"};this.parent.formatter.process(this.parent,{item:{command:"Links",subCommand:"CreateLink"}},e,d)}},e.prototype.onToolbarClick=function(e){var t,n,r,a=e.item,s=(0,o.kp)(e.originalEvent.target,".e-rte-quick-popup");if(s&&!s.classList.contains("e-rte-inline-popup")){if("SourceCode"!==a.subCommand&&"Preview"!==a.subCommand&&"FontColor"!==a.subCommand&&"BackgroundColor"!==a.subCommand){(0,I.wU)()&&"Images"===a.command&&this.nodeSelectionObj.restore();var l=this.nodeSelectionObj.getRange(this.parent.contentModule.getDocument());t=this.nodeSelectionObj.save(l,this.parent.contentModule.getDocument()),n=this.nodeSelectionObj.getNodeCollection(l),r=this.nodeSelectionObj.getParentNodeCollection(l)}"Images"===a.command&&this.parent.notify(i.tb,{member:"image",args:e,selectNode:n,selection:t,selectParent:r}),"Links"===a.command&&this.parent.notify(i.dJ,{member:"link",args:e,selectNode:n,selection:t,selectParent:r}),"Table"===a.command&&this.parent.notify(i.ls,{member:"table",args:e,selectNode:n,selection:t,selectParent:r})}else{var d=document.getElementById(this.parent.getID()+"_rtelink"),h=document.getElementById(this.parent.getID()+"_image");if("SourceCode"!==a.subCommand&&"Preview"!==a.subCommand&&"FontColor"!==a.subCommand&&"BackgroundColor"!==a.subCommand){l=this.nodeSelectionObj.getRange(this.parent.contentModule.getDocument());(0,o.hX)(d)&&(0,o.hX)(h)&&(t=this.nodeSelectionObj.save(l,this.parent.contentModule.getDocument())),n=this.nodeSelectionObj.getNodeCollection(l),r=this.nodeSelectionObj.getParentNodeCollection(l)}switch(a.subCommand){case"Maximize":this.parent.notify(i.Do,{args:e});break;case"Minimize":this.parent.notify(i.gi,{args:e});break;case"CreateLink":this.parent.notify(i.Ck,{member:"link",args:e,selectNode:n,selection:t,selectParent:r});break;case"RemoveLink":this.parent.notify(i.yL,{member:"link",args:e,selectNode:n,selection:t,selectParent:r});break;case"Print":this.parent.print();break;case"Image":this.parent.notify(i.V4,{member:"image",args:e,selectNode:n,selection:t,selectParent:r});break;case"CreateTable":this.parent.notify(i.ZR,{member:"table",args:e,selection:t});break;case"SourceCode":this.parent.notify(i.X5,{member:"viewSource",args:e});break;case"Preview":this.parent.notify(i.Lv,{member:"updateSource",args:e});break;case"FontColor":case"BackgroundColor":break;case"File":this.parent.notify(i.AE,{member:"fileManager",args:e,selectNode:n,selection:t,selectParent:r});break;default:this.parent.formatter.process(this.parent,e,e.originalEvent,null)}}},e.prototype.renderColorPicker=function(e){this.colorPickerModule.renderColorPickerInput(e)},e.prototype.instantiateRenderer=function(){this.parent.iframeSettings.enable?this.renderFactory.addRenderer(ue.nJ.Content,new Ce(this.parent,this.locator)):this.renderFactory.addRenderer(ue.nJ.Content,new ve(this.parent,this.locator))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(i.qO,this.render),this.parent.off(i.Ay,this.onPropertyChanged),this.parent.off(i.dU,this.onToolbarClick),this.parent.off(i.Iw,this.renderColorPicker),this.parent.off(i.zr,this.destroy),this.parent.off(i.u2,this.onKeyDown),this.parent.off(i.X0,this.instantiateRenderer),this.parent.off(i.Ub,this.selectAll),this.parent.off(i.N$,this.selectRange),this.parent.off(i.no,this.getSelectedHtml),this.parent.off(i.qm,this.onSelectionSave),this.parent.off(i.jN,this.onSelectionRestore),this.parent.off(i.QH,this.updateReadOnly),this.parent.off(i.oh,this.onPaste))},e.prototype.render=function(){this.contentRenderer=this.renderFactory.getRenderer(ue.nJ.Content);var e=this.contentRenderer.getEditPanel(),t={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};if((0,o.hX)(this.parent.formatter)){var n=new ce({currentDocument:this.contentRenderer.getDocument(),element:e,options:t});this.parent.setProperties({formatter:n},!0)}else this.parent.formatter.updateFormatter(e,this.contentRenderer.getDocument(),t);this.parent.enableXhtml&&this.parent.notify(i.hM,{}),this.parent.toolbarSettings.enable&&(this.toolbarUpdate=new be(this.parent)),this.parent.inlineMode.enable&&((0,o.hX)(this.parent.fontFamily.default)||(e.style.fontFamily=this.parent.fontFamily.default),(0,o.hX)(this.parent.fontSize.default)||(e.style.fontSize=this.parent.fontSize.default)),this.parent.notify(i.i2,{})},e.prototype.onPropertyChanged=function(e){if(!(0,o.hX)(e.newProp.formatter)){var t=this.contentRenderer.getEditPanel(),n={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};this.parent.formatter.updateFormatter(t,this.contentRenderer.getDocument(),n)}},e.prototype.getModuleName=function(){return"htmlEditor"},e.prototype.selectAll=function(){var e=(0,r.zb)(this.parent.contentModule.getDocument(),this.parent.contentModule.getEditPanel());e.length>0&&this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.parent.contentModule.getDocument(),e[0],e[e.length-1],0,e[e.length-1].textContent.length)},e.prototype.selectRange=function(e){this.parent.formatter.editorManager.nodeSelection.setRange(this.parent.contentModule.getDocument(),e.range)},e.prototype.getSelectedHtml=function(e){e.callBack(this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()).toString())},e}()},4911:(e,t,n)=>{n.d(t,{v:()=>g});var i=n(8452),o=n(1411),r=n(5290),a=n(134),s=n(5996),l=n(5624),d=n(377),h=n(2611),p=n(4217),c=function(){function e(e,t){this.parent=e,this.locator=t,this.isDOMElement=!1,this.renderFactory=this.locator.getService("rendererFactory"),this.contentRenderer=this.renderFactory.getRenderer(o.nJ.Content),this.popupRenderer=this.renderFactory.getRenderer(o.nJ.Popup),this.dropDownButtons=new h.V(this.parent,this.locator),this.colorPickerObj=new p.i(this.parent,this.locator)}return e.prototype.appendPopupContent=function(){this.toolbarElement=this.parent.createElement("div",{className:l.Y4}),this.element.appendChild(this.toolbarElement)},e.prototype.render=function(e){var t;t="Image"===e.popupType?l.LT:"Inline"===e.popupType?l.tO:"";var n=(0,i.Lz)(e.popupType+"_Quick_Popup");this.stringItems=e.toolbarItems,this.element=this.parent.createElement("div",{id:n,className:t+" "+l.bU}),this.element.setAttribute("aria-owns",this.parent.getID()),this.appendPopupContent(),this.createToolbar(e.toolbarItems,e.mode),this.popupRenderer.renderPopup(this),this.addEventListener()},e.prototype.createToolbar=function(e,t){this.quickTBarObj=new d.b(this.parent,this.locator),this.quickTBarObj.render({container:"quick",target:this.toolbarElement,items:e,mode:t}),this.quickTBarObj.toolbarObj.refresh()},e.prototype.setPosition=function(e){var t,n,o=(0,i.kp)(e.target,".e-img-caption"),r=(0,i.hX)(o)?e.target:o;(0,i.iQ)([this.toolbarElement],[l.WX]);var a=r.offsetTop,s=window.pageYOffset+e.parentData.top;n=a-e.editTop>e.popHeight?s+e.tBarElementHeight+(a-e.editTop)-e.popHeight-5:e.editTop+e.editHeight-(a+r.offsetHeight)>e.popHeight?s+e.tBarElementHeight+(a-e.editTop)+r.offsetHeight+5:e.y,t=r.offsetWidth>e.popWidth?r.offsetWidth/2-e.popWidth/2+e.parentData.left+r.offsetLeft:e.parentData.left+r.offsetLeft,this.popupObj.position.X=t+e.popWidth>e.parentData.right?e.parentData.right-e.popWidth:t,this.popupObj.position.Y=n>=0?n:e.y+5,this.popupObj.dataBind(),(0,i.vy)([this.toolbarElement],[l.WX])},e.prototype.checkCollision=function(e,t,n){var i,o,r=e.parentData.top,a=e.windowY+r+e.tBarElementHeight,l=[];l="document"===t?(0,s.D$)(e.popup):(0,s.D$)(e.popup,e.parentElement);for(var d=0;d<l.length;d++)switch(l[d]){case"top":o="document"===t?e.windowY:window.pageYOffset+r+e.tBarElementHeight;break;case"bottom":o="document"===t?"inline"===n?e.y-e.popHeight-10:e.windowHeight-(r+e.tBarElementHeight)>e.popHeight?a-e.windowHeight>e.popHeight?a+(e.windowHeight-r)-e.popHeight:a:e.windowY+(r+e.tBarElementHeight):"IMG"!==e.target.tagName?e.parentData.bottom+window.pageYOffset-e.popHeight-10:e.parentData.bottom+window.pageYOffset-e.popHeight-5;break;case"right":i="inline"===n?window.pageXOffset+(e.windowWidth-(e.popWidth+e.bodyRightSpace+10)):e.x-e.popWidth;break;case"left":i="inline"===n?0:e.parentData.left}this.popupObj.position.X=i||this.popupObj.position.X,this.popupObj.position.Y=o||this.popupObj.position.Y,this.popupObj.dataBind()},e.prototype.showPopup=function(e,t,n){var o=this,s={popup:this.popupObj,cancel:!1,targetElement:n};this.parent.trigger(r.EP,s,(function(r){if(!r.cancel){var s,d=void 0,h=void 0,p=window.getComputedStyle(document.body),c=parseFloat(p.marginRight.split("px")[0])+parseFloat(p.paddingRight.split("px")[0]),u=window.innerHeight,m=window.innerWidth,g=o.parent.element,f=!(0,i.hX)(o.parent.getToolbar()),b=f&&o.parent.toolbarModule.getToolbarHeight(),v=f&&o.parent.toolbarModule.getExpandTBarPopHeight(),y=f?b+v:0;if((0,i.iQ)([o.element],[l.sB]),i.Pw.isDevice&&!(0,a.wU)()&&(0,i.iQ)([o.parent.getToolbar()],[l.sB]),o.parent.iframeSettings.enable)d=(s=o.contentRenderer.getPanel().contentWindow).pageYOffset,h=s.innerHeight;else d=(s=(0,i.kp)(n,"."+l.Jt))?s.scrollTop:0,h=s?s.offsetHeight:0;o.parent.inlineMode.enable||(0,i.kp)(n,"table")||(o.parent.disableToolbarItem(o.parent.toolbarSettings.items),o.parent.enableToolbarItem(["Undo","Redo"])),(0,i.BC)([o.element],document.body),o.popupObj.position.X=e+20,o.popupObj.position.Y=t+20,o.popupObj.dataBind(),o.popupObj.element.classList.add("e-popup-open"),o.dropDownButtons.renderDropDowns({container:o.toolbarElement,containerType:"quick",items:o.stringItems}),o.colorPickerObj.renderColorPickerInput({container:o.toolbarElement,containerType:"quick",items:o.stringItems});var C={x:e,y:t,target:n,editTop:d,editHeight:h,popup:o.popupObj.element,popHeight:o.popupObj.element.offsetHeight,popWidth:o.popupObj.element.offsetWidth,parentElement:g,bodyRightSpace:c,windowY:window.pageYOffset,windowHeight:u,windowWidth:m,parentData:g.getBoundingClientRect(),tBarElementHeight:y};"IMG"===n.tagName&&o.setPosition(C),o.parent.inlineMode.enable||o.checkCollision(C,"parent",""),o.checkCollision(C,"document",o.parent.inlineMode.enable?"inline":""),o.popupObj.element.classList.remove("e-popup-open"),(0,i.vy)([o.element],[l.sB]),o.popupObj.show({name:"ZoomIn",duration:i.Pw.isIE?250:400}),(0,i.sN)(o.element,{maxWidth:window.outerWidth+"px"}),(0,i.iQ)([o.element],[l.Z5]),o.isDOMElement=!0}}))},e.prototype.hidePopup=function(){var e=this.parent.sourceCodeModule.getViewPanel();i.Pw.isDevice&&!(0,a.wU)()&&(0,i.vy)([this.parent.getToolbar()],[l.sB]),(0,i.hX)(this.parent.getToolbar())||this.parent.inlineMode.enable||((0,i.hX)(e)||"none"===e.style.display)&&this.parent.enableToolbarItem(this.parent.toolbarSettings.items),this.removeEleFromDOM(),this.isDOMElement=!1},e.prototype.addQTBarItem=function(e,t){this.quickTBarObj.toolbarObj.addItems(this.quickTBarObj.getItems(e,"toolbar"),t)},e.prototype.removeQTBarItem=function(e){this.quickTBarObj.toolbarObj.removeItems(e)},e.prototype.removeEleFromDOM=function(){var e=this.popupObj.element;if(this.isDOMElement){this.dropDownButtons.destroyDropDowns(),this.colorPickerObj.destroyColorPicker(),(0,i.vy)([this.element],[l.Z5]),(0,i.Yo)(e);var t=this.popupObj;this.parent.trigger(r.tk,t)}},e.prototype.updateStatus=function(e){var t={args:e,dropDownModule:this.dropDownButtons,parent:this.parent,tbElements:(0,i.Ub)("."+l.um,this.element),tbItems:this.quickTBarObj.toolbarObj.items};(0,a.Qx)(t,!0,this.parent),(0,i.Lt)(".e-rte-srctextarea",this.parent.element)||(0,a.kB)(this.parent.getBaseToolbarObject(),this.parent.formatter.editorManager.undoRedoManager.getUndoStatus())},e.prototype.destroy=function(){this.popupObj&&!this.popupObj.isDestroyed&&(this.popupObj.destroy(),this.removeEleFromDOM()),this.removeEventListener()},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(r.zr,this.destroy,this),this.parent.on(r.Ay,this.onPropertyChanged,this),this.parent.inlineMode.enable&&this.parent.on(r.tt,this.updateStatus,this))},e.prototype.onPropertyChanged=function(e){if(!(0,i.hX)(e.newProp.inlineMode))for(var t=0,n=Object.keys(e.newProp.inlineMode);t<n.length;t++){if("enable"===n[t])e.newProp.inlineMode.enable?this.parent.on(r.tt,this.updateStatus,this):this.parent.off(r.tt,this.updateStatus)}},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(r.zr,this.destroy),this.parent.off(r.Ay,this.onPropertyChanged),this.parent.inlineMode.enable&&this.parent.off(r.tt,this.updateStatus))},e}(),u=n(155),m=function(){function e(e){this.parent=e}return e.prototype.quickToolbarOpen=function(){var e=this.popupObj;this.parent.trigger(r.tr,e)},e.prototype.renderPopup=function(e){this.setPanel(e.element),this.renderPanel(),e.popupObj=new u.zD(e.element,{targetType:"relative",relateTo:this.parent.element,open:this.quickToolbarOpen.bind(this)}),this.popupObj=e.popupObj,e.popupObj.hide()},e.prototype.renderPanel=function(){this.getPanel().classList.add(l.Bj)},e.prototype.getPanel=function(){return this.popupPanel},e.prototype.setPanel=function(e){this.popupPanel=e},e}(),g=function(){function e(e,t){this.parent=e,this.locator=t,this.renderFactory=this.locator.getService("rendererFactory"),this.renderFactory.addRenderer(o.nJ.Popup,new m(this.parent)),this.addEventListener()}return e.prototype.formatItems=function(e){var t=[];return e.forEach((function(e){if("string"===typeof e)switch(e.toLocaleLowerCase()){case"open":t.push("openLink");break;case"edit":t.push("editLink");break;case"unlink":t.push("removeLink");break;default:t.push(e)}else t.push(e)})),t},e.prototype.getQTBarOptions=function(e,t,n,i){return{popupType:e,toolbarItems:n,mode:t,renderType:i}},e.prototype.createQTBar=function(e,t,n,i){if(n.length<1)return null;var o=new c(this.parent,this.locator);return o.render(this.getQTBarOptions(e,t,this.formatItems(n),i)),o},e.prototype.initializeQuickToolbars=function(){this.parent.quickToolbarModule=this,this.contentRenderer=this.renderFactory.getRenderer(o.nJ.Content),this.parent.inlineMode.enable&&this.parent.inlineMode.onSelection&&(0,a.wU)()&&i.Jm.add(this.contentRenderer.getDocument(),"selectionchange",this.selectionChangeHandler,this)},e.prototype.onMouseDown=function(e){this.parent.isBlur=!1,this.parent.isRTE=!0},e.prototype.keyUpQT=function(e){27==e.which&&this.hideQuickToolbars()},e.prototype.renderQuickToolbars=function(){this.linkQTBar||this.imageQTBar||this.textQTBar||this.tableQTBar||(this.linkQTBar=this.createQTBar("Link","Scrollable",this.parent.quickToolbarSettings.link,o.nJ.LinkToolbar),this.renderFactory.addRenderer(o.nJ.LinkToolbar,this.linkQTBar),this.textQTBar=this.createQTBar("Text","Scrollable",this.parent.quickToolbarSettings.text,o.nJ.TextToolbar),this.renderFactory.addRenderer(o.nJ.TextToolbar,this.textQTBar),this.imageQTBar=this.createQTBar("Image","MultiRow",this.parent.quickToolbarSettings.image,o.nJ.ImageToolbar),this.renderFactory.addRenderer(o.nJ.ImageToolbar,this.imageQTBar),this.tableQTBar=this.createQTBar("Table","MultiRow",this.parent.quickToolbarSettings.table,o.nJ.TableToolbar),this.renderFactory.addRenderer(o.nJ.TableToolbar,this.tableQTBar),this.linkQTBar&&(i.Jm.add(this.linkQTBar.element,"mousedown",this.onMouseDown,this),i.Jm.add(this.linkQTBar.element,"keyup",this.keyUpQT,this)),this.imageQTBar&&(i.Jm.add(this.imageQTBar.element,"mousedown",this.onMouseDown,this),i.Jm.add(this.imageQTBar.element,"keyup",this.keyUpQT,this)),this.textQTBar&&(i.Jm.add(this.textQTBar.element,"mousedown",this.onMouseDown,this),i.Jm.add(this.textQTBar.element,"keyup",this.keyUpQT,this)),this.tableQTBar&&(i.Jm.add(this.tableQTBar.element,"mousedown",this.onMouseDown,this),i.Jm.add(this.tableQTBar.element,"keyup",this.keyUpQT,this)))},e.prototype.renderInlineQuickToolbar=function(){!this.parent.inlineMode.enable||i.Pw.isDevice&&!(0,a.wU)()||((0,i.iQ)([this.parent.element],[l.hg]),this.inlineQTBar=this.createQTBar("Inline","MultiRow",this.parent.toolbarSettings.items,o.nJ.InlineToolbar),this.renderFactory.addRenderer(o.nJ.InlineToolbar,this.inlineQTBar),i.Jm.add(this.inlineQTBar.element,"mousedown",this.onMouseDown,this),i.Jm.add(this.inlineQTBar.element,"keyup",this.keyUpQT,this))},e.prototype.showInlineQTBar=function(e,t,n){this.parent.readonly||"img"===n.tagName.toLowerCase()||this.inlineQTBar.showPopup(e,t,n)},e.prototype.hideInlineQTBar=function(){this.inlineQTBar&&!(0,a.nB)(this.inlineQTBar.element,"e-popup-close")&&this.inlineQTBar.hidePopup()},e.prototype.hideQuickToolbars=function(){this.linkQTBar&&!(0,a.nB)(this.linkQTBar.element,"e-popup-close")&&document.body.contains(this.linkQTBar.element)&&this.linkQTBar.hidePopup(),this.textQTBar&&!(0,a.nB)(this.textQTBar.element,"e-popup-close")&&document.body.contains(this.textQTBar.element)&&this.textQTBar.hidePopup(),this.imageQTBar&&!(0,a.nB)(this.imageQTBar.element,"e-popup-close")&&document.body.contains(this.imageQTBar.element)&&this.imageQTBar.hidePopup(),this.tableQTBar&&!(0,a.nB)(this.tableQTBar.element,"e-popup-close")&&document.body.contains(this.tableQTBar.element)&&this.tableQTBar.hidePopup(),!this.parent.inlineMode.enable||i.Pw.isDevice&&!(0,a.wU)()||this.hideInlineQTBar()},e.prototype.deBounce=function(e,t,n){var i=this;clearTimeout(this.deBouncer),this.deBouncer=window.setTimeout((function(){i.showInlineQTBar(e,t,n)}),1e3)},e.prototype.mouseUpHandler=function(e){if(this.parent.inlineMode.enable&&(!i.Pw.isDevice||(0,a.wU)())){var t=e.args.touches?e.args.changedTouches[0]:e.args,n=this.parent.getRange(),o=e.args.target;if((0,i.hX)((0,i.Lt)("."+l.tO,document.body))){if((0,a.wU)()&&e.touchData&&e.touchData.prevClientX!==e.touchData.clientX&&e.touchData.prevClientY!==e.touchData.clientY)return;this.hideInlineQTBar();var r=this.parent.element.getBoundingClientRect().left;if(this.offsetX=this.parent.iframeSettings.enable?window.pageXOffset+r+t.clientX:t.pageX,this.offsetY=(0,a.kA)(t,this.parent.element,this.parent.iframeSettings.enable),"TEXTAREA"===o.nodeName)this.showInlineQTBar(this.offsetX,this.offsetY,o);else{var s=(0,i.kp)(o,"a");o=s||o;var d=this.parent.getRange().startContainer.parentElement,h=this.parent.getRange().endContainer.parentElement;if(((0,i.hX)((0,i.kp)(d,"A"))||(0,i.hX)((0,i.kp)(h,"A")))&&(!(0,i.kp)(o,"td,th")||!n.collapsed)&&("IMG"!==o.tagName||this.parent.getRange().startOffset!==this.parent.getRange().endOffset)){if(this.parent.inlineMode.onSelection&&n.collapsed)return;this.target=o,this.showInlineQTBar(this.offsetX,this.offsetY,o)}}}}},e.prototype.keyDownHandler=function(){!this.parent.inlineMode.enable||i.Pw.isDevice&&!(0,a.wU)()||(0,i.hX)((0,i.Lt)("."+l.tO,document))||this.hideInlineQTBar()},e.prototype.inlineQTBarMouseDownHandler=function(){!this.parent.inlineMode.enable||i.Pw.isDevice&&!(0,a.wU)()||(0,i.hX)((0,i.Lt)("."+l.tO,document))||this.hideInlineQTBar()},e.prototype.keyUpHandler=function(e){if(this.parent.inlineMode.enable&&!i.Pw.isDevice){if(this.parent.inlineMode.onSelection)return;var t=e.args;this.deBounce(this.offsetX,this.offsetY,t.target)}},e.prototype.selectionChangeHandler=function(e){var t=this;clearTimeout(this.deBouncer),this.deBouncer=window.setTimeout((function(){t.onSelectionChange(e)}),1e3)},e.prototype.onSelectionChange=function(e){(0,i.hX)((0,i.Lt)("."+l.tO,document.body))&&(this.contentRenderer.getDocument().getSelection().isCollapsed||this.mouseUpHandler({args:e}))},e.prototype.getInlineBaseToolbar=function(){return this.inlineQTBar&&this.inlineQTBar.quickTBarObj},e.prototype.destroy=function(){this.linkQTBar&&(i.Jm.remove(this.linkQTBar.element,"mousedown",this.onMouseDown),i.Jm.remove(this.linkQTBar.element,"keyup",this.keyUpQT),this.linkQTBar.destroy()),this.textQTBar&&(i.Jm.remove(this.textQTBar.element,"mousedown",this.onMouseDown),i.Jm.remove(this.textQTBar.element,"keyup",this.keyUpQT),this.textQTBar.destroy()),this.imageQTBar&&(i.Jm.remove(this.imageQTBar.element,"mousedown",this.onMouseDown),i.Jm.remove(this.imageQTBar.element,"keyup",this.keyUpQT),this.imageQTBar.destroy()),this.tableQTBar&&(i.Jm.remove(this.tableQTBar.element,"mousedown",this.onMouseDown),i.Jm.remove(this.tableQTBar.element,"keyup",this.keyUpQT),this.tableQTBar.destroy()),this.inlineQTBar&&(i.Jm.remove(this.inlineQTBar.element,"mousedown",this.onMouseDown),i.Jm.remove(this.inlineQTBar.element,"keyup",this.keyUpQT),(0,a.wU)()&&i.Jm.remove(document,"selectionchange",this.selectionChangeHandler),this.inlineQTBar.destroy()),this.removeEventListener()},e.prototype.wireInlineQTBarEvents=function(){this.parent.on(r.Je,this.mouseUpHandler,this),this.parent.on(r.cT,this.inlineQTBarMouseDownHandler,this),this.parent.on(r.u2,this.keyDownHandler,this),this.parent.on(r.LL,this.keyUpHandler,this),this.parent.on(r.y,this.mouseUpHandler,this),this.parent.on(r.RJ,this.renderInlineQuickToolbar,this)},e.prototype.unWireInlineQTBarEvents=function(){this.parent.off(r.Je,this.mouseUpHandler),this.parent.off(r.cT,this.inlineQTBarMouseDownHandler),this.parent.off(r.u2,this.keyDownHandler),this.parent.off(r.LL,this.keyUpHandler),this.parent.off(r.y,this.mouseUpHandler),this.parent.off(r.RJ,this.renderInlineQuickToolbar)},e.prototype.toolbarUpdated=function(e){this.linkQTBar&&!(0,a.nB)(this.linkQTBar.element,"e-popup-close")&&this.linkQTBar.hidePopup(),this.imageQTBar&&!(0,a.nB)(this.imageQTBar.element,"e-popup-close")&&this.imageQTBar.hidePopup(),this.tableQTBar&&!(0,a.nB)(this.tableQTBar.element,"e-popup-close")&&this.tableQTBar.hidePopup()},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(r.qO,this.initializeQuickToolbars,this),this.parent.on(r.cT,this.renderQuickToolbars,this),this.parent.on(r.tt,this.toolbarUpdated,this),this.parent.on(r.gv,this.renderQuickToolbars,this),this.wireInlineQTBarEvents(),this.parent.on(r.Ay,this.onPropertyChanged,this),"hide"===this.parent.quickToolbarSettings.actionOnScroll&&(this.parent.on(r.W2,this.hideQuickToolbars,this),this.parent.on(r.Vd,this.hideQuickToolbars,this)),this.parent.on(r.T0,this.hideQuickToolbars,this),this.parent.on(r.KK,this.onIframeMouseDown,this),this.parent.on(r.zr,this.destroy,this),this.parent.on(r.u2,this.onKeyDown,this),this.parent.on(r.S7,this.setRtl,this))},e.prototype.onKeyDown=function(e){var t=e.args;8!==t.which&&46!==t.which||this.imageQTBar&&!(0,a.nB)(this.imageQTBar.element,"e-popup-close")&&this.imageQTBar.hidePopup()},e.prototype.onIframeMouseDown=function(){this.hideQuickToolbars(),this.hideInlineQTBar()},e.prototype.setRtl=function(e){this.inlineQTBar&&this.inlineQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:e.enableRtl}),this.imageQTBar&&this.imageQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:e.enableRtl}),this.linkQTBar&&this.imageQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:e.enableRtl})},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(r.qO,this.initializeQuickToolbars),this.parent.off(r.cT,this.renderQuickToolbars),this.parent.off(r.tt,this.toolbarUpdated),this.parent.off(r.gv,this.renderQuickToolbars),this.unWireInlineQTBarEvents(),this.parent.off(r.Ay,this.onPropertyChanged),"hide"===this.parent.quickToolbarSettings.actionOnScroll&&(this.parent.off(r.W2,this.hideQuickToolbars),this.parent.off(r.Vd,this.hideQuickToolbars)),this.parent.off(r.T0,this.hideQuickToolbars),this.parent.off(r.zr,this.destroy),this.parent.off(r.KK,this.onIframeMouseDown),this.parent.off(r.u2,this.onKeyDown),this.parent.off(r.S7,this.setRtl))},e.prototype.onPropertyChanged=function(e){if(!(0,i.hX)(e.newProp.quickToolbarSettings))for(var t=0,n=Object.keys(e.newProp.quickToolbarSettings);t<n.length;t++){if("actionOnScroll"===n[t])"none"===e.newProp.quickToolbarSettings.actionOnScroll?(this.parent.off(r.W2,this.hideQuickToolbars),this.parent.off(r.Vd,this.hideQuickToolbars)):(this.parent.on(r.W2,this.hideQuickToolbars,this),this.parent.on(r.Vd,this.hideQuickToolbars,this))}e.module===this.getModuleName()&&(this.inlineQTBar&&((0,i.vy)([this.parent.element],[l.hg]),this.unWireInlineQTBarEvents(),this.hideInlineQTBar()),!this.parent.inlineMode.enable||i.Pw.isDevice&&!(0,a.wU)()||((0,i.iQ)([this.parent.element],[l.hg]),this.wireInlineQTBarEvents()))},e.prototype.getModuleName=function(){return"quickToolbar"},e}()},7125:(e,t,n)=>{n.d(t,{M:()=>y});var i=n(8452),o=n(5290),r=n(5624),a=n(1411),s=n(134),l=n(1011),d=n(199),h=n(6057),p=n(155),c=n(3058),u=function(){function e(e){this.parent=e,this.wireEvent()}return e.prototype.wireEvent=function(){this.parent.on(o.zr,this.unWireEvent,this)},e.prototype.unWireEvent=function(){this.parent.off(o.zr,this.unWireEvent),this.popupOverlay&&i.Jm.remove(this.popupOverlay,"click touchmove",this.onPopupOverlay),this.removePopupContainer()},e.prototype.toolbarBeforeCreate=function(e){"Extended"===this.mode&&(e.enableCollision=!1)},e.prototype.toolbarCreated=function(){this.parent.notify(o.Ux,this)},e.prototype.toolbarClicked=function(e){this.parent.enabled&&(this.parent.readonly&&!(0,i.hX)(e.item)||this.parent.notify(o.EJ,e),this.parent.trigger("toolbarClick",e))},e.prototype.dropDownSelected=function(e){this.parent.notify(o.uY,e),this.onPopupOverlay()},e.prototype.beforeDropDownItemRender=function(e){!this.parent.readonly&&this.parent.enabled&&this.parent.notify(o.QL,e)},e.prototype.dropDownOpen=function(e){if(e.element.parentElement.getAttribute("id").indexOf("TableCell")>-1&&!(0,i.hX)(e.element.parentElement.querySelector(".e-cell-merge"))&&(!(0,i.hX)(e.element.parentElement.querySelector(".e-cell-horizontal-split"))||!(0,i.hX)(e.element.parentElement.querySelector(".e-cell-vertical-split")))){var t=e.element.querySelectorAll("li");1===this.parent.inputElement.querySelectorAll(".e-cell-select").length?((0,i.iQ)([t[0]],"e-disabled"),(0,i.vy)([t[1],t[2]],"e-disabled")):this.parent.inputElement.querySelectorAll(".e-cell-select").length>1&&((0,i.vy)([t[0]],"e-disabled"),(0,i.iQ)([t[1],t[2]],"e-disabled"))}i.Pw.isDevice&&!e.element.parentElement.classList.contains(r.tG)&&this.popupModal(e.element.parentElement),this.parent.notify(o.qm,e)},e.prototype.dropDownClose=function(e){this.removePopupContainer(),this.parent.notify(o.jN,e)},e.prototype.removePopupContainer=function(){if(i.Pw.isDevice&&!(0,i.hX)(this.popupContainer)){var e=this.popupContainer.querySelector(".e-dropdown-popup.e-tbar-btn.e-control");e&&(this.popupContainer.parentNode.insertBefore(e,this.popupContainer.nextSibling),e.style.removeProperty("position"),(0,i.vy)([e],"e-popup-modal")),(0,i.Yo)(this.popupContainer),this.popupContainer=void 0}},e.prototype.renderToolbar=function(e){this.setPanel(e.target),this.renderPanel(),this.mode=e.overflowMode,e.rteToolbarObj.toolbarObj=new d.M({items:e.items,width:"100%",overflowMode:e.overflowMode,beforeCreate:this.toolbarBeforeCreate.bind(this),created:this.toolbarCreated.bind(this),clicked:this.toolbarClicked.bind(this),enablePersistence:e.enablePersistence,enableRtl:e.enableRtl}),e.rteToolbarObj.toolbarObj.isStringTemplate=!0,e.rteToolbarObj.toolbarObj.createElement=this.parent.createElement,e.rteToolbarObj.toolbarObj.appendTo(e.target)},e.prototype.renderDropDownButton=function(e){var t,n=this;e.element.classList.add(r.YW),t=e.cssClass+" "+r.bU+" "+r.$9,this.parent.inlineMode.enable&&i.Pw.isDevice&&(t=t+" "+r.fE);var a=this,s=new h.Q({items:e.items,iconCss:e.iconCss,cssClass:t,content:e.content,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,select:this.dropDownSelected.bind(this),beforeOpen:function(e){if(!a.parent.readonly&&a.parent.enabled){for(var t=0;t<e.element.childNodes.length;t++){var r=n.parent.createElement("div");r.innerHTML=s.content.trim(),""!==r.textContent.trim()&&e.element.childNodes[t].textContent.trim()===r.textContent.trim()?e.element.childNodes[t].classList.contains("e-active")||(0,i.iQ)([e.element.childNodes[t]],"e-active"):(0,i.vy)([e.element.childNodes[t]],"e-active")}a.parent.notify(o.zO,e)}else e.cancel=!0},close:this.dropDownClose.bind(this),open:this.dropDownOpen.bind(this),beforeItemRender:this.beforeDropDownItemRender.bind(this)});return s.isStringTemplate=!0,s.createElement=a.parent.createElement,s.appendTo(e.element),e.element.tabIndex=-1,document.getElementById(s.element.id+"-popup").setAttribute("aria-owns",this.parent.getID()),s},e.prototype.renderListDropDown=function(e){var t=this,n=r.bU+" "+r.$9+(this.parent.inlineMode?" "+r.fE:"");n+=" "+("NumberFormatList"===e.itemName?r.UK:r.nR);var i=t.parent.createElement("span",{className:r.$u}),a=t.parent.createElement("span",{className:e.cssClass});i.appendChild(a);var s=new h.Q({items:e.items,cssClass:n,content:e.content,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,select:this.dropDownSelected.bind(this),beforeOpen:function(e){if(!t.parent.readonly&&t.parent.enabled){var n=e.event?e.event.target:null;t.currentElement=s.element,t.currentDropdown=s,e.event&&"click"===e.event.type&&(n.classList.contains(r.$u)||n.parentElement.classList.contains(r.$u))?e.cancel=!0:t.parent.notify(o.zO,e)}else e.cancel=!0},close:this.dropDownClose.bind(this),open:this.dropDownOpen.bind(this),beforeItemRender:this.beforeDropDownItemRender.bind(this)});return s.isStringTemplate=!0,s.createElement=t.parent.createElement,s.appendTo(e.element),e.element.tabIndex=-1,document.getElementById(s.element.id+"-popup").setAttribute("aria-owns",this.parent.getID()),1===e.element.childElementCount&&s.element.insertBefore(i,s.element.querySelector(".e-caret")),e.element.tabIndex=-1,s.element.removeAttribute("type"),s},e.prototype.onPopupOverlay=function(e){(0,i.hX)(this.popupOverlay)||((0,i.kp)(this.popupOverlay,".e-popup-container").style.display="none",this.popupOverlay.style.display="none",(0,i.vy)([this.popupOverlay],"e-popup-overlay"))},e.prototype.setIsModel=function(e){(0,i.kp)(e,".e-popup-container")?(e.parentElement.style.display="flex",this.popupOverlay=e.nextElementSibling,this.popupOverlay.style.display="block",(0,i.iQ)([this.popupOverlay],"e-popup-overlay")):(this.popupContainer=this.parent.createElement("div",{className:"e-rte-modal-popup e-popup-container e-center"}),e.parentNode.insertBefore(this.popupContainer,e),this.popupContainer.appendChild(e),this.popupContainer.style.zIndex=e.style.zIndex,this.popupContainer.style.display="flex",e.style.position="relative",(0,i.iQ)([e],"e-popup-modal"),this.popupOverlay=this.parent.createElement("div",{className:"e-popup-overlay"}),this.popupOverlay.style.zIndex=(parseInt(e.style.zIndex,null)-1).toString(),this.popupOverlay.style.display="block",this.popupContainer.appendChild(this.popupOverlay),i.Jm.add(this.popupOverlay,"click touchmove",this.onPopupOverlay,this))},e.prototype.paletteSelection=function(e,t){var n=e.element.querySelector(".e-control.e-colorpicker"),o=[].slice.call((0,i.Ub)(".e-tile",n.parentElement));(0,i.vy)(o,"e-selected");var a=t.querySelector("."+r.bU).style.borderBottomColor;o.filter((function(e){e.style.backgroundColor===a&&(0,i.iQ)([e],"e-selected")}))},e.prototype.renderColorPickerDropDown=function(e,t,n,a){var l=this,d=this,p=r.bU+" "+r.$9+(this.parent.inlineMode?" "+r.fE:"");p+=" "+("backgroundcolor"===t?r.gd:r.zM);var u,m=d.parent.createElement("span",{className:r.zV}),g=d.parent.createElement("span",{className:e.cssClass}),f=(0,i.hX)(a)?d.parent.backgroundColor.default:a;g.style.borderBottomColor="backgroundcolor"===t?f:d.parent.fontColor.default,m.appendChild(g);var b=new h.Q({target:n.element.parentElement,cssClass:p,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,beforeOpen:function(t){if(!d.parent.readonly&&d.parent.enabled){var n=t.event?t.event.target:null;if(d.currentElement=b.element,d.currentDropdown=b,d.paletteSelection(t,d.currentElement),t.event&&"click"===t.event.type&&(n.classList.contains(r.zV)||n.parentElement.classList.contains(r.zV))){t.cancel=!0;var a=n.classList.contains(r.bU)?n.style.borderBottomColor:n.querySelector("."+r.bU).style.borderBottomColor;d.parent.notify(o.jN,{});var l=(u=d.parent.formatter.editorManager.nodeSelection.getRange(d.parent.contentModule.getDocument())).startContainer.parentNode;("TD"===u.startContainer.nodeName||"TH"===u.startContainer.nodeName||(0,i.kp)(u.startContainer.parentNode,"td,th")||d.parent.iframeSettings.enable&&!(0,s.nB)(l.ownerDocument.querySelector("body"),"e-lib"))&&u.collapsed&&"BackgroundColor"===e.subCommand?d.parent.notify(o.uc,{item:{command:e.command,subCommand:e.subCommand,value:a}}):d.parent.notify(o.Ie,{item:{command:e.command,subCommand:e.subCommand,value:a}})}else{var h=t.element.querySelector(".e-control.e-colorpicker"),p=(0,i.iE)(h,c.s);p.showButtons=!t.element.querySelector(".e-color-palette"),p.dataBind(),t.element.onclick=function(e){e.target.classList.contains("e-cancel")&&b.toggle()}}}else t.cancel=!0},open:function(e){var t;l.setColorPickerContentWidth(n);var o=e.element.querySelector(".e-control.e-colorpicker");(t=e.element.querySelector(".e-color-palette")?o.parentElement.querySelector(".e-palette"):o.parentElement.querySelector("e-handler"))&&t.focus(),i.Pw.isDevice&&l.popupModal(e.element.parentElement),l.pickerRefresh(e)},beforeClose:function(t){var n=t.event?t.event.target:null;if(t.event&&"click"===t.event.type&&(n.classList.contains(r.zV)||n.parentElement.classList.contains(r.zV))){var a=n.classList.contains(r.bU)?n.style.borderBottomColor:n.querySelector("."+r.bU).style.borderBottomColor;("TD"===(u=d.parent.formatter.editorManager.nodeSelection.getRange(d.parent.contentModule.getDocument())).startContainer.nodeName||"TH"===u.startContainer.nodeName||(0,i.kp)(u.startContainer.parentNode,"td,th"))&&u.collapsed?d.parent.notify(o.uc,{item:{command:e.command,subCommand:e.subCommand,value:a}}):d.parent.notify(o.Ie,{item:{command:e.command,subCommand:e.subCommand,value:a}})}else;},close:function(e){d.parent.notify(o.jN,{});var t=(0,i.kp)(e.element.parentElement,".e-popup-container");if(t&&(t.style.display="none",t.lastElementChild.style.display="none",(0,i.vy)([t.lastElementChild],"e-popup-overlay")),i.Pw.isDevice&&!(0,i.hX)(t)){var n=t.querySelector(".e-dropdown-popup.e-tbar-btn.e-control");n&&(t.parentNode.insertBefore(n,t.nextSibling),n.style.removeProperty("position"),(0,i.vy)([n],"e-popup-modal")),(0,i.Yo)(t),d.popupContainer=void 0}}});return b.isStringTemplate=!0,b.createElement=d.parent.createElement,e.element.setAttribute("role","button"),b.appendTo(e.element),document.getElementById(b.element.id+"-popup").setAttribute("aria-owns",this.parent.getID()),b.element.insertBefore(m,b.element.querySelector(".e-caret")),e.element.tabIndex=-1,b.element.removeAttribute("type"),b.element.onmousedown=function(){d.parent.notify(o.qm,{})},b.element.onkeydown=function(){d.parent.notify(o.qm,{})},b},e.prototype.pickerRefresh=function(e){if("Picker"===this.parent.backgroundColor.mode){var t=e.element.parentElement;t.style.width=(t.offsetWidth+5).toString()+"px",(0,i.iE)(t,p.zD).refreshPosition(t),t.style.width=(t.offsetWidth-5).toString()+"px"}},e.prototype.popupModal=function(e){var t=(0,i.iE)(e,p.zD);t.relateTo=document.body,t.position={X:0,Y:0},t.targetType="container",t.collision={X:"fit",Y:"fit"},t.offsetY=4,t.dataBind(),this.setIsModel(e)},e.prototype.setColorPickerContentWidth=function(e){var t=e.element.nextSibling;if("0px"===t.style.width){t.style.width="";var n=parseInt(getComputedStyle(t).borderBottomWidth,10);t.style.width=(0,i.IV)(t.children[0].offsetWidth+n+n)}},e.prototype.renderColorPicker=function(e,t){var n=this,a=new c.s({enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,inline:!0,value:"#fff",created:function(){var e="backgroundcolor"===t?n.parent.backgroundColor.default:n.parent.fontColor.default;a.setProperties({value:e})},mode:"backgroundcolor"===t?n.parent.backgroundColor.mode:n.parent.fontColor.mode,modeSwitcher:"backgroundcolor"===t?n.parent.backgroundColor.modeSwitcher:n.parent.fontColor.modeSwitcher,beforeTileRender:function(e){e.element.classList.add(r.b8),e.element.classList.add(r.qg),""===e.value&&e.element.classList.add(r.UF)},change:function(t){var a=t.currentValue.rgba;t.item={command:e.command,subCommand:e.subCommand,value:a},n.parent.notify(o.jN,{}),n.currentElement.querySelector("."+r.bU).style.borderBottomColor=a;var s=n.parent.formatter.editorManager.nodeSelection.getRange(n.parent.contentModule.getDocument());("TD"===s.startContainer.nodeName||"TH"===s.startContainer.nodeName||"BODY"===s.startContainer.nodeName||(0,i.kp)(s.startContainer.parentNode,"td,th"))&&s.collapsed&&"BackgroundColor"===e.subCommand?n.parent.notify(o.uc,t):n.parent.notify(o.Ie,t),n.currentDropdown.toggle()},beforeModeSwitch:function(e){""===a.value&&a.setProperties({value:"Picker"===e.mode?"#008000ff":""},!0),a.showButtons="Palette"!==e.mode}});return a.isStringTemplate=!0,a.columns="backgroundcolor"===t?this.parent.backgroundColor.columns:this.parent.fontColor.columns,a.presetColors="backgroundcolor"===t?this.parent.backgroundColor.colorCode:this.parent.fontColor.colorCode,a.cssClass="backgroundcolor"===t?r.p1:r.eS,a.createElement=this.parent.createElement,a.appendTo(document.getElementById(e.target)),a},e.prototype.renderPanel=function(){this.getPanel().classList.add(r.LK)},e.prototype.getPanel=function(){return this.toolbarPanel},e.prototype.setPanel=function(e){this.toolbarPanel=e},e}(),m=n(377),g=n(2611),f=n(6545),b=n(3573),v=function(){function e(e){this.parent=e,this.addEventListener(),this.serviceLocator=new f.q,this.serviceLocator.register("rendererFactory",new b.O)}return e.prototype.addEventListener=function(){this.parent.on(o.EJ,this.toolbarClick,this),this.parent.on(o.uY,this.dropDownSelect,this),this.parent.on(o.Ie,this.renderSelection,this),this.parent.on(o.zr,this.removeEventListener,this)},e.prototype.toolbarClick=function(e){if(!(0,i.hX)(e.item)){if(!(0,i.hX)(e.item.controlParent)){var t=e.item.controlParent.activeEle;t&&(t.tabIndex=-1)}"NumberFormatList"!==e.item.command&&"BulletFormatList"!==e.item.command||(e.originalEvent.target.classList.contains("e-order-list")||e.originalEvent.target.classList.contains("e-unorder-list"))&&(e.item.command="Lists",e.item.subCommand="NumberFormatList"===e.item.subCommand?"OL":"UL"),"Lists"===e.item.command&&e.originalEvent.target.classList.contains("e-caret")&&(e.originalEvent.target.parentElement.classList.contains("e-rte-bulletformatlist-dropdown")||e.originalEvent.target.parentElement.classList.contains("e-rte-numberformatlist-dropdown"))&&(e.item.command=e.item.subCommand=null),this.parent.notify(o.dU,e),this.parent.notify(o.T5,e)}},e.prototype.dropDownSelect=function(e){if(this.parent.notify(o.jN,{}),!document.body.contains(document.body.querySelector(".e-rte-quick-toolbar"))||!e.item||"Images"!==e.item.command&&"Display"!==e.item.command&&"Table"!==e.item.command){var t=e.item.controlParent&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.tableQTBar&&this.parent.quickToolbarModule.tableQTBar.element.contains(e.item.controlParent.element)?"Table":null;if("Lists"===e.item.command){var n={listStyle:e.item.value,listImage:e.item.listImage,type:e.item.subCommand};this.parent.formatter.process(this.parent,e,e.originalEvent,n)}else this.parent.formatter.process(this.parent,e,e.originalEvent,t)}this.parent.notify(o.qm,{})},e.prototype.renderSelection=function(e){this.parent.notify(o.jN,{}),this.parent.formatter.process(this.parent,e,e.originalEvent,null),this.parent.notify(o.qm,{})},e.prototype.removeEventListener=function(){this.parent.off(o.EJ,this.toolbarClick),this.parent.off(o.uY,this.dropDownSelect),this.parent.off(o.Ie,this.renderSelection),this.parent.off(o.zr,this.removeEventListener)},e}(),y=function(){function e(e,t){this.parent=e,this.isToolbar=!1,this.locator=t,this.isTransformChild=!1,this.renderFactory=this.locator.getService("rendererFactory"),l.$w(this.parent),(0,s.v9)(this.parent),this.renderFactory.addRenderer(a.nJ.Toolbar,new u(this.parent)),this.toolbarRenderer=this.renderFactory.getRenderer(a.nJ.Toolbar),this.baseToolbar=new m.b(this.parent,this.locator),this.addEventListener(),this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?(0,i.X$)(this.tools,l.Yl,(0,s.mm)(this.parent.toolbarSettings.itemConfigs),!0):this.tools=l.Yl}return e.prototype.initializeInstance=function(){this.contentRenderer=this.renderFactory.getRenderer(a.nJ.Content),this.editableElement=this.contentRenderer.getEditPanel(),this.editPanel=this.contentRenderer.getPanel()},e.prototype.toolbarBindEvent=function(){this.parent.inlineMode.enable||(this.keyBoardModule=new i.j9(this.getToolbarElement(),{keyAction:this.toolBarKeyDown.bind(this),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"}))},e.prototype.toolBarKeyDown=function(e){if("escape"===e.action)this.parent.contentModule.getEditPanel().focus()},e.prototype.createToolbarElement=function(){this.tbElement=this.parent.createElement("div",{id:this.parent.getID()+"_toolbar"}),!i.Pw.isDevice&&this.parent.inlineMode.enable&&(0,s.wU)()||(this.parent.toolbarSettings.enableFloating&&!this.parent.inlineMode.enable?(this.tbWrapper=this.parent.createElement("div",{id:this.parent.getID()+"_toolbar_wrapper",innerHTML:this.tbElement.outerHTML,className:r.p$}),this.tbElement=this.tbWrapper.firstElementChild,this.parent.element.insertBefore(this.tbWrapper,this.editPanel)):this.parent.element.insertBefore(this.tbElement,this.editPanel))},e.prototype.getToolbarMode=function(){var e;switch(this.parent.toolbarSettings.type){case a.Yv.Expand:e="Extended";break;case a.Yv.Scrollable:e="Scrollable";break;default:e="MultiRow"}return(0,s.wU)()&&this.parent.toolbarSettings.type===a.Yv.Expand&&(e=a.Yv.Scrollable),e},e.prototype.checkToolbarResponsive=function(e){return!(!i.Pw.isDevice||(0,s.wU)())&&(t=this.parent.toolbarSettings.type===a.Yv.Expand?a.Yv.MultiRow:this.parent.toolbarSettings.type,this.baseToolbar.render({container:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items,mode:t,target:e}),this.parent.toolbarSettings.type===a.Yv.Expand&&((0,i.iQ)([e],["e-rte-tb-mobile"]),this.parent.inlineMode.enable?this.addFixedTBarClass():(0,i.iQ)([e],[r.n1])),this.wireEvents(),this.dropDownModule.renderDropDowns({container:e,containerType:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items}),this.parent.notify(o.Iw,{container:this.tbElement,containerType:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items}),!0);var t},e.prototype.checkIsTransformChild=function(){this.isTransformChild=!1;for(var e=(0,i.Ub)('[style*="transform"]',document),t=0;t<e.length;t++)if(!(0,i.hX)(e[t].contains)&&e[t].contains(this.parent.element)){this.isTransformChild=!0;break}},e.prototype.toggleFloatClass=function(e){var t,n,o=!1,a=!1,s=this.parent.floatingToolbarOffset;e&&this.parent.iframeSettings.enable&&this.parent.inputElement.ownerDocument===e.target?n=e.target.body:e&&e.target!==document?n=e.target:(o=!0,n=document.body);var l=this.getToolbarHeight()+this.getExpandTBarPopHeight();if(this.isTransformChild){t=0;var d=0,h=this.parent.element.offsetHeight;if(o){var p=window.getComputedStyle(n);d=parseFloat(p.marginTop.split("px")[0])+parseFloat(p.paddingTop.split("px")[0])}var c=this.parent.element.getBoundingClientRect().top,u=i.Pw.isMSPointer&&o?window.pageYOffset:n.parentElement.scrollTop,m=n.getBoundingClientRect(),g=o?m.top+u:m.top;c>g+s||c<-h||c<0&&!(c-(o?0:g)+h>l+s)?(a=!1,(0,i.vy)([this.tbElement],[r.gT])):c<g+s&&(t=c<0?-c+g:g-c,t=o?t-d:t,(0,i.iQ)([this.tbElement],[r.gT]),a=!0)}else{var f=this.parent.element.getBoundingClientRect();if(window.innerHeight<f.top)return;t=e&&e.target!==document?n.getBoundingClientRect().top:0,f.bottom<s+l+t||f.bottom<0||f.top>s+t?a=!1:f.top<s&&(a=!0)}a?((0,i.iQ)([this.tbElement],[r.Ps]),(0,i.sN)(this.tbElement,{width:this.parent.element.offsetWidth+"px",top:s+t+"px"})):((0,i.vy)([this.tbElement],[r.Ps]),(0,i.sN)(this.tbElement,{top:"0px",width:"100%"}))},e.prototype.renderToolbar=function(){if(this.initializeInstance(),this.createToolbarElement(),!this.checkToolbarResponsive(this.tbElement)){this.parent.inlineMode.enable?this.parent.notify(o.RJ,{}):(this.baseToolbar.render({container:"toolbar",items:this.parent.toolbarSettings.items,mode:this.getToolbarMode(),target:this.tbElement}),this.parent.inlineMode.enable||(this.parent.toolbarSettings.enableFloating&&(this.checkIsTransformChild(),this.toggleFloatClass()),(0,i.iQ)([this.parent.element],[r.wG]),this.parent.toolbarSettings.type===a.Yv.Expand&&(0,i.iQ)([this.parent.element],[r.VE]))),this.wireEvents(),this.parent.inlineMode.enable&&!(0,s.wU)()&&this.addFixedTBarClass(),this.parent.inlineMode.enable||(this.dropDownModule.renderDropDowns({container:this.tbElement,containerType:"toolbar",items:this.parent.toolbarSettings.items}),this.parent.notify(o.Iw,{container:this.tbElement,containerType:"toolbar",items:this.parent.toolbarSettings.items}),this.refreshToolbarOverflow());var e=this.parent.element.querySelector(".e-rte-srctextarea"),t=this.parent.element.querySelector(".e-source-content");(!this.parent.iframeSettings.enable&&!(0,i.hX)(e)&&"block"===e.style.display||this.parent.iframeSettings.enable&&!(0,i.hX)(t)&&"block"===t.style.display)&&(this.parent.notify(o.o7,{targetItem:"SourceCode",updateItem:"Preview",baseToolbar:this.parent.getBaseToolbarObject()}),this.parent.disableToolbarItem(this.parent.toolbarSettings.items))}},e.prototype.addFixedTBarClass=function(){(0,i.iQ)([this.tbElement],[r.Z3])},e.prototype.removeFixedTBarClass=function(){(0,i.vy)([this.tbElement],[r.Z3])},e.prototype.showFixedTBar=function(){(0,i.iQ)([this.tbElement],[r.PH]),i.Pw.isIos&&(0,i.iQ)([this.tbElement],[r.ec])},e.prototype.hideFixedTBar=function(){this.isToolbar?this.isToolbar=!1:(0,i.vy)([this.tbElement],[r.PH,r.ec])},e.prototype.updateItem=function(e){var t=this.tools[e.updateItem.toLocaleLowerCase()],n=this.tools[e.targetItem.toLocaleLowerCase()],o=(0,s.E2)((0,s.X_)(n.subCommand),e.baseToolbar.toolbarObj.items)[0];if((0,i.hX)(o))this.addTBarItem(e,0);else{var r=this.parent.inlineMode.enable?"_quick_":"_toolbar_";e.baseToolbar.toolbarObj.items[o].id=this.parent.getID()+r+t.id,e.baseToolbar.toolbarObj.items[o].prefixIcon=t.icon,e.baseToolbar.toolbarObj.items[o].tooltipText=t.tooltip,e.baseToolbar.toolbarObj.items[o].subCommand=t.subCommand,e.baseToolbar.toolbarObj.dataBind()}},e.prototype.updateToolbarStatus=function(e){if(this.tbElement&&(!this.parent.inlineMode.enable||!(0,s.wU)()&&i.Pw.isDevice)){var t={args:e,dropDownModule:this.dropDownModule,parent:this.parent,tbElements:(0,i.Ub)("."+r.um,this.tbElement),tbItems:this.baseToolbar.toolbarObj.items};(0,s.Qx)(t,!!this.parent.inlineMode.enable,this.parent)}},e.prototype.fullScreen=function(e){this.parent.fullScreenModule.showFullScreen(e)},e.prototype.hideScreen=function(e){this.parent.fullScreenModule.hideFullScreen(e)},e.prototype.getBaseToolbar=function(){return this.baseToolbar},e.prototype.addTBarItem=function(e,t){e.baseToolbar.toolbarObj.addItems([e.baseToolbar.getObject(e.updateItem,"toolbar")],t)},e.prototype.enableTBarItems=function(e,t,n,o){var a=(0,s.E2)((0,s.X_)(t),e.toolbarObj.items);this.tbItems=(0,i.Ub)("."+r.um,e.toolbarObj.element);for(var l=0;l<a.length;l++){var d=this.tbItems[a[l]];d&&e.toolbarObj.enableItems(d,n)}(0,i.Lt)(".e-rte-srctextarea",this.parent.element)||o||(0,s.kB)(e,this.parent.formatter.editorManager.undoRedoManager.getUndoStatus())},e.prototype.removeTBarItems=function(e){(0,i.hX)(this.baseToolbar.toolbarObj)&&(this.baseToolbar=this.parent.getBaseToolbarObject());var t=(0,s.E2)((0,s.X_)(e),this.baseToolbar.toolbarObj.items);this.tbItems=this.parent.inlineMode.enable?(0,i.Ub)("."+r.um,this.baseToolbar.toolbarObj.element):(0,i.Ub)("."+r.um,this.parent.element);for(var n=0;n<t.length;n++)this.baseToolbar.toolbarObj.removeItems(this.tbItems[t[n]])},e.prototype.getExpandTBarPopHeight=function(){var e=0;if(this.parent.toolbarSettings.type===a.Yv.Expand&&this.tbElement.classList.contains("e-extended-toolbar")){var t=(0,i.Lt)(".e-toolbar-extended",this.tbElement);t&&this.tbElement.classList.contains("e-expand-open")||t&&t.classList.contains("e-popup-open")?((0,i.iQ)([t],[r.k]),e+=t.offsetHeight,(0,i.vy)([t],[r.k])):(0,i.vy)([this.tbElement],[r.P5])}return e},e.prototype.getToolbarHeight=function(){return this.tbElement.offsetHeight},e.prototype.getToolbarElement=function(){return(0,i.Lt)("."+r.LK,this.parent.element)},e.prototype.refreshToolbarOverflow=function(){this.baseToolbar.toolbarObj.refreshOverflow()},e.prototype.isToolbarDestroyed=function(){return this.baseToolbar.toolbarObj&&!this.baseToolbar.toolbarObj.isDestroyed},e.prototype.destroyToolbar=function(){if(this.isToolbarDestroyed()){this.parent.unWireScrollElementsEvents(),this.unWireEvents(),this.parent.notify(o.A_,{}),this.dropDownModule.destroyDropDowns(),this.baseToolbar.toolbarObj.destroy(),this.removeEventListener(),(0,i.vy)([this.parent.element],[r.wG]),(0,i.vy)([this.parent.element],[r.VE]);var e=(0,i.Lt)("."+r.p$,this.parent.element),t=(0,i.Lt)("."+r.LK,this.parent.element);(0,i.hX)(e)?(0,i.hX)(t)||(0,i.Yo)(t):(0,i.Yo)(e)}},e.prototype.destroy=function(){this.isToolbarDestroyed()&&(this.destroyToolbar(),this.keyBoardModule&&this.keyBoardModule.destroy())},e.prototype.scrollHandler=function(e){this.parent.inlineMode.enable||this.parent.toolbarSettings.enableFloating&&this.getDOMVisibility(this.tbElement)&&this.toggleFloatClass(e.args)},e.prototype.getDOMVisibility=function(e){return!(!e.offsetParent&&0===e.offsetWidth&&0===e.offsetHeight)},e.prototype.mouseDownHandler=function(){i.Pw.isDevice&&this.parent.inlineMode.enable&&!(0,s.wU)()&&this.showFixedTBar()},e.prototype.focusChangeHandler=function(){i.Pw.isDevice&&this.parent.inlineMode.enable&&!(0,s.wU)()&&(this.isToolbar=!1,this.hideFixedTBar())},e.prototype.dropDownBeforeOpenHandler=function(){this.isToolbar=!0},e.prototype.tbFocusHandler=function(e){var t=document.activeElement,n=(0,i.kp)(t,".e-rte-toolbar");if(t===this.parent.getToolbarElement()||n===this.parent.getToolbarElement())for(var o=this.parent.getToolbarElement().querySelectorAll(".e-expended-nav"),r=0;r<o.length;r++)(0,i.hX)(this.parent.getToolbarElement().querySelector(".e-insert-table-btn"))?o[r].setAttribute("tabindex","0"):o[r].setAttribute("tabindex","1")},e.prototype.tbKeydownHandler=function(e){(e.target.classList.contains("e-dropdown-btn")||e.target.getAttribute("id")===this.parent.getID()+"_toolbar_CreateTable")&&e.target.setAttribute("tabindex","0")},e.prototype.toolbarClickHandler=function(e){var t=(0,i.kp)(e.originalEvent.target,".e-hor-nav");t&&this.parent.toolbarSettings.type===a.Yv.Expand&&!(0,i.hX)(t)?t.classList.contains("e-nav-active")?((0,i.iQ)([this.tbElement],[r.P5]),this.parent.setContentHeight("toolbar",!0)):((0,i.vy)([this.tbElement],[r.P5]),this.parent.setContentHeight("toolbar",!1)):(i.Pw.isDevice||this.parent.inlineMode.enable)&&(this.isToolbar=!0),(0,i.hX)(t)&&this.parent.toolbarSettings.type===a.Yv.Expand&&(0,i.vy)([this.tbElement],[r.P5])},e.prototype.wireEvents=function(){this.parent.inlineMode.enable&&(0,s.wU)()||(i.Jm.add(this.tbElement,"focusin",this.tbFocusHandler,this),i.Jm.add(this.tbElement,"keydown",this.tbKeydownHandler,this))},e.prototype.unWireEvents=function(){i.Jm.remove(this.tbElement,"focusin",this.tbFocusHandler),i.Jm.remove(this.tbElement,"keydown",this.tbKeydownHandler)},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.dropDownModule=new g.V(this.parent,this.locator),this.toolbarActionModule=new v(this.parent),this.parent.on(o.qO,this.renderToolbar,this),this.parent.on(o.W2,this.scrollHandler,this),this.parent.on(o.i2,this.toolbarBindEvent,this),this.parent.on(o.tt,this.updateToolbarStatus,this),this.parent.on(o.Ay,this.onPropertyChanged,this),this.parent.on(o.bh,this.onRefresh,this),this.parent.on(o.zr,this.destroy,this),this.parent.on(o.Do,this.fullScreen,this),this.parent.on(o.gi,this.hideScreen,this),this.parent.on(o.o7,this.updateItem,this),this.parent.on(o.zO,this.dropDownBeforeOpenHandler,this),this.parent.on(o.ju,this.parent.setContentHeight,this.parent),this.parent.on(o.T0,this.focusChangeHandler,this),this.parent.on(o.cT,this.mouseDownHandler,this),this.parent.on(o.y,this.mouseDownHandler,this),this.parent.inlineMode.enable||(0,s.wU)()||this.parent.on(o.EJ,this.toolbarClickHandler,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(o.qO,this.renderToolbar),this.parent.off(o.W2,this.scrollHandler),this.parent.off(o.i2,this.toolbarBindEvent),this.parent.off(o.tt,this.updateToolbarStatus),this.parent.off(o.Ay,this.onPropertyChanged),this.parent.off(o.bh,this.onRefresh),this.parent.off(o.zr,this.destroy),this.parent.off(o.Do,this.parent.fullScreenModule.showFullScreen),this.parent.off(o.gi,this.parent.fullScreenModule.hideFullScreen),this.parent.off(o.o7,this.updateItem),this.parent.off(o.zO,this.dropDownBeforeOpenHandler),this.parent.off(o.ju,this.parent.setContentHeight),this.parent.off(o.T0,this.focusChangeHandler),this.parent.off(o.cT,this.mouseDownHandler),this.parent.off(o.y,this.mouseDownHandler),this.parent.inlineMode.enable||(0,s.wU)()||this.parent.off(o.EJ,this.toolbarClickHandler))},e.prototype.onRefresh=function(){this.refreshToolbarOverflow(),this.parent.setContentHeight("",!0)},e.prototype.onPropertyChanged=function(e){if(!(0,i.hX)(e.newProp.inlineMode))for(var t=0,n=Object.keys(e.newProp.inlineMode);t<n.length;t++){if("enable"===n[t])this.refreshToolbar()}e.module===this.getModuleName()&&this.refreshToolbar()},e.prototype.refreshToolbar=function(){(0,i.hX)(this.baseToolbar.toolbarObj)&&(this.baseToolbar=this.parent.getBaseToolbarObject());var e=(0,i.Lt)("."+r.p$,this.parent.element);((0,i.Lt)("."+r.LK,this.parent.element)||e)&&this.destroyToolbar(),this.parent.toolbarSettings.enable&&(this.addEventListener(),this.renderToolbar(),this.parent.wireScrollElementsEvents(),(0,i.Lt)(".e-rte-srctextarea",this.parent.element)||(0,s.kB)(this.baseToolbar,this.parent.formatter.editorManager.undoRedoManager.getUndoStatus()),this.parent.notify(o.Ei,{}))},e.prototype.getModuleName=function(){return"toolbar"},e}()},5624:(e,t,n)=>{n.d(t,{$9:()=>J,$u:()=>K,Bj:()=>v,C4:()=>me,E1:()=>w,ED:()=>Se,Eg:()=>be,Fb:()=>ve,Fy:()=>s,Gp:()=>pe,I6:()=>U,JN:()=>ee,Jt:()=>L,LK:()=>l,LP:()=>z,LT:()=>C,Mg:()=>we,OP:()=>P,Op:()=>F,P5:()=>W,PH:()=>M,Ps:()=>h,Qb:()=>Ne,Qr:()=>q,UF:()=>ke,UK:()=>G,VE:()=>u,Vg:()=>Z,WX:()=>I,Wl:()=>m,Y4:()=>g,YP:()=>he,YW:()=>N,Z3:()=>d,Z5:()=>f,ZL:()=>a,_L:()=>H,a6:()=>r,af:()=>Y,ag:()=>Le,ax:()=>Q,b8:()=>se,bP:()=>i,bU:()=>_,cC:()=>k,cd:()=>ye,cl:()=>ge,eB:()=>fe,eS:()=>le,ec:()=>V,eh:()=>j,ew:()=>Ee,fE:()=>E,fG:()=>B,gT:()=>p,gd:()=>ae,gi:()=>o,hg:()=>c,id:()=>X,jw:()=>ne,k:()=>O,mE:()=>Ce,mY:()=>ie,n1:()=>b,nR:()=>$,nw:()=>ue,p$:()=>x,p1:()=>de,p2:()=>te,qg:()=>Te,sB:()=>A,tG:()=>y,tO:()=>S,uC:()=>R,um:()=>D,wG:()=>De,x7:()=>ce,yo:()=>T,zM:()=>re,zV:()=>oe});var i="e-richtexteditor",o="e-rtl",r="e-disabled",a="rte-iframe-script-sheet",s="rte-iframe-style-sheet",l="e-rte-toolbar",d="e-rte-tb-fixed",h="e-rte-tb-float",p="e-rte-tb-abs-float",c="e-rte-inline",u="e-rte-tb-expand",m="e-rte-full-screen",g="e-rte-quick-toolbar",f="e-rte-pop",b="e-tb-static",v="e-rte-quick-popup",y="e-quick-dropdown",C="e-rte-image-popup",S="e-rte-inline-popup",E="e-rte-inline-dropdown",w="e-rte-dropdown-popup",T="e-rte-dropdown-icons",k="e-rte-dropdown-items",N="e-rte-dropdown-btn",L="e-rte-content",D="e-toolbar-item",x="e-toolbar-wrapper",M="e-show",A="e-hide",O="e-visible",R="e-focused",I="e-remove-white-space",B="e-imgright",P="e-imgleft",F="e-imgcenter",H="e-imgbreak",X="e-img-caption",q="e-rte-img-caption",z="e-caption-inline",j="e-imginline",U="e-icons",Q="e-active",W="e-expand-open",_="e-rte-elements",J="e-tbar-btn",Y="e-rte-horizontal-separator",V="e-tbar-ios-fixed",K="e-rte-list-primary-content",G="e-rte-numberformatlist-dropdown",$="e-rte-bulletformatlist-dropdown",Z="e-formats-tbar-btn",ee="e-font-name-tbar-btn",te="e-font-size-tbar-btn",ne="e-rte-fontcolor-element",ie="e-rte-backgroundcolor-element",oe="e-rte-color-content",re="e-rte-fontcolor-dropdown",ae="e-rte-backgroundcolor-dropdown",se="e-rte-square-palette",le="e-rte-fontcolor-colorpicker",de="e-rte-backgroundcolor-colorpicker",he="e-rte-readonly",pe="e-rte-hidden",ce="e-resize-handle",ue="e-rte-image",me="e-resize",ge="e-img-focus",fe="e-rte-drag-image",be="e-rte-upload-popup",ve="e-popup-open",ye="e-img-resize",Ce="e-droparea",Se="e-img-inner",Ee="e-upload-files",we="e-rte-dialog-upload",Te="e-custom-tile",ke="e-nocolor-item",Ne="e-rte-table",Le="e-rte-fixed-tb-expand",De="e-rte-toolbar-enabled"},5290:(e,t,n)=>{n.d(t,{AE:()=>je,A_:()=>b,Ay:()=>v,Ck:()=>B,D5:()=>I,Do:()=>T,Ds:()=>Je,EJ:()=>d,EP:()=>xe,EV:()=>R,Ei:()=>Qe,Fe:()=>H,Hh:()=>i,IH:()=>Ve,Ie:()=>le,Iw:()=>m,JY:()=>Ne,Je:()=>S,KK:()=>s,Ku:()=>Y,L5:()=>A,LL:()=>y,L_:()=>Oe,Lv:()=>G,N$:()=>ce,NM:()=>Ge,Ox:()=>qe,Pl:()=>Re,QH:()=>Se,QL:()=>L,R9:()=>V,RJ:()=>me,RW:()=>Fe,Ry:()=>Pe,S3:()=>W,S7:()=>fe,T0:()=>he,T5:()=>f,U9:()=>ne,Ub:()=>pe,Ux:()=>E,V4:()=>U,Vd:()=>se,Vq:()=>J,Vx:()=>h,W2:()=>ae,WM:()=>_e,X0:()=>o,X5:()=>K,XY:()=>ke,XZ:()=>Ce,Z2:()=>z,ZR:()=>be,_D:()=>D,a7:()=>r,az:()=>Ie,bh:()=>p,bv:()=>F,cT:()=>ie,dJ:()=>M,dU:()=>g,dx:()=>ve,e4:()=>We,eY:()=>X,e_:()=>_,ex:()=>Le,gi:()=>k,gv:()=>He,hM:()=>Xe,hY:()=>Ee,hr:()=>w,i2:()=>u,jD:()=>Ye,jN:()=>ee,ju:()=>te,ls:()=>ye,mB:()=>Be,no:()=>ue,o7:()=>j,oc:()=>Te,oh:()=>ge,ot:()=>re,qO:()=>a,qm:()=>Z,rU:()=>De,rx:()=>ze,s9:()=>Ke,tP:()=>O,tb:()=>x,tk:()=>Ae,tn:()=>we,tq:()=>Q,tr:()=>Me,tt:()=>c,u2:()=>C,uY:()=>N,uc:()=>de,wn:()=>q,y:()=>oe,yL:()=>P,yr:()=>Ue,zO:()=>$,zr:()=>l});var i="load",o="initial-load",r="content-changed",a="initial-end",s="iframe-click",l="destroy",d="toolbarClick",h="toolbar-refresh",p="refresh-begin",c="toolbar-updated",u="bind-on-end",m="render-color-picker",g="html-toolbar-click",f="markdown-toolbar-click",b="destroy-color-picker",v="model-changed",y="keyUp",C="keyDown",S="mouseUp",E="toolbarCreated",w="toolbarRenderComplete",T="enableFullScreen",k="disableFullScreen",N="dropDownSelect",L="beforeDropDownItemRender",D="execCommandCallBack",x="image-toolbar-action",M="link-toolbar-action",A="resize",O="resizeStart",R="resizing",I="resizeStop",B="insertLink",P="unLink",F="editLink",H="openLink",X="actionBegin",q="actionComplete",z="updatedToolbarStatus",j="updateToolbarItem",U="insertImage",Q="insertCompleted",W="insertImgLink",_="imgAltText",J="delete",Y="caption",V="imageSize",K="sourceCode",G="updateSource",$="beforeDropDownOpen",Z="selection-save",ee="selection-restore",te="expandPopupClick",ne="count",ie="mouseDown",oe="sourceCodeMouseDown",re="editAreaClick",ae="scroll",se="contentscroll",le="colorPickerChanged",de="tableColorPickerChanged",he="focusChange",pe="selectAll",ce="selectRange",ue="getSelectedHtml",me="renderInlineToolbar",ge="paste-content",fe="rtl-mode",be="createTable",ve="docClick",ye="table-toolbar-action",Ce="checkUndoStack",Se="readOnlyMode",Ee="pasteClean",we="enterHandler",Te="beforeDialogOpen",ke="clearDialogObj",Ne="dialogOpen",Le="beforeDialogClose",De="dialogClose",xe="beforeQuickToolbarOpen",Me="quickToolbarOpen",Ae="quickToolbarClose",Oe="imageSelected",Re="imageUploading",Ie="imageUploadSuccess",Be="imageUploadFailed",Pe="imageRemoving",Fe="afterImageDelete",He="drop",Xe="xhtmlValidation",qe="beforeImageUpload",ze="resizeInitialized",je="renderFileManager",Ue="beforeImageDrop",Qe="dynamicModule",We="updateTbItemsStatus",_e="showLinkDialog",Je="closeLinkDialog",Ye="showImageDialog",Ve="closeImageDialog",Ke="showTableDialog",Ge="closeTableDialog"},1411:(e,t,n)=>{var i,o,r;n.d(t,{Yv:()=>o,hs:()=>r,nJ:()=>i}),function(e){e[e.Toolbar=0]="Toolbar",e[e.Content=1]="Content",e[e.Popup=2]="Popup",e[e.LinkToolbar=3]="LinkToolbar",e[e.TextToolbar=4]="TextToolbar",e[e.ImageToolbar=5]="ImageToolbar",e[e.InlineToolbar=6]="InlineToolbar",e[e.TableToolbar=7]="TableToolbar"}(i||(i={})),function(e){e.Expand="Expand",e.MultiRow="MultiRow",e.Scrollable="Scrollable"}(o||(o={})),function(e){e.InsertLink="InsertLink",e.InsertImage="InsertImage",e.InsertTable="InsertTable"}(r||(r={}))},134:(e,t,n)=>{n.d(t,{Bu:()=>N,D4:()=>D,Dx:()=>d,E2:()=>v,H3:()=>u,Jz:()=>L,Pt:()=>C,Qx:()=>f,RE:()=>g,X_:()=>b,ZC:()=>S,Zl:()=>p,kA:()=>m,kB:()=>y,kf:()=>T,mm:()=>w,mr:()=>x,nB:()=>h,v9:()=>O,wU:()=>c,yN:()=>M,zb:()=>E});var i=n(8452),o=n(5624),r=n(1011),a=n(8237),s=["Undo","Redo"],l=["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","font","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","strong","strike","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"];function d(e,t){var n=-1;return t.some((function(t,i){return"string"===typeof t&&e===t.toLocaleLowerCase()&&(n=i,!0)})),n}function h(e,t){var n=!1;return e.classList.contains(t)&&(n=!0),n}function p(e,t,n,o){for(var r,a,s=0;s<e.length;s++){if("value"===n&&e[s].value.toLocaleLowerCase()===t.toLocaleLowerCase()){r=e[s];break}if("text"===n&&e[s].text.toLocaleLowerCase()===t.toLocaleLowerCase()){r=e[s];break}if("subCommand"===n&&e[s].subCommand.toLocaleLowerCase()===t.toLocaleLowerCase()){r=e[s];break}}if(!(0,i.hX)(r))switch(o){case"text":a=r.text;break;case"value":a=r.value;break;case"iconCss":a=r.iconCss}return a}function c(){var e=!1;return i.Pw.isDevice&&i.Pw.isIos&&(e=!0),e}function u(e){return(0,i.hX)(e)?"":e}function m(e,t,n){return n?window.pageYOffset+t.getBoundingClientRect().top+e.clientY:e.pageY}function g(e,t){var n=t.getService("rteLocale"),i=a.MQ[e];return n.getConstant(i)}function f(e,t,n){O(n);for(var a=e.dropDownModule,s=e.args,l=0,h=Object.keys(e.args);l<h.length;l++)for(var c=h[l],m=0;m<e.tbItems.length;m++){var g=e.tbItems[m].subCommand,f=g&&g.toLocaleLowerCase();if(g&&f===c||"UL"===g&&"unorderedlist"===c||"OL"===g&&"orderedlist"===c||"pre"===f&&"insertcode"===c)if("boolean"===typeof s[c])!0===s[c]?(0,i.iQ)([e.tbElements[m]],[o.ax]):(0,i.vy)([e.tbElements[m]],[o.ax]);else if(("string"===typeof s[c]||null===s[c])&&d(c,e.parent.toolbarSettings.items)>-1){var b=s[c]?s[c]:"",v="";switch(c){case"formats":if((0,i.hX)(a.formatDropDown)||t||!(0,i.hX)(a.formatDropDown)&&a.formatDropDown.isDestroyed)break;var y=e.parent.format.types,C=(0,i.hX)(e.parent.format.default)?y[0].text:e.parent.format.default;v=p(y,b,"subCommand","text"),a.formatDropDown.content='<span style="display: inline-flex;width:'+e.parent.format.width+'" ><span class="e-rte-dropdown-btn-text">'+((0,i.hX)(v)?C:v)+"</span></span>",a.formatDropDown.dataBind();break;case"alignments":if((0,i.hX)(a.alignDropDown)||!(0,i.hX)(a.alignDropDown)&&a.alignDropDown.isDestroyed)break;v=p(r.qT,b,"subCommand","iconCss"),a.alignDropDown.iconCss=(0,i.hX)(v)?"e-icons e-justify-left":v,a.alignDropDown.dataBind();break;case"fontname":if((0,i.hX)(a.fontNameDropDown)||t||!(0,i.hX)(a.fontNameDropDown)&&a.fontNameDropDown.isDestroyed)break;var S=e.parent.fontFamily.items;v=p(S,b,"value","text");var E=(0,i.hX)(e.parent.fontFamily.default)?S[0].text:e.parent.fontFamily.default,w=(0,i.hX)(v)?E:v;e.tbElements[m].title=w,a.fontNameDropDown.content='<span style="display: inline-flex;width:'+e.parent.fontFamily.width+'" ><span class="e-rte-dropdown-btn-text">'+w+"</span></span>",a.fontNameDropDown.dataBind();break;case"fontsize":if((0,i.hX)(a.fontSizeDropDown)||!(0,i.hX)(a.fontSizeDropDown)&&a.fontSizeDropDown.isDestroyed)break;var T=e.parent.fontSize.items,k=(0,i.hX)(e.parent.fontSize.default)?T[1].text:e.parent.fontSize.default;v=p(T,""===b?k.replace(/\s/g,""):b,"value","text"),a.fontSizeDropDown.content='<span style="display: inline-flex;width:'+e.parent.fontSize.width+'" ><span class="e-rte-dropdown-btn-text">'+u(v)+"</span></span>",a.fontSizeDropDown.dataBind()}}}}function b(e){return"object"===typeof e?e:[e]}function v(e,t){for(var n=[],i=0;i<e.length;i++)for(var o=0;o<t.length;o++)if("Separator"!==t[o].type){if("OrderedList"===e[i]&&"OL"===t[o].subCommand){n.push(o);break}if("UnorderedList"===e[i]&&"UL"===t[o].subCommand){n.push(o);break}if("InsertCode"===e[i]&&"Pre"===t[o].subCommand){n.push(o);break}if("FileManager"===e[i]&&"File"===t[o].subCommand){n.push(o);break}if("object"===typeof e[i]&&"Custom"===e[i].command){n.push(i);break}if(e[i]===t[o].subCommand){n.push(o);break}}return n}function y(e,t){for(var n=0,r=v(b(s),e.toolbarObj.items),a=(0,i.Ub)("."+o.um,e.toolbarObj.element),l=0,d=Object.keys(t);l<d.length;l++){var h=d[l],p=a[r[n]];p&&e.toolbarObj.enableItems(p,t[h]),n++}}function C(e,t){var n=document.createEvent("HTMLEvents");n.initEvent(t,!1,!0),e.dispatchEvent(n)}function S(e){var t=(0,i.n)("template");return t.innerHTML=e,t.content instanceof DocumentFragment?t.content:document.createRange().createContextualFragment(e)}function E(e,t){var n=[];for(t=t.firstChild;t;t=t.nextSibling)3===t.nodeType?n.push(t):n=n.concat(E(e,t));return n}function w(e){for(var t={},n=Object.keys(e),i=0;i<Object.keys(e).length;i++)t[n[i].toLocaleLowerCase()]=e[n[i]];return t}function T(e,t){var n;return null!==e&&""!==e?(n=t.enableHtmlEncode?k(D(e),t):k(e,t),t.setProperties({value:n},!0)):n="DIV"===t.enterKey?t.enableHtmlEncode?"&lt;div&gt;&lt;br/&gt;&lt;/div&gt;":"<div><br/></div>":"BR"===t.enterKey?t.enableHtmlEncode?"&lt;br/&gt;":"<br/>":t.enableHtmlEncode?"&lt;p&gt;&lt;br/&gt;&lt;/p&gt;":"<p><br/></p>",n}function k(e,t){var n=document.createElement("div"),r=document.createElement("div"),a=n.childNodes;if(n.innerHTML=e,n.setAttribute("class","tempDiv"),a.length>0){for(var s=void 0,d=void 0,h=void 0;n.firstChild;)"BR"!==t.enterKey&&("#text"===n.firstChild.nodeName&&(n.firstChild.textContent.indexOf("\n")<0||""!==n.firstChild.textContent.trim())||l.indexOf(n.firstChild.nodeName.toLocaleLowerCase())>=0)?(s?d.appendChild(n.firstChild):(h="DIV"===t.enterKey?(0,i.n)("div"):(0,i.n)("p"),r.appendChild(h),h.appendChild(n.firstChild)),d=h,s=!0):"#text"===n.firstChild.nodeName&&("\n"===n.firstChild.textContent||n.firstChild.textContent.indexOf("\n")>=0&&""===n.firstChild.textContent.trim())?(0,i.Yo)(n.firstChild):(r.appendChild(n.firstChild),s=!1);for(var p=r.querySelectorAll("img"),c=0;c<p.length;c++)p[c].classList.contains(o.nw)||p[c].classList.add(o.nw),p[c].classList.contains(o.eh)||p[c].classList.contains(o._L)||p[c].classList.add(o.eh)}return r.innerHTML}function N(e){return"DIV"===e.enterKey?e.enableHtmlEncode?"&lt;div&gt;&lt;br/&gt;&lt;/div&gt;":"<div><br/></div>":"BR"===e.enterKey?e.enableHtmlEncode?"&lt;br/&gt;":"<br/>":e.enableHtmlEncode?"&lt;p&gt;&lt;br/&gt;&lt;/p&gt;":"<p><br/></p>"}function L(e){return"<p><br></p>"===e||"&lt;p&gt;&lt;br&gt;&lt;/p&gt;"===e||"<div><br></div>"===e||"&lt;div&gt;&lt;br&gt;&lt;/div&gt;"===e||"<br>"===e||"&lt;br&gt;"===e||""===e}function D(e){return e.replace(/&amp;/g,"&").replace(/&amp;lt;/g,"<").replace(/&lt;/g,"<").replace(/&amp;gt;/g,">").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&amp;nbsp;/g," ").replace(/&quot;/g,"")}function x(e,t){if(t.enableHtmlSanitizer){var n=i.r4.beforeSanitize();(0,i.X$)(n,n,{cancel:!1,helper:null}),t.trigger("beforeSanitizeHtml",n),n.cancel&&!(0,i.hX)(n.helper)?e=n.helper(e):n.cancel||(e=i.r4.serializeValue(n,e))}return e}function M(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],i=atob(t[1]),o=i.length,r=new Uint8Array(o);o--;)r[o]=i.charCodeAt(o);return new Blob([r],{type:n})}function A(e,t,n){for(var i=0;t.length>i;i++)if(t[i].value===n.value||t[i].value===n.subCommand)return e.localeObj.getConstant(t[i].locale);return n.text}function O(e){r.mw.forEach((function(t,n){r.mw[n].text=A(e,a.Pj,r.mw[n])})),r.ah.forEach((function(t,n){r.ah[n].text=A(e,a.BU,r.ah[n])})),r.$I.forEach((function(t,n){r.$I[n].text=A(e,a.Vu,r.$I[n])})),r.K7.forEach((function(t,n){r.K7[n].text=A(e,a.wH,r.K7[n])}))}},8237:(e,t,n)=>{n.d(t,{BU:()=>a,MQ:()=>o,Pj:()=>r,Vu:()=>s,q:()=>i,wH:()=>l});var i={alignments:"Alignments",justifyLeft:"Align Left",justifyCenter:"Align Center",justifyRight:"Align Right",justifyFull:"Align Justify",fontName:"Font Name",fontSize:"Font Size",fontColor:"Font Color",backgroundColor:"Background Color",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",clearFormat:"Clear Format",clearAll:"Clear All",cut:"Cut",copy:"Copy",paste:"Paste",unorderedList:"Bulleted List",orderedList:"Numbered List",indent:"Increase Indent",outdent:"Decrease Indent",undo:"Undo",redo:"Redo",superscript:"Superscript",subscript:"Subscript",createLink:"Insert Link",openLink:"Open Link",editLink:"Edit Link",removeLink:"Remove Link",image:"Insert Image",replace:"Replace",align:"Align",caption:"Image Caption",remove:"Remove",insertLink:"Insert Link",display:"Display",altText:"Alternative Text",dimension:"Change Size",fullscreen:"Maximize",maximize:"Maximize",minimize:"Minimize",lowerCase:"Lower Case",upperCase:"Upper Case",print:"Print",formats:"Formats",sourcecode:"Code View",preview:"Preview",viewside:"ViewSide",insertCode:"Insert Code",linkText:"Display Text",linkTooltipLabel:"Title",linkWebUrl:"Web Address",linkTitle:"Enter a title",linkurl:"http://example.com",linkOpenInNewWindow:"Open Link in New Window",linkHeader:"Insert Link",dialogInsert:"Insert",dialogCancel:"Cancel",dialogUpdate:"Update",imageHeader:"Insert Image",imageLinkHeader:"You can also provide a link from the web",mdimageLink:"Please provide a URL for your image",imageUploadMessage:"Drop image here or browse to upload",imageDeviceUploadMessage:"Click here to upload",imageAlternateText:"Alternate Text",alternateHeader:"Alternative Text",browse:"Browse",imageUrl:"http://example.com/image.png",imageCaption:"Caption",imageSizeHeader:"Image Size",imageHeight:"Height",imageWidth:"Width",textPlaceholder:"Enter Text",inserttablebtn:"Insert Table",tabledialogHeader:"Insert Table",tableWidth:"Width",cellpadding:"Cell Padding",cellspacing:"Cell Spacing",columns:"Number of columns",rows:"Number of rows",tableRows:"Table Rows",tableColumns:"Table Columns",tableCellHorizontalAlign:"Table Cell Horizontal Align",tableCellVerticalAlign:"Table Cell Vertical Align",createTable:"Create Table",removeTable:"Remove Table",tableHeader:"Table Header",tableRemove:"Table Remove",tableCellBackground:"Table Cell Background",tableEditProperties:"Table Edit Properties",styles:"Styles",insertColumnLeft:"Insert Column Left",insertColumnRight:"Insert Column Right",deleteColumn:"Delete Column",insertRowBefore:"Insert Row Before",insertRowAfter:"Insert Row After",deleteRow:"Delete Row",tableEditHeader:"Edit Table",TableHeadingText:"Heading",TableColText:"Col",imageInsertLinkHeader:"Insert Link",editImageHeader:"Edit Image",alignmentsDropDownLeft:"Align Left",alignmentsDropDownCenter:"Align Center",alignmentsDropDownRight:"Align Right",alignmentsDropDownJustify:"Align Justify",imageDisplayDropDownInline:"Inline",imageDisplayDropDownBreak:"Break",tableInsertRowDropDownBefore:"Insert row before",tableInsertRowDropDownAfter:"Insert row after",tableInsertRowDropDownDelete:"Delete row",tableInsertColumnDropDownLeft:"Insert column left",tableInsertColumnDropDownRight:"Insert column right",tableInsertColumnDropDownDelete:"Delete column",tableVerticalAlignDropDownTop:"Align Top",tableVerticalAlignDropDownMiddle:"Align Middle",tableVerticalAlignDropDownBottom:"Align Bottom",tableStylesDropDownDashedBorder:"Dashed Borders",tableStylesDropDownAlternateRows:"Alternate Rows",pasteFormat:"Paste Format",pasteFormatContent:"Choose the formatting action",plainText:"Plain Text",cleanFormat:"Clean",keepFormat:"Keep",pasteDialogOk:"OK",pasteDialogCancel:"Cancel",fileManager:"File Manager",fileDialogHeader:"File Browser",formatsDropDownParagraph:"Paragraph",formatsDropDownCode:"Code",formatsDropDownQuotation:"Quotation",formatsDropDownHeading1:"Heading 1",formatsDropDownHeading2:"Heading 2",formatsDropDownHeading3:"Heading 3",formatsDropDownHeading4:"Heading 4",fontNameSegoeUI:"Segoe UI",fontNameArial:"Arial",fontNameGeorgia:"Georgia",fontNameImpact:"Impact",fontNameTahoma:"Tahoma",fontNameTimesNewRoman:"Times New Roman",fontNameVerdana:"Verdana",numberFormatListNumber:"Number",numberFormatListLowerAlpha:"LowerAlpha",numberFormatListUpperAlpha:"UpperAlpha",numberFormatListLowerRoman:"LowerRoman",numberFormatListUpperRoman:"UpperRoman",numberFormatListLowerGreek:"LowerGreek",bulletFormatListDisc:"Disc",bulletFormatListCircle:"Circle",bulletFormatListSquare:"Square",numberFormatListNone:"None",bulletFormatListNone:"None"},o={alignments:"alignments",justifyleft:"justifyLeft",justifycenter:"justifyCenter",justifyright:"justifyRight",justifyfull:"justifyFull",fontname:"fontName",fontsize:"fontSize",fontcolor:"fontColor",backgroundcolor:"backgroundColor",bold:"bold",italic:"italic",underline:"underline",strikethrough:"strikethrough",clearformat:"clearFormat",clearall:"clearAll",cut:"cut",copy:"copy",paste:"paste",unorderedlist:"unorderedList",orderedlist:"orderedList",indent:"indent",outdent:"outdent",undo:"undo",redo:"redo",superscript:"superscript",subscript:"subscript",createlink:"createLink",openlink:"openLink",editlink:"editLink",removelink:"removeLink",openimagelink:"openLink",editimagelink:"editLink",removeimagelink:"removeLink",image:"image",replace:"replace",align:"align",caption:"caption",remove:"remove",insertlink:"insertLink",display:"display",alttext:"altText",dimension:"dimension",fullscreen:"fullscreen",maximize:"maximize",minimize:"minimize",lowercase:"lowerCase",uppercase:"upperCase",print:"print",formats:"formats",sourcecode:"sourcecode",preview:"preview",viewside:"viewside",insertcode:"insertCode",tablerows:"tableRows",tablecolumns:"tableColumns",tablecellhorizontalalign:"tableCellHorizontalAlign",tablecellverticalalign:"tableCellVerticalAlign",createtable:"createTable",removetable:"removeTable",tableheader:"tableHeader",tableremove:"tableRemove",tablecellbackground:"tableCellBackground",tableeditproperties:"tableEditProperties",styles:"styles",insertcolumnleft:"insertColumnLeft",insertcolumnright:"insertColumnRight",deletecolumn:"deleteColumn",aligntop:"AlignTop",alignmiddle:"AlignMiddle",alignbottom:"AlignBottom",insertrowbefore:"insertRowBefore",insertrowafter:"insertRowAfter",deleterow:"deleteRow"},r=[{locale:"fontNameSegoeUI",value:"Segoe UI"},{locale:"fontNameArial",value:"Arial,Helvetica,sans-serif"},{locale:"fontNameGeorgia",value:"Georgia,serif"},{locale:"fontNameImpact",value:"Impact,Charcoal,sans-serif"},{locale:"fontNameTahoma",value:"Tahoma,Geneva,sans-serif"},{locale:"fontNameTimesNewRoman",value:"Times New Roman,Times,serif"},{locale:"fontNameVerdana",value:"Verdana,Geneva,sans-serif"}],a=[{locale:"formatsDropDownParagraph",value:"P"},{locale:"formatsDropDownCode",value:"Pre"},{locale:"formatsDropDownQuotation",value:"BlockQuote"},{locale:"formatsDropDownHeading1",value:"H1"},{locale:"formatsDropDownHeading2",value:"H2"},{locale:"formatsDropDownHeading3",value:"H3"},{locale:"formatsDropDownHeading4",value:"H4"}],s=[{locale:"numberFormatListNone",value:"none"},{locale:"numberFormatListNumber",value:"decimal"},{locale:"numberFormatListLowerAlpha",value:"lower-alpha"},{locale:"numberFormatListUpperAlpha",value:"upper-alpha"},{locale:"numberFormatListLowerRoman",value:"lower-roman"},{locale:"numberFormatListUpperRoman",value:"upper-roman"},{locale:"numberFormatListLowerGreek",value:"lower-greek"}],l=[{locale:"bulletFormatListNone",value:"none"},{locale:"bulletFormatListDisc",value:"disc"},{locale:"bulletFormatListCircle",value:"circle"},{locale:"bulletFormatListSquare",value:"square"}]},1011:(e,t,n)=>{n.d(t,{$B:()=>s,$I:()=>k,$w:()=>D,J:()=>S,K7:()=>N,Kn:()=>c,Nu:()=>h,Qu:()=>m,T8:()=>w,VI:()=>y,XX:()=>i,Yl:()=>o,ah:()=>E,mw:()=>C,oR:()=>T,qT:()=>a,qn:()=>f,ue:()=>d,uu:()=>v});var i=["alignments","formats","fontname","fontsize","fontcolor","backgroundcolor","align","display","tablerows","tablecolumns","tablecell","tablecellhorizontalalign","tablecellverticalalign","styles","numberformatlist","bulletformatlist"],o={alignments:{id:"Alignments",icon:"e-alignments",tooltip:"Alignments",command:"Alignments",subCommand:"Alignments"},justifyleft:{id:"JustifyLeft",icon:"e-justify-left",tooltip:"JustifyLeft",command:"Alignments",subCommand:"JustifyLeft"},justifycenter:{id:"JustifyCenter",icon:"e-justify-center",tooltip:"JustifyCenter",command:"Alignments",subCommand:"JustifyCenter"},justifyright:{id:"JustifyRight",icon:"e-justify-right",tooltip:"JustifyRight",command:"Alignments",subCommand:"JustifyRight"},justifyfull:{id:"JustifyFull",icon:"e-justify-full",tooltip:"JustifyFull",command:"Alignments",subCommand:"JustifyFull"},fontname:{id:"FontName",icon:"e-font-name",tooltip:"Font Name",command:"Font",subCommand:"FontName"},fontsize:{id:"FontSize",icon:"e-font-size",tooltip:"Font Size",command:"Font",subCommand:"FontSize"},fontcolor:{id:"FontColor",icon:"e-font-color",tooltip:"Font Color",command:"Font",subCommand:"FontColor",value:"#ff0000ff"},backgroundcolor:{id:"BackgroundColor",icon:"e-background-color",tooltip:"Background Color",command:"Font",subCommand:"BackgroundColor",value:"#ffff00ff"},bold:{id:"Bold",icon:"e-bold",tooltip:"Bold",command:"Style",subCommand:"Bold"},italic:{id:"Italic",icon:"e-italic",tooltip:"Italic",command:"Style",subCommand:"Italic"},underline:{id:"Underline",icon:"e-underline",tooltip:"Underline",command:"Style",subCommand:"Underline"},strikethrough:{id:"StrikeThrough",icon:"e-strike-through",tooltip:"StrikeThrough",command:"Style",subCommand:"StrikeThrough"},clearformat:{id:"ClearFormat",icon:"e-clear-format",tooltip:"Clear Format",command:"Clear",subCommand:"ClearFormat"},clearall:{id:"ClearAll",icon:"e-clear-all",tooltip:"Clear All",command:"Clear",subCommand:"ClearAll"},cut:{id:"Cut",icon:"e-cut",tooltip:"Cut",command:"ClipBoard",subCommand:"Cut"},copy:{id:"Copy",icon:"e-copy",tooltip:"Copy",command:"ClipBoard",subCommand:"Copy"},paste:{id:"Paste",icon:"e-paste",tooltip:"Paste",command:"ClipBoard",subCommand:"Paste"},unorderedlist:{id:"UnorderedList",icon:"e-unorder-list",tooltip:"Bulleted List",command:"Lists",subCommand:"UL"},orderedlist:{id:"OrderedList",icon:"e-order-list",tooltip:"Numbered List",command:"Lists",subCommand:"OL"},numberformatlist:{id:"NumberFormatList",icon:"e-order-list",tooltip:"Number Format List",command:"NumberFormatList",subCommand:"NumberFormatList"},bulletformatlist:{id:"BulletFormatList",icon:"e-unorder-list",tooltip:"Bullet Format List",command:"BulletFormatList",subCommand:"BulletFormatList"},indent:{id:"Indent",icon:"e-indent",tooltip:"Increase Indent",command:"Indents",subCommand:"Indent"},outdent:{id:"Outdent",icon:"e-outdent",tooltip:"Decrease Indent",command:"Indents",subCommand:"Outdent"},undo:{id:"Undo",icon:"e-undo",tooltip:"Undo",command:"Actions",subCommand:"Undo"},redo:{id:"Redo",icon:"e-redo",tooltip:"Redo",command:"Actions",subCommand:"Redo"},superscript:{id:"SuperScript",icon:"e-super-script",tooltip:"Superscript",command:"Effects",subCommand:"SuperScript"},subscript:{id:"SubScript",icon:"e-sub-script",tooltip:"Subscript",command:"Effects",subCommand:"SubScript"},createlink:{id:"CreateLink",icon:"e-create-link",tooltip:"Insert Hyperlink",command:"Links",subCommand:"CreateLink"},openlink:{id:"OpenLink",icon:"e-open-link",tooltip:"Open Link",command:"Links",subCommand:"OpenLink"},editlink:{id:"EditLink",icon:"e-edit-link",tooltip:"Edit Link",command:"Links",subCommand:"EditLink"},removelink:{id:"RemoveLink",icon:"e-remove-link",tooltip:"Remove Link",command:"Links",subCommand:"RemoveLink"},image:{id:"Image",icon:"e-image",tooltip:"Insert Image",command:"Images",subCommand:"Image"},filemanager:{id:"FileManager",icon:"e-rte-file-manager",tooltip:"File Manager",command:"Files",subCommand:"File"},createtable:{id:"CreateTable",icon:"e-create-table",tooltip:"Create Table",command:"Table",subCommand:"CreateTable"},removetable:{id:"removeTable",icon:"e-remove-table",tooltip:"Remove Table",command:"removeTable",subCommand:"removeTable"},replace:{id:"Replace",icon:"e-replace",tooltip:"Replace",command:"Images",subCommand:"Replace"},align:{id:"Align",icon:"e-align",tooltip:"Align",command:"Images",subCommand:"Align"},caption:{id:"Caption",icon:"e-caption",tooltip:"Image Caption",command:"Images",subCommand:"Caption"},remove:{id:"Remove",icon:"e-remove",tooltip:"Remove",command:"Images",subCommand:"Remove"},openimagelink:{id:"OpenImageLink",icon:"e-open-link",tooltip:"Open Link",command:"Images",subCommand:"OpenImageLink"},editimagelink:{id:"EditImageLink",icon:"e-edit-link",tooltip:"Edit Link",command:"Images",subCommand:"EditImageLink"},removeimagelink:{id:"RemoveImageLink",icon:"e-remove-link",tooltip:"Remove Link",command:"Images",subCommand:"RemoveImageLink"},insertlink:{id:"InsertLink",icon:"e-insert-link",tooltip:"Insert Link",command:"Images",subCommand:"InsertLink"},display:{id:"Display",icon:"e-display",tooltip:"Display",command:"Images",subCommand:"Display"},alttext:{id:"AltText",icon:"e-alt-text",tooltip:"Alternative Text",command:"Images",subCommand:"AltText"},dimension:{id:"Dimension",icon:"e-img-dimension",tooltip:"Change Size",command:"Images",subCommand:"Dimension"},fullscreen:{id:"Maximize",icon:"e-maximize",tooltip:"Maximize",command:"View",subCommand:"Maximize"},maximize:{id:"Maximize",icon:"e-maximize",tooltip:"Maximize",command:"FullScreen",subCommand:"Maximize"},minimize:{id:"Minimize",icon:"e-minimize",tooltip:"Minimize",command:"FullScreen",subCommand:"Minimize"},lowercase:{id:"LowerCase",icon:"e-lower-case",tooltip:"Lower Case",command:"Casing",subCommand:"LowerCase"},uppercase:{id:"UpperCase",icon:"e-upper-case",tooltip:"Upper Case",command:"Casing",subCommand:"UpperCase"},print:{id:"Print",icon:"e-print",tooltip:"Print",command:"Print",subCommand:"Print"},formats:{id:"Formats",icon:"e-formats",tooltip:"Formats",command:"Formats",subCommand:"Formats"},sourcecode:{id:"SourceCode",icon:"e-source-code",tooltip:"Source Code",command:"SourceCode",subCommand:"SourceCode"},preview:{id:"Preview",icon:"e-preview",tooltip:"Preview",command:"Preview",subCommand:"Preview"},viewside:{id:"ViewSide",icon:"e-view-side",tooltip:"ViewSide",command:"ViewSide",subCommand:"ViewSide"},insertcode:{id:"InsertCode",icon:"e-insert-code",tooltip:"Insert Code",command:"Formats",subCommand:"Pre"},tableheader:{id:"TableHeader",icon:"e-table-header",tooltip:"Table Header",command:"Table",subCommand:"TableHeader"},tableremove:{id:"TableRemove",icon:"e-table-remove",tooltip:"Table Remove",command:"Table",subCommand:"TableRemove"},tablerows:{id:"TableRows",icon:"e-table-rows",tooltip:"Table Rows",command:"Table",subCommand:"TableRows"},tablecolumns:{id:"TableColumns",icon:"e-table-columns",tooltip:"Table Columns",command:"Table",subCommand:"TableColumns"},tablecell:{id:"TableCell",icon:"e-table-cell",tooltip:"Table Cell",command:"Table",subCommand:"TableCell"},tablecellbackground:{id:"TableCellBackground",icon:"e-table-cell-background",tooltip:"Table Cell Background",command:"Table",subCommand:"TableCellBackground"},tablecellhorizontalalign:{id:"TableCellHorizontalAlign",icon:"e-table-cell-horizontalAlign",tooltip:"Table Cell HorizontalAlign",command:"Table",subCommand:"TableCellHorizontalAlign"},tablecellverticalalign:{id:"TableCellVerticalAlign",icon:"e-table-cell-verticalAlign",tooltip:"Table Cell VerticalAlign",command:"Table",subCommand:"TableCellVerticalAlign"},tableeditproperties:{id:"TableEditProperties",icon:"e-table-edit-properties",tooltip:"Table Edit Properties",command:"Table",subCommand:"TableEditProperties"},styles:{id:"Styles",icon:"e-table-styles",tooltip:"Styles",command:"Table",subCommand:"Styles"}},r=[{locale:"alignmentsDropDownLeft",value:"JustifyLeft"},{locale:"alignmentsDropDownCenter",value:"JustifyCenter"},{locale:"alignmentsDropDownRight",value:"JustifyRight"},{locale:"alignmentsDropDownJustify",value:"JustifyFull"}],a=[{iconCss:"e-icons e-justify-left",text:"Align Left",command:"Alignments",subCommand:"JustifyLeft"},{iconCss:"e-icons e-justify-center",text:"Align Center",command:"Alignments",subCommand:"JustifyCenter"},{iconCss:"e-icons e-justify-right",text:"Align Right",command:"Alignments",subCommand:"JustifyRight"},{iconCss:"e-icons e-justify-full",text:"Align Justify",command:"Alignments",subCommand:"JustifyFull"}],s=[{iconCss:"e-icons e-justify-left",command:"Images",subCommand:"JustifyLeft"},{iconCss:"e-icons e-justify-center",command:"Images",subCommand:"JustifyCenter"},{iconCss:"e-icons e-justify-right",command:"Images",subCommand:"JustifyRight"}],l=[{locale:"imageDisplayDropDownInline",value:"Inline"},{locale:"imageDisplayDropDownBreak",value:"Break"}],d=[{text:"Inline",cssClass:"e-inline",command:"Images",subCommand:"Inline"},{text:"Break",cssClass:"e-break",command:"Images",subCommand:"Break"}],h=[{iconCss:"e-icons e-cell-merge",text:"Merge cells",command:"Table",subCommand:"Merge"},{iconCss:"e-icons e-cell-horizontal-split",text:"Horizontal split",command:"Table",subCommand:"HorizontalSplit"},{iconCss:"e-icons e-cell-vertical-split",text:"Vertical split",command:"Table",subCommand:"VerticalSplit"}],p=[{locale:"tableInsertRowDropDownBefore",value:"InsertRowBefore"},{locale:"tableInsertRowDropDownAfter",value:"InsertRowAfter"},{locale:"tableInsertRowDropDownDelete",value:"DeleteRow"}],c=[{iconCss:"e-icons e-insert-row-before",text:"Insert row before",command:"Table",subCommand:"InsertRowBefore"},{iconCss:"e-icons e-insert-row-after",text:"Insert row after",command:"Table",subCommand:"InsertRowAfter"},{iconCss:"e-icons e-delete-row",text:"Delete row",command:"Table",subCommand:"DeleteRow"}],u=[{locale:"tableInsertColumnDropDownLeft",value:"InsertColumnLeft"},{locale:"tableInsertColumnDropDownRight",value:"InsertColumnRight"},{locale:"tableInsertColumnDropDownDelete",value:"DeleteColumn"}],m=[{iconCss:"e-icons e-insert-column-left",text:"Insert column left",command:"Table",subCommand:"InsertColumnLeft"},{iconCss:"e-icons e-insert-column-right",text:"Insert column right",command:"Table",subCommand:"InsertColumnRight"},{iconCss:"e-icons e-delete-column",text:"Delete column",command:"Table",subCommand:"DeleteColumn"}],g=[{locale:"tableVerticalAlignDropDownTop",value:"AlignTop"},{locale:"tableVerticalAlignDropDownMiddle",value:"AlignMiddle"},{locale:"tableVerticalAlignDropDownBottom",value:"AlignBottom"}],f=[{iconCss:"e-icons e-align-top",text:"Align Top",command:"Table",subCommand:"AlignTop"},{iconCss:"e-icons e-align-middle",text:"Align Middle",command:"Table",subCommand:"AlignMiddle"},{iconCss:"e-icons e-align-bottom",text:"Align Bottom",command:"Table",subCommand:"AlignBottom"}],b=[{locale:"tableStylesDropDownDashedBorder",value:"Dashed"},{locale:"tableStylesDropDownAlternateRows",value:"Alternate"}],v=[{text:"Dashed Borders",cssClass:"e-dashed-borders",command:"Table",subCommand:"Dashed"},{text:"Alternate Rows",cssClass:"e-alternate-rows",command:"Table",subCommand:"Alternate"}],y=["Bold","Italic","Underline","|","Formats","Alignments","OrderedList","UnorderedList","|","CreateLink","Image","|","SourceCode","Undo","Redo"],C=[{cssClass:"e-segoe-ui",text:"Segoe UI",command:"Font",subCommand:"FontName",value:"Segoe UI"},{cssClass:"e-arial",text:"Arial",command:"Font",subCommand:"FontName",value:"Arial,Helvetica,sans-serif"},{cssClass:"e-georgia",text:"Georgia",command:"Font",subCommand:"FontName",value:"Georgia,serif"},{cssClass:"e-impact",text:"Impact",command:"Font",subCommand:"FontName",value:"Impact,Charcoal,sans-serif"},{cssClass:"e-tahoma",text:"Tahoma",command:"Font",subCommand:"FontName",value:"Tahoma,Geneva,sans-serif"},{cssClass:"e-times-new-roman",text:"Times New Roman",command:"Font",subCommand:"FontName",value:"Times New Roman,Times,serif"},{cssClass:"e-verdana",text:"Verdana",command:"Font",subCommand:"FontName",value:"Verdana,Geneva,sans-serif"}],S=[{text:"8 pt",value:"8pt"},{text:"10 pt",value:"10pt"},{text:"12 pt",value:"12pt"},{text:"14 pt",value:"14pt"},{text:"18 pt",value:"18pt"},{text:"24 pt",value:"24pt"},{text:"36 pt",value:"36pt"}],E=[{cssClass:"e-paragraph",text:"Paragraph",command:"Formats",subCommand:"P",value:"P"},{cssClass:"e-code",text:"Code",command:"Formats",subCommand:"Pre",value:"Pre"},{cssClass:"e-quote",text:"Quotation",command:"Formats",subCommand:"BlockQuote",value:"BlockQuote"},{cssClass:"e-h1",text:"Heading 1",command:"Formats",subCommand:"H1",value:"H1"},{cssClass:"e-h2",text:"Heading 2",command:"Formats",subCommand:"H2",value:"H2"},{cssClass:"e-h3",text:"Heading 3",command:"Formats",subCommand:"H3",value:"H3"},{cssClass:"e-h4",text:"Heading 4",command:"Formats",subCommand:"H4",value:"H4"}],w={Custom:["","#000000","#e7e6e6","#44546a","#4472c4","#ed7d31","#a5a5a5","#ffc000","#70ad47","#ff0000","#f2f2f2","#808080","#cfcdcd","#d5dce4","#d9e2f3","#fbe4d5","#ededed","#fff2cc","#e2efd9","#ffcccc","#d9d9d9","#595959","#aeaaaa","#acb9ca","#b4c6e7","#f7caac","#dbdbdb","#ffe599","#c5e0b3","#ff8080","#bfbfbf","#404040","#747070","#8496b0","#8eaadb","#f4b083","#c9c9c9","#ffd966","#a8d08d","#ff3333","#a6a6a6","#262626","#3b3838","#323e4f","#2f5496","#c45911","#7b7b7b","#bf8f00","#538135","#b30000","#7f7f7f","#0d0d0d","#161616","#212934","#1f3763","#823b0b","#525252","#7f5f00","#375623","#660000"]},T={Custom:["","#000000","#ffff00","#00ff00","#00ffff","#0000ff","#ff0000","#000080","#800080","#996633","#f2f2f2","#808080","#ffffcc","#b3ffb3","#ccffff","#ccccff","#ffcccc","#ccccff","#ff80ff","#f2e6d9","#d9d9d9","#595959","#ffff80","#80ff80","#b3ffff","#8080ff","#ff8080","#8080ff","#ff00ff","#dfbf9f","#bfbfbf","#404040","#ffff33","#33ff33","#33ffff","#3333ff","#ff3333","#0000b3","#b300b3","#c68c53","#a6a6a6","#262626","#e6e600","#00b300","#009999","#000099","#b30000","#000066","#660066","#86592d","#7f7f7f","#0d0d0d","#999900","#006600","#006666","#000066","#660000","#00004d","#4d004d","#734d26"]},k=[{text:"None",command:"Lists",subCommand:"NumberFormatList",value:"none"},{text:"Number",command:"Lists",subCommand:"NumberFormatList",value:"decimal"},{text:"Lower Greek",command:"Lists",subCommand:"NumberFormatList",value:"lowerGreek"},{text:"Lower Roman",command:"Lists",subCommand:"NumberFormatList",value:"lowerRoman"},{text:"Upper Alpha",command:"Lists",subCommand:"NumberFormatList",value:"upperAlpha"},{text:"Lower Alpha",command:"Lists",subCommand:"NumberFormatList",value:"lowerAlpha"},{text:"Upper Roman",command:"Lists",subCommand:"NumberFormatList",value:"upperRoman"}],N=[{text:"None",command:"Lists",subCommand:"BulletFormatList",value:"none"},{text:"Disc",command:"Lists",subCommand:"BulletFormatList",value:"disc"},{text:"Circle",command:"Lists",subCommand:"BulletFormatList",value:"circle"},{text:"Square",command:"Lists",subCommand:"BulletFormatList",value:"square"}];function L(e,t,n){for(var i=0;t.length>i;i++)if(t[i].value===n.subCommand)return e.localeObj.getConstant(t[i].locale);return n.text}function D(e){a.forEach((function(t,n){a[n].text=L(e,r,a[n])})),d.forEach((function(t,n){d[n].text=L(e,l,d[n])})),c.forEach((function(t,n){c[n].text=L(e,p,c[n])})),m.forEach((function(t,n){m[n].text=L(e,u,m[n])})),f.forEach((function(t,n){f[n].text=L(e,g,f[n])})),v.forEach((function(t,n){v[n].text=L(e,b,v[n])}))}},2478:(e,t,n)=>{n.d(t,{_:()=>$});var i=n(8452),o=n(5290),r=n(5624),a=n(7309),s=n(2771),l=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),d=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},h="e-file-select",p="e-file-drop",c="e-upload-files",u="e-upload-file-list",m="e-file-status",g="e-file-name",f="e-file-type",b="e-file-size",v="e-file-remove-btn",y="e-file-delete-btn",C="e-spinner-pane",S="e-file-abort-btn",E="e-file-reload-btn",w="e-upload-drag-hover",T="e-upload-progress-wrap",k="e-upload-progress-bar",N="e-progress-bar-text",L="e-upload-progress",D="e-upload-success",x="e-upload-fails",M="e-file-container",A="e-validation-fails",O="e-rtl",R="e-disabled",I="e-rtl-container",B="e-clear-icon-focus",P="e-file-pause-btn",F="e-file-play-btn",H="e-restrict-retry",X=["title","style","class"],q="e-form-upload",z="e-file-invalid",j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),d([(0,i.mA)("")],t.prototype,"name",void 0),d([(0,i.mA)(null)],t.prototype,"size",void 0),d([(0,i.mA)("")],t.prototype,"type",void 0),t}(i.I1),U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),d([(0,i.mA)("Browse...")],t.prototype,"browse",void 0),d([(0,i.mA)("Upload")],t.prototype,"upload",void 0),d([(0,i.mA)("Clear")],t.prototype,"clear",void 0),t}(i.I1),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),d([(0,i.mA)("")],t.prototype,"saveUrl",void 0),d([(0,i.mA)("")],t.prototype,"removeUrl",void 0),d([(0,i.mA)(0)],t.prototype,"chunkSize",void 0),d([(0,i.mA)(3)],t.prototype,"retryCount",void 0),d([(0,i.mA)(500)],t.prototype,"retryAfterDelay",void 0),t}(i.I1),W=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.initialAttr={accept:null,multiple:!1,disabled:!1},i.uploadedFilesData=[],i.base64String=[],i.isForm=!1,i.allTypes=!1,i.pausedData=[],i.uploadMetaData=[],i.tabIndex="0",i.btnTabIndex="0",i.disableKeyboardNavigation=!1,i.count=-1,i.actionCompleteCount=0,i.flag=!0,i.selectedFiles=[],i.uploaderName="UploadFiles",i.fileStreams=[],i.newFileRef=0,i.isFirstFileOnSelection=!1,i.dragCounter=0,i.fileList=[],i.filesData=[],i.uploaderOptions=t,i}return l(t,e),t.prototype.onPropertyChanged=function(e,t){for(var n=0,o=Object.keys(e);n<o.length;n++){switch(o[n]){case"allowedExtensions":this.setExtensions(this.allowedExtensions),this.clearAll();break;case"enabled":this.setControlStatus();break;case"multiple":this.setMultipleSelection();break;case"enableRtl":this.setRTL(),this.reRenderFileList();break;case"buttons":this.buttons.browse=(0,i.hX)(this.buttons.browse)?"":this.buttons.browse,this.buttons.clear=(0,i.hX)(this.buttons.clear)?"":this.buttons.clear,this.buttons.upload=(0,i.hX)(this.buttons.upload)?"":this.buttons.upload,this.renderButtonTemplates();break;case"dropArea":this.unBindDropEvents(),this.updateDropArea();break;case"htmlAttributes":this.updateHTMLAttrToElement(),this.updateHTMLAttrToWrapper(),this.checkHTMLAttributes(!0);break;case"files":this.renderPreLoadFiles();break;case"directoryUpload":this.updateDirectoryAttributes();break;case"template":case"minFileSize":case"maxFileSize":case"autoUpload":case"sequentialUpload":this.clearAll();break;case"locale":this.l10n.setLocale(this.locale),this.setLocalizedTexts(),this.preLocaleObj=(0,i._W)("currentLocale",this.l10n);break;case"cssClass":this.setCSSClass(t.cssClass)}}},t.prototype.setLocalizedTexts=function(){(0,i.hX)(this.template)&&("string"===typeof this.buttons.browse&&(this.browseButton.innerText="Browse..."===this.buttons.browse?this.localizedTexts("Browse"):this.buttons.browse,this.browseButton.setAttribute("title",this.browseButton.innerText),this.uploadWrapper&&!(0,i.hX)(this.uploadWrapper.querySelector("."+p))&&(this.uploadWrapper.querySelector("."+p).innerHTML=this.localizedTexts("dropFilesHint"))),this.updateFileList())},t.prototype.getKeyValue=function(e){for(var t,n=0,i=Object.keys(this.preLocaleObj);n<i.length;n++){var o=i[n];this.preLocaleObj[o]===e&&(t=o)}return t},t.prototype.updateFileList=function(){if(this.fileList.length>0&&!(0,i.hX)(this.uploadWrapper.querySelector("."+c)))for(var e=0;e<this.fileList.length;e++)this.fileList[e].querySelector(".e-file-status").innerHTML=this.localizedTexts(this.getKeyValue(this.filesData[e].status)),this.filesData[e].status=this.localizedTexts(this.getKeyValue(this.filesData[e].status)),this.fileList[e].classList.contains(D)&&this.fileList[e].querySelector(".e-icons").setAttribute("title",this.localizedTexts("delete")),this.fileList[e].querySelector(".e-file-play-btn")&&this.fileList[e].querySelector(".e-icons").setAttribute("title",this.localizedTexts("resume")),this.fileList[e].querySelector(".e-file-remove-btn")&&this.fileList[e].querySelector(".e-icons").setAttribute("title",this.localizedTexts("remove")),this.fileList[e].querySelector(".e-file-reload-btn")&&this.fileList[e].querySelector(".e-icons").setAttribute("title",this.localizedTexts("retry")),this.autoUpload||(this.uploadButton.innerText="Upload"===this.buttons.upload?this.localizedTexts("Upload"):this.buttons.upload,this.uploadButton.setAttribute("title",this.localizedTexts("Upload")),this.clearButton.innerText="Clear"===this.buttons.clear?this.localizedTexts("Clear"):this.buttons.clear,this.clearButton.setAttribute("title",this.localizedTexts("Clear")))},t.prototype.reRenderFileList=function(){this.listParent&&((0,i.Yo)(this.listParent),this.listParent=null,this.fileList=[],this.createFileList(this.filesData),this.actionButtons&&(this.removeActionButtons(),this.renderActionButtons(),this.checkActionButtonStatus()))},t.prototype.preRender=function(){this.localeText={Browse:"Browse...",Clear:"Clear",Upload:"Upload",dropFilesHint:"Or drop files here",invalidMaxFileSize:"File size is too large",invalidMinFileSize:"File size is too small",invalidFileType:"File type is not allowed",uploadFailedMessage:"File failed to upload",uploadSuccessMessage:"File uploaded successfully",removedSuccessMessage:"File removed successfully",removedFailedMessage:"Unable to remove file",inProgress:"Uploading",readyToUploadMessage:"Ready to upload",abort:"Abort",remove:"Remove",cancel:"Cancel",delete:"Delete file",pauseUpload:"File upload paused",pause:"Pause",resume:"Resume",retry:"Retry",fileUploadCancel:"File upload canceled",invalidFileSelection:"Invalid files selected",totalFiles:"Total files",size:"Size"},this.l10n=new i.Wo("uploader",this.localeText,this.locale),this.preLocaleObj=(0,i._W)("currentLocale",this.l10n),this.formRendered(),this.updateHTMLAttrToElement(),this.checkHTMLAttributes(!1);var e=(0,i._W)("ej2_instances",this.element);if("EJS-UPLOADER"===this.element.tagName){for(var t=this.createElement("input",{attrs:{type:"file"}}),n=0;n<this.element.attributes.length;n++)t.setAttribute(this.element.attributes[n].nodeName,this.element.attributes[n].nodeValue),t.innerHTML=this.element.innerHTML;t.hasAttribute("name")||t.setAttribute("name","UploadFiles"),this.element.appendChild(t),this.element=t,(0,i.KY)("ej2_instances",e,this.element)}e[0].isPureReactComponent&&((0,i.hX)(e[0].props.name)?!(0,i.hX)(e[0].props.id)&&(0,i.hX)(e[0].props.name)?this.element.setAttribute("name",e[0].props.id):this.element.setAttribute("name","UploadFiles"):this.element.setAttribute("name",e[0].props.name)),(0,i.hX)(this.element.getAttribute("name"))&&this.element.setAttribute("name",this.element.getAttribute("id")),this.element.hasAttribute("type")||this.element.setAttribute("type","file"),this.updateDirectoryAttributes(),this.keyConfigs={enter:"enter"},this.element.hasAttribute("tabindex")&&(this.tabIndex=this.element.getAttribute("tabindex")),this.browserName=i.Pw.info.name,this.uploaderName=this.element.getAttribute("name")},t.prototype.formRendered=function(){var e=(0,i.kp)(this.element,"form");if(!(0,i.hX)(e))for(;e&&e!==document.documentElement;e=e.parentElement)"FORM"===e.tagName&&(this.isForm=!0,this.formElement=e,e.setAttribute("enctype","multipart/form-data"),e.setAttribute("encoding","multipart/form-data"))},t.prototype.getPersistData=function(){return this.addOnPersist(["filesData"])},t.prototype.getModuleName=function(){return"uploader"},t.prototype.updateDirectoryAttributes=function(){this.directoryUpload?(this.element.setAttribute("directory","true"),this.element.setAttribute("webkitdirectory","true")):(this.element.removeAttribute("directory"),this.element.removeAttribute("webkitdirectory"))},t.prototype.render=function(){this.renderBrowseButton(),this.initializeUpload(),this.updateHTMLAttrToWrapper(),this.wireEvents(),this.setMultipleSelection(),this.setExtensions(this.allowedExtensions),this.setRTL(),this.renderPreLoadFiles(),this.setControlStatus(),this.setCSSClass()},t.prototype.renderBrowseButton=function(){this.browseButton=this.createElement("button",{className:"e-css e-btn",attrs:{type:"button"}}),this.browseButton.setAttribute("tabindex",this.tabIndex),"string"===typeof this.buttons.browse?(this.browseButton.textContent="Browse..."===this.buttons.browse?this.localizedTexts("Browse"):this.buttons.browse,this.browseButton.setAttribute("title",this.browseButton.innerText)):this.browseButton.appendChild(this.buttons.browse),this.element.setAttribute("aria-label","Uploader")},t.prototype.renderActionButtons=function(){this.element.setAttribute("tabindex","-1"),this.actionButtons=this.createElement("div",{className:"e-upload-actions"}),this.uploadButton=this.createElement("button",{className:"e-file-upload-btn e-css e-btn e-flat e-primary",attrs:{type:"button",tabindex:this.btnTabIndex}}),this.clearButton=this.createElement("button",{className:"e-file-clear-btn e-css e-btn e-flat",attrs:{type:"button",tabindex:this.btnTabIndex}}),this.actionButtons.appendChild(this.clearButton),this.actionButtons.appendChild(this.uploadButton),this.renderButtonTemplates(),this.uploadWrapper.appendChild(this.actionButtons),this.browseButton.blur(),this.isPreloadFiles||this.uploadButton.focus(),this.wireActionButtonEvents()},t.prototype.serverActionButtonsEventBind=function(e){e&&!this.isForm&&(this.browseButton.blur(),this.actionButtons=e,this.uploadButton=this.actionButtons.querySelector(".e-file-upload-btn"),this.clearButton=this.actionButtons.querySelector(".e-file-clear-btn"),this.uploadButton.focus(),this.unwireActionButtonEvents(),this.wireActionButtonEvents(),this.checkActionButtonStatus())},t.prototype.wireActionButtonEvents=function(){i.Jm.add(this.uploadButton,"click",this.uploadButtonClick,this),i.Jm.add(this.clearButton,"click",this.clearButtonClick,this)},t.prototype.unwireActionButtonEvents=function(){i.Jm.remove(this.uploadButton,"click",this.uploadButtonClick),i.Jm.remove(this.clearButton,"click",this.clearButtonClick)},t.prototype.removeActionButtons=function(){this.actionButtons&&(this.unwireActionButtonEvents(),(0,i.Yo)(this.actionButtons),this.actionButtons=null)},t.prototype.renderButtonTemplates=function(){if("string"===typeof this.buttons.browse?(this.browseButton.textContent="Browse..."===this.buttons.browse?this.localizedTexts("Browse"):this.buttons.browse,this.browseButton.setAttribute("title",this.browseButton.textContent)):(this.browseButton.innerHTML="",this.browseButton.appendChild(this.buttons.browse)),this.uploadButton){var e=(0,i.hX)(this.buttons.upload)?"Upload":this.buttons.upload;this.buttons.upload=e,"string"===typeof this.buttons.upload?(this.uploadButton.textContent="Upload"===this.buttons.upload?this.localizedTexts("Upload"):this.buttons.upload,this.uploadButton.setAttribute("title",this.uploadButton.textContent)):(this.uploadButton.innerHTML="",this.uploadButton.appendChild(this.buttons.upload))}if(this.clearButton){var t=(0,i.hX)(this.buttons.clear)?"Clear":this.buttons.clear;this.buttons.clear=t,"string"===typeof this.buttons.clear?(this.clearButton.textContent="Clear"===this.buttons.clear?this.localizedTexts("Clear"):this.buttons.clear,this.clearButton.setAttribute("title",this.clearButton.textContent)):(this.clearButton.innerHTML="",this.clearButton.appendChild(this.buttons.clear))}},t.prototype.initializeUpload=function(){this.element.setAttribute("tabindex","-1");var e=this.createElement("span",{className:h});this.element.parentElement.insertBefore(e,this.element),this.dropAreaWrapper=this.createElement("div",{className:"e-file-select-wrap"}),this.element.parentElement.insertBefore(this.dropAreaWrapper,this.element),e.appendChild(this.element),this.dropAreaWrapper.appendChild(this.browseButton),this.dropAreaWrapper.appendChild(e),this.uploadWrapper=this.createElement("div",{className:"e-upload e-control-wrapper"}),this.dropAreaWrapper.parentElement.insertBefore(this.uploadWrapper,this.dropAreaWrapper),this.uploadWrapper.appendChild(this.dropAreaWrapper),this.setDropArea()},t.prototype.renderPreLoadFiles=function(){if(this.files.length){if(this.enablePersistence&&this.filesData.length)return void this.createFileList(this.filesData);if((0,i.hX)(this.files[0].size))return;this.isPreloadFiles=!0;var e=[].slice.call(this.files),t=[];this.multiple||(this.clearData(),e=[e[0]]);for(var n=0,o=e;n<o.length;n++){var r=o[n],a={name:r.name+"."+r.type.split(".")[r.type.split(".").length-1],rawFile:"",size:r.size,status:this.localizedTexts("uploadSuccessMessage"),type:r.type,validationMessages:{minSize:"",maxSize:""},statusCode:"2"};t.push(a),this.filesData.push(a)}this.createFileList(t),this.autoUpload||!this.listParent||this.actionButtons||this.isForm&&!this.allowUpload()||!this.showFileList||this.renderActionButtons(),this.checkActionButtonStatus(),this.sequentialUpload&&(this.count=this.filesData.length-1),this.isPreloadFiles=!1}},t.prototype.checkActionButtonStatus=function(){if(this.actionButtons){var e=this.uploadWrapper.querySelectorAll("."+A).length+this.uploadWrapper.querySelectorAll(".e-upload-fails:not(.e-upload-progress)").length+this.uploadWrapper.querySelectorAll("span."+D).length+this.uploadWrapper.querySelectorAll("span."+L).length;e>0&&e===this.uploadWrapper.querySelectorAll("li").length?this.uploadButton.setAttribute("disabled","disabled"):this.uploadButton.removeAttribute("disabled")}},t.prototype.setDropArea=function(){var e=this.dropAreaWrapper.querySelector(".e-file-drop");if(this.dropArea){this.dropZoneElement="string"!==typeof this.dropArea?this.dropArea:(0,i.Lt)(this.dropArea,document);for(var t=this.element,n=!1;t.parentNode;)(t=t.parentNode)===this.dropZoneElement&&(n=!0,e?e.innerHTML=this.localizedTexts("dropFilesHint"):this.createDropTextHint());!n&&e&&(0,i.TF)(e)}else(0,i.hX)(this.uploaderOptions)||void 0!==this.uploaderOptions.dropArea||(this.createDropTextHint(),this.dropZoneElement=this.uploadWrapper,this.setProperties({dropArea:this.uploadWrapper},!0));this.bindDropEvents()},t.prototype.updateDropArea=function(){if(this.dropArea)this.setDropArea();else{this.dropZoneElement=null;var e=this.dropAreaWrapper.querySelector(".e-file-drop");e&&(0,i.TF)(e)}},t.prototype.createDropTextHint=function(){var e=this.createElement("span",{className:p});e.innerHTML=this.localizedTexts("dropFilesHint"),this.dropAreaWrapper.appendChild(e)},t.prototype.updateHTMLAttrToElement=function(){if(!(0,i.hX)(this.htmlAttributes))for(var e=0,t=Object.keys(this.htmlAttributes);e<t.length;e++){var n=t[e];X.indexOf(n)<0&&this.element.setAttribute(n,this.htmlAttributes[n])}},t.prototype.updateHTMLAttrToWrapper=function(){if(!(0,i.hX)(this.htmlAttributes))for(var e=0,t=Object.keys(this.htmlAttributes);e<t.length;e++){var n=t[e];if(X.indexOf(n)>-1)if("class"===n){var o=this.htmlAttributes[n].replace(/\s+/g," ").trim();""!==o&&(0,i.iQ)([this.uploadWrapper],o.split(" "))}else if("style"===n){var r=this.uploadWrapper.getAttribute(n);r=(0,i.hX)(r)?this.htmlAttributes[n]:r+this.htmlAttributes[n],this.uploadWrapper.setAttribute(n,r)}else this.uploadWrapper.setAttribute(n,this.htmlAttributes[n])}},t.prototype.setMultipleSelection=function(){if(this.multiple&&!this.element.hasAttribute("multiple")){var e=document.createAttribute("multiple");e.value="multiple",this.element.setAttributeNode(e)}else this.multiple||this.element.removeAttribute("multiple")},t.prototype.checkAutoUpload=function(e){this.autoUpload?(this.sequentialUpload?this.sequenceUpload(e):this.upload(e),this.removeActionButtons()):this.actionButtons||this.renderActionButtons(),this.checkActionButtonStatus()},t.prototype.sequenceUpload=function(e){if(this.filesData.length-e.length===0||"1"!==this.filesData[this.filesData.length-e.length-1].statusCode){++this.count;var t=!this.showFileList;"object"===typeof this.filesData[this.count]?(this.isFirstFileOnSelection=!1,this.upload(this.filesData[this.count],t),"0"===this.filesData[this.count].statusCode&&this.sequenceUpload(e)):--this.count}},t.prototype.setCSSClass=function(e){var t=this.cssClass;(0,i.hX)(this.cssClass)||""===this.cssClass||(t=this.cssClass.replace(/\s+/g," ").trim()),(0,i.hX)(this.cssClass)||""===t||(0,i.iQ)([this.uploadWrapper],t.split(t.indexOf(",")>-1?",":" "));var n=e;(0,i.hX)(e)||(n=e.replace(/\s+/g," ").trim()),(0,i.hX)(e)||""===n||(0,i.vy)([this.uploadWrapper],n.split(" "))},t.prototype.wireEvents=function(){i.Jm.add(this.browseButton,"click",this.browseButtonClick,this),i.Jm.add(this.element,"change",this.onSelectFiles,this),i.Jm.add(document,"click",this.removeFocus,this),this.keyboardModule=new i.j9(this.uploadWrapper,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),this.isForm&&i.Jm.add(this.formElement,"reset",this.resetForm,this)},t.prototype.unWireEvents=function(){i.Jm.remove(this.browseButton,"click",this.browseButtonClick),i.Jm.remove(this.element,"change",this.onSelectFiles),i.Jm.remove(document,"click",this.removeFocus),this.isForm&&i.Jm.remove(this.formElement,"reset",this.resetForm),this.keyboardModule&&this.keyboardModule.destroy()},t.prototype.resetForm=function(){this.clearAll()},t.prototype.keyActionHandler=function(e){var t=e.target;if("enter"===e.action){if(e.target===this.clearButton)this.clearButtonClick();else if(e.target===this.uploadButton)this.uploadButtonClick();else if(e.target===this.browseButton)this.browseButtonClick();else if(t.classList.contains(P)){(n=this.getCurrentMetaData(null,e)).file.statusCode="4",n.file.status=this.localizedTexts("pauseUpload"),this.abortUpload(n,!1)}else if(t.classList.contains(F))this.resumeUpload(this.getCurrentMetaData(null,e),e);else if(t.classList.contains(E)){var n=this.getCurrentMetaData(null,e);if((0,i.hX)(n)){var o=e.target.parentElement,r=this.filesData[this.fileList.indexOf(o)];this.retry(r)}else n.file.statusCode="1",n.file.status=this.localizedTexts("readyToUploadMessage"),this.chunkUpload(n.file)}else this.removeFiles(e),t.classList.contains(S)||this.browseButton.focus();e.preventDefault(),e.stopPropagation()}},t.prototype.getCurrentMetaData=function(e,t){var n,o;if((0,i.hX)(e)){var r=t.target.parentElement;n=this.filesData[this.fileList.indexOf(r)]}else n=e;for(var a=0;a<this.uploadMetaData.length;a++)this.uploadMetaData[a].file.name===n.name&&(o=this.uploadMetaData[a]);return o},t.prototype.removeFocus=function(){this.uploadWrapper&&this.listParent&&this.listParent.querySelector("."+B)&&(document.activeElement.blur(),this.listParent.querySelector("."+B).classList.remove(B))},t.prototype.browseButtonClick=function(){this.element.click()},t.prototype.uploadButtonClick=function(){this.sequentialUpload?this.sequenceUpload(this.filesData):this.upload(this.filesData)},t.prototype.clearButtonClick=function(){this.clearAll(),this.sequentialUpload&&(this.count=-1),this.actionCompleteCount=0},t.prototype.bindDropEvents=function(){this.dropZoneElement&&(i.Jm.add(this.dropZoneElement,"drop",this.dropElement,this),i.Jm.add(this.dropZoneElement,"dragover",this.dragHover,this),i.Jm.add(this.dropZoneElement,"dragleave",this.onDragLeave,this),i.Jm.add(this.dropZoneElement,"paste",this.onPasteFile,this),i.Jm.add(this.dropZoneElement,"dragenter",this.onDragEnter,this))},t.prototype.unBindDropEvents=function(){this.dropZoneElement&&(i.Jm.remove(this.dropZoneElement,"drop",this.dropElement),i.Jm.remove(this.dropZoneElement,"dragover",this.dragHover),i.Jm.remove(this.dropZoneElement,"dragleave",this.onDragLeave),i.Jm.remove(this.dropZoneElement,"dragenter",this.onDragEnter))},t.prototype.onDragEnter=function(e){this.enabled&&(this.dropZoneElement.classList.add(w),this.dragCounter=this.dragCounter+1,e.preventDefault(),e.stopPropagation())},t.prototype.onDragLeave=function(){this.enabled&&(this.dragCounter=this.dragCounter-1,this.dragCounter||this.dropZoneElement.classList.remove(w))},t.prototype.dragHover=function(e){this.enabled&&("Default"!==this.dropEffect&&(e.dataTransfer.dropEffect=this.dropEffect.toLowerCase()),e.preventDefault(),e.stopPropagation())},t.prototype.dropElement=function(e){this.dragCounter=0,this.dropZoneElement.classList.remove(w),this.onSelectFiles(e),e.preventDefault(),e.stopPropagation()},t.prototype.onPasteFile=function(e){var t=e.clipboardData.items;if(1===t.length){var n=[].slice.call(t)[0];"file"===n.kind&&n.type.match("^image/")&&this.renderSelectedFiles(e,[n.getAsFile()],!1,!0)}},t.prototype.getSelectedFiles=function(e){for(var t=[],n=this.fileList[e],i=this.getFilesData(),o=+n.getAttribute("data-files-count"),r=0,a=0;a<e;a++)r+=+this.fileList[a].getAttribute("data-files-count");for(var s=r;s<r+o;s++)t.push(i[s]);return t},t.prototype.removeFiles=function(e){if(this.enabled){var t=e.target.parentElement,n=this.fileList.indexOf(t),o=this.fileList[n],r=this.isFormUpload(),a=r?this.getSelectedFiles(n):this.getFilesInArray(this.filesData[n]);if(!(0,i.hX)(a)){if(e.target.classList.contains(S)&&!r){if(a[0].statusCode="5",!(0,i.hX)(o)){var l=o.querySelector("."+S);(0,s.GF)({target:l,width:"20px"}),(0,s.xc)(l)}this.sequentialUpload&&this.uploadSequential(),o.classList.contains(H)||this.checkActionComplete(!0)}else(0,i.kp)(e.target,"."+C)||this.remove(a,!1,!1,!0,e);this.element.value="",this.checkActionButtonStatus()}}},t.prototype.removeFilesData=function(e,t){var n;if(t)this.showFileList||(n=this.filesData.indexOf(e),this.filesData.splice(n,1));else{var o=this.getLiElement(e);(0,i.hX)(o)||((0,i.Yo)(o),n=this.fileList.indexOf(o),this.fileList.splice(n,1),this.filesData.splice(n,1),0!==this.fileList.length||(0,i.hX)(this.listParent)||((0,i.Yo)(this.listParent),this.listParent=null,this.removeActionButtons()),this.sequentialUpload&&n<=this.count&&--this.count)}},t.prototype.removeUploadedFile=function(e,t,n,o){var r=this,a=e,s=new i.dj(this.asyncSettings.removeUrl,"POST",!0,null);s.emitError=!1;var l=new FormData;s.beforeSend=function(i){t.currentRequest=s.httpRequest,n?r.removingEventCallback(t,l,a,e):r.trigger("removing",t,(function(t){t.cancel?i.cancel=!0:r.removingEventCallback(t,l,a,e)}))},s.onLoad=function(e){return r.removeCompleted(e,a,o),{}},s.onError=function(e){return r.removeFailed(e,a,o),{}},s.send(l)},t.prototype.removingEventCallback=function(e,t,n,o){var r=this.element.getAttribute("name"),a=this.getLiElement(o);if(!(0,i.hX)(a)&&(!(0,i.hX)(a.querySelector("."+y))||!(0,i.hX)(a.querySelector("."+v)))){var l=a.querySelector("."+y)?a.querySelector("."+y):a.querySelector("."+v);(0,s.GF)({target:l,width:"20px"}),(0,s.xc)(l)}e.postRawFile&&!(0,i.hX)(n.rawFile)&&""!==n.rawFile?t.append(r,n.rawFile,n.name):t.append(r,n.name),this.updateFormData(t,e.customFormData)},t.prototype.updateFormData=function(e,t){if(t.length>0&&t[0])for(var n=function(n){var i=t[n],o=Object.keys(i).map((function(e){return i[e]}));e.append(Object.keys(i)[0],o)},i=0;i<t.length;i++)n(i)},t.prototype.updateCustomheader=function(e,t){if(t.length>0&&t[0])for(var n=function(n){var i=t[n],o=Object.keys(i).map((function(e){return i[e]}));e.setRequestHeader(Object.keys(i)[0],o)},i=0;i<t.length;i++)n(i)},t.prototype.removeCompleted=function(e,t,n){var i=e&&e.currentTarget?this.getResponse(e):null,o=e.target;if(4===o.readyState&&o.status>=200&&o.status<=299){var r={e:e,response:i,operation:"remove",file:this.updateStatus(t,this.localizedTexts("removedSuccessMessage"),"2")};this.trigger("success",r),this.removeFilesData(t,n);var a=this.uploadedFilesData.indexOf(t);this.uploadedFilesData.splice(a,1),this.trigger("change",{files:this.uploadedFilesData})}else this.removeFailed(e,t,n)},t.prototype.removeFailed=function(e,t,n){var o={e:e,response:e&&e.currentTarget?this.getResponse(e):null,operation:"remove",file:this.updateStatus(t,this.localizedTexts("removedFailedMessage"),"0")};if(!n){var r=this.filesData.indexOf(t),a=this.fileList[r];if(a){a.classList.remove(D),a.classList.add(x);var l=a.querySelector("."+m);l&&(l.classList.remove(D),l.classList.add(x))}this.checkActionButtonStatus()}this.trigger("failure",o);var d=this.getLiElement(t);if(!(0,i.hX)(d)&&!(0,i.hX)(d.querySelector("."+y))){var h=d.querySelector("."+y);(0,s.W$)(h),(0,i.Yo)(d.querySelector(".e-spinner-pane"))}},t.prototype.getFilesFromFolder=function(e){this.filesEntries=[];var t=this.multiple?e.dataTransfer.items:[e.dataTransfer.items[0]];if(this.checkDirectoryUpload(t))for(var n=function(n){var o=t[n].webkitGetAsEntry();if(o.isFile){var r=[];o.file((function(e){var t=o.fullPath;r.push({path:t,file:e})})),i.renderSelectedFiles(e,r,!0)}else o.isDirectory&&i.traverseFileTree(o,e)},i=this,o=0;o<t.length;o++)n(o)},t.prototype.checkDirectoryUpload=function(e){for(var t=0;e&&t<e.length;t++){if(e[t].webkitGetAsEntry().isDirectory)return!0}return!1},t.prototype.traverseFileTree=function(e,t){if(e.isFile)this.filesEntries.push(e);else if(e.isDirectory){var n=e.createReader();this.readFileFromDirectory(n,t)}},t.prototype.readFileFromDirectory=function(e,t){var n=this;e.readEntries((function(i){for(var o=0;o<i.length;o++)n.traverseFileTree(i[o],t);n.pushFilesEntries(t),i.length&&n.readFileFromDirectory(e)}))},t.prototype.pushFilesEntries=function(e){for(var t=this,n=[],i=function(i){o.filesEntries[i].file((function(o){if(t.filesEntries.length){var r=t.filesEntries[i].fullPath;n.push({path:r,file:o}),i===t.filesEntries.length-1&&(t.filesEntries=[],t.renderSelectedFiles(e,n,!0))}}))},o=this,r=0;r<this.filesEntries.length;r++)i(r)},t.prototype.onSelectFiles=function(e){var t;if(this.enabled)if("drop"===e.type)if(this.directoryUpload)this.getFilesFromFolder(e);else{var n=this.sortFilesList=e.dataTransfer.files;"msie"!==this.browserName&&"edge"!==this.browserName&&"safari"!==this.browserName&&(this.element.files=n),n.length>0&&(t=this.multiple?this.sortFileList(n):[n[0]],this.renderSelectedFiles(e,t))}else t=[].slice.call(e.target.files),this.renderSelectedFiles(e,t)},t.prototype.getBase64=function(e){return new Promise((function(t,n){var i=new FileReader;i.readAsDataURL(e),i.onload=function(){return t(i.result)},i.onerror=function(e){return n(e)}}))},t.prototype.renderSelectedFiles=function(e,t,n,i){var o=this;this.base64String=[];var r={event:e,cancel:!1,filesData:[],isModified:!1,modifiedFilesData:[],progressInterval:"",isCanceled:!1,currentRequest:null,customFormData:null};if(t.length<1)return r.isCanceled=!0,void this.trigger("selected",r);this.flag=!0;var a=[];this.multiple||(this.clearData(!0),t=[t[0]]);for(var s=0;s<t.length;s++){var l=n?t[s].file:t[s];this.updateInitialFileDetails(e,t,l,s,a,n,i)}r.filesData=a,this.allowedExtensions.indexOf("*")>-1&&(this.allTypes=!0),this.allTypes||(a=this.checkExtension(a)),this.trigger("selected",r,(function(e){o._internalRenderSelect(e,a)}))},t.prototype.updateInitialFileDetails=function(e,t,n,o,r,a,s){var l={name:a?t[o].path.substring(1,t[o].path.length):s?(0,i.Lz)(n.name.substring(0,n.name.lastIndexOf(".")))+"."+this.getFileType(n.name):this.directoryUpload?t[o].webkitRelativePath:n.name,rawFile:n,size:n.size,status:this.localizedTexts("readyToUploadMessage"),type:this.getFileType(n.name),validationMessages:this.validatedFileSize(n.size),statusCode:"1",id:(0,i.Lz)(n.name.substring(0,n.name.lastIndexOf(".")))+"."+this.getFileType(n.name)};s&&(l.fileSource="paste"),l.status=""!==l.validationMessages.minSize?this.localizedTexts("invalidMinFileSize"):""!==l.validationMessages.maxSize?this.localizedTexts("invalidMaxFileSize"):l.status,""===l.validationMessages.minSize&&""===l.validationMessages.maxSize||(l.statusCode="0"),r.push(l)},t.prototype._internalRenderSelect=function(e,t){if(!e.cancel){if(this.selectedFiles=this.selectedFiles.concat(t),this.btnTabIndex=this.disableKeyboardNavigation?"-1":"0",this.showFileList){if(e.isModified&&e.modifiedFilesData.length>0){for(var n=0;n<e.modifiedFilesData.length;n++)for(var o=0;o<t.length;o++)e.modifiedFilesData[n].id===t[o].id&&(e.modifiedFilesData[n].rawFile=t[o].rawFile);var r=this.allTypes?e.modifiedFilesData:this.checkExtension(e.modifiedFilesData);this.updateSortedFileList(r),this.filesData=r,this.isForm&&!this.allowUpload()||this.checkAutoUpload(r)}else this.createFileList(t,!0),this.filesData=this.filesData.concat(t),this.isForm&&!this.allowUpload()||this.checkAutoUpload(t);(0,i.hX)(e.progressInterval)||""===e.progressInterval||(this.progressInterval=e.progressInterval)}else this.filesData=this.filesData.concat(t),this.autoUpload&&this.upload(this.filesData,!0);this.raiseActionComplete(),this.isFirstFileOnSelection=!0}},t.prototype.allowUpload=function(){var e=!1;return this.isForm&&!(0,i.hX)(this.asyncSettings.saveUrl)&&""!==this.asyncSettings.saveUrl&&(e=!0),e},t.prototype.isFormUpload=function(){var e=!1;return!this.isForm||!(0,i.hX)(this.asyncSettings.saveUrl)&&""!==this.asyncSettings.saveUrl||!(0,i.hX)(this.asyncSettings.removeUrl)&&""!==this.asyncSettings.removeUrl||(e=!0),e},t.prototype.clearData=function(e){(0,i.hX)(this.listParent)||((0,i.Yo)(this.listParent),this.listParent=null),"msie"===this.browserName||e||(this.element.value=""),this.fileList=[],this.filesData=[],this.removeActionButtons()},t.prototype.updateSortedFileList=function(e){var t=this.createElement("div",{id:"clonewrapper"}),n=-1;if(this.listParent){for(var o=0;o<this.listParent.querySelectorAll("li").length;o++){var r=this.listParent.querySelectorAll("li")[o];t.appendChild(r.cloneNode(!0))}for(var a=0,s=this.listParent.querySelectorAll("li");a<s.length;a++){var l=s[a];(0,i.Yo)(l)}this.removeActionButtons();var d=[].slice.call(t.childNodes);(0,i.Yo)(this.listParent),this.listParent=null,this.fileList=[],this.createParentUL();for(var h=0;h<e.length;h++){for(var p=0;p<this.filesData.length;p++)this.filesData[p].name===e[h].name&&(this.listParent.appendChild(d[p]),i.Jm.add(d[p].querySelector(".e-icons"),"click",this.removeFiles,this),this.fileList.push(d[p]),n=h);n!==h&&this.createFileList([e[h]])}}else this.createFileList(e)},t.prototype.isBlank=function(e){return!e||/^\s*$/.test(e)},t.prototype.checkExtension=function(e){var t=e;if(!this.isBlank(this.allowedExtensions)){for(var n=[],i=0,o=this.allowedExtensions.split(",");i<o.length;i++){var r=o[i];n.push(r.trim().toLocaleLowerCase())}for(var a=0;a<e.length;a++)-1===n.indexOf(("."+e[a].type).toLocaleLowerCase())&&(e[a].status=this.localizedTexts("invalidFileType"),e[a].statusCode="0")}return t},t.prototype.validatedFileSize=function(e){var t="",n="";return e<this.minFileSize?t=this.localizedTexts("invalidMinFileSize"):e>this.maxFileSize?n=this.localizedTexts("invalidMaxFileSize"):(t="",n=""),{minSize:t,maxSize:n}},t.prototype.isPreLoadFile=function(e){for(var t=!1,n=0;n<this.files.length;n++)this.files[n].name===e.name.slice(0,e.name.lastIndexOf("."))&&this.files[n].type===e.type&&(t=!0);return t},t.prototype.createCustomfileList=function(e){this.createParentUL();for(var t=0,n=e;t<n.length;t++){var o=n[t],r=this.createElement("li",{className:u,attrs:{"data-file-name":o.name}});this.uploadTemplateFn=this.templateComplier(this.template);var a=this.uploadTemplateFn(o,this,"template",this.element.id+"Template",this.isStringTemplate,null,r);if(a){var s=[].slice.call(a);(0,i.BC)(s,r)}var l=e.indexOf(o),d={element:r,fileInfo:o,index:l,isPreload:this.isPreLoadFile(o)},h={element:r,fileInfo:o,index:l,isPreload:this.isPreLoadFile(o)};this.trigger("rendering",d),this.trigger("fileListRendering",h),this.listParent.appendChild(r),this.fileList.push(r)}this.renderReactTemplates()},t.prototype.createParentUL=function(){(0,i.hX)(this.listParent)&&(this.listParent=this.createElement("ul",{className:c}),this.uploadWrapper.appendChild(this.listParent))},t.prototype.formFileList=function(e,t){var n=this.createElement("li",{className:u});n.setAttribute("data-files-count",e.length+"");for(var o,r=this.createElement("span",{className:M}),a=0,s=e;a<s.length;a++){var l=s[a],d=this.createElement("span",{className:g});d.innerHTML=this.getFileNameOnly(l.name);var h=this.createElement("span",{className:f}),p=this.getFileType(l.name);if(h.innerHTML="."+p,p||h.classList.add("e-hidden"),this.enableRtl){var c=this.createElement("span",{className:I});c.appendChild(h),c.appendChild(d),r.appendChild(c)}else r.appendChild(d),r.appendChild(h);this.truncateName(d),o=this.formValidateFileInfo(l,n)}n.appendChild(r),this.setListToFileInfo(e,n);var y=this.listParent.querySelectorAll("li").length,C=this.createElement("span");if(n.classList.contains(z)?(C.classList.add(m),C.classList.add(z),C.innerText=e.length>1?this.localizedTexts("invalidFileSelection"):o):(C.classList.add(e.length>1?"e-file-information":b),C.innerText=e.length>1?this.localizedTexts("totalFiles")+": "+e.length+" , "+this.localizedTexts("size")+": "+this.bytesToSize(this.getFileSize(e)):this.bytesToSize(e[0].size),this.createFormInput(e)),r.appendChild(C),(0,i.hX)(n.querySelector(".e-icons"))){var S=this.createElement("span",{className:"e-icons",attrs:{tabindex:this.btnTabIndex}});"msie"===this.browserName&&S.classList.add("e-msie"),S.setAttribute("title",this.localizedTexts("remove")),n.appendChild(r),n.appendChild(S),i.Jm.add(S,"click",this.removeFiles,this),S.classList.add(v)}var E={element:n,fileInfo:this.mergeFileInfo(e,n),index:y,isPreload:this.isPreLoadFile(this.mergeFileInfo(e,n))},w={element:n,fileInfo:this.mergeFileInfo(e,n),index:y,isPreload:this.isPreLoadFile(this.mergeFileInfo(e,n))};this.trigger("rendering",E),this.trigger("fileListRendering",w),this.listParent.appendChild(n),this.fileList.push(n)},t.prototype.formValidateFileInfo=function(e,t){var n=e.status,i=this.validatedFileSize(e.size);""===i.minSize&&""===i.maxSize||(this.addInvalidClass(t),n=""!==i.minSize?this.localizedTexts("invalidMinFileSize"):""!==i.maxSize?this.localizedTexts("invalidMaxFileSize"):n);var o=this.checkExtension(this.getFilesInArray(e))[0].status;return o===this.localizedTexts("invalidFileType")&&(this.addInvalidClass(t),n=o),n},t.prototype.addInvalidClass=function(e){e.classList.add(z)},t.prototype.createFormInput=function(e){var t=this.element.cloneNode(!0);t.classList.add("e-hidden-file-input");for(var n=0,i=e;n<i.length;n++){i[n].input=t}t.setAttribute("name",this.uploaderName),this.uploadWrapper.querySelector("."+h).appendChild(t),"msie"!==this.browserName&&"edge"!==this.browserName&&(this.element.value="")},t.prototype.getFileSize=function(e){for(var t=0,n=0,i=e;n<i.length;n++){t+=i[n].size}return t},t.prototype.mergeFileInfo=function(e,t){for(var n={name:"",rawFile:"",size:0,status:"",type:"",validationMessages:{minSize:"",maxSize:""},statusCode:"1",list:t},i=[],o="",r=0,a=e;r<a.length;r++){var s=a[r];i.push(s.name),o=s.type}return n.name=i.join(", "),n.size=this.getFileSize(e),n.type=o,n.status=this.statusForFormUpload(e,t),n},t.prototype.statusForFormUpload=function(e,t){for(var n,i=!0,o=0,r=e;o<r.length;o++){var a=r[o];n=a.status;var s=this.validatedFileSize(a.size);""===s.minSize&&""===s.maxSize||(i=!1,n=""!==s.minSize?this.localizedTexts("invalidMinFileSize"):""!==s.maxSize?this.localizedTexts("invalidMaxFileSize"):n);var l=this.checkExtension(this.getFilesInArray(a))[0].status;l===this.localizedTexts("invalidFileType")&&(i=!1,n=l)}return i?n=this.localizedTexts("totalFiles")+": "+e.length+" , "+this.localizedTexts("size")+": "+this.bytesToSize(this.getFileSize(e)):(t.classList.add(z),n=e.length>1?this.localizedTexts("invalidFileSelection"):n),n},t.prototype.formCustomFileList=function(e,t){this.createParentUL();var n=this.createElement("li",{className:u});n.setAttribute("data-files-count",e.length+""),this.setListToFileInfo(e,n);var o=this.mergeFileInfo(e,n);n.setAttribute("data-file-name",o.name),this.uploadTemplateFn=this.templateComplier(this.template);var r=this.uploadTemplateFn(o,this,"template",this.element.id+"Template",this.isStringTemplate,null,n);if(r){var a=[].slice.call(r);(0,i.BC)(a,n)}var s=this.listParent.querySelectorAll("li").length;n.classList.contains(z)||this.createFormInput(e);var l={element:n,fileInfo:o,index:s,isPreload:this.isPreLoadFile(o)},d={element:n,fileInfo:o,index:s,isPreload:this.isPreLoadFile(o)};this.trigger("rendering",l),this.trigger("fileListRendering",d),this.listParent.appendChild(n),this.fileList.push(n),this.renderReactTemplates()},t.prototype.createFileList=function(e,t){if(this.createParentUL(),""===this.template||(0,i.hX)(this.template))if(this.isFormUpload())this.uploadWrapper.classList.add(q),this.formFileList(e,this.element.files);else for(var n=0,o=e;n<o.length;n++){var r=o[n],a=this.createElement("li",{className:u,attrs:{"data-file-name":r.name,"data-files-count":"1"}}),s=this.createElement("span",{className:M}),l=this.createElement("span",{className:g,attrs:{title:r.name}});l.innerHTML=this.getFileNameOnly(r.name);var d=this.createElement("span",{className:f}),h=this.getFileType(r.name);if(d.innerHTML="."+h,h||d.classList.add("e-hidden"),this.enableRtl){var p=this.createElement("span",{className:I});p.appendChild(d),p.appendChild(l),s.appendChild(p)}else s.appendChild(l),s.appendChild(d);var c=this.createElement("span",{className:b});c.innerHTML=this.bytesToSize(r.size),s.appendChild(c);var C=this.createElement("span",{className:m});s.appendChild(C),C.innerHTML=r.status,a.appendChild(s);var S=this.createElement("span",{className:" e-icons",attrs:{tabindex:this.btnTabIndex}});"msie"===this.browserName&&S.classList.add("e-msie"),S.setAttribute("title",this.localizedTexts("remove")),a.appendChild(S),i.Jm.add(S,"click",this.removeFiles,this),"2"===r.statusCode?(C.classList.add(D),S.classList.add(y),S.setAttribute("title",this.localizedTexts("delete"))):"1"!==r.statusCode&&(C.classList.remove(D),C.classList.add(A)),this.autoUpload&&"1"===r.statusCode&&""!==this.asyncSettings.saveUrl&&(C.innerHTML=""),S.classList.contains(y)||S.classList.add(v);var E=e.indexOf(r),w={element:a,fileInfo:r,index:E,isPreload:this.isPreLoadFile(r)},T={element:a,fileInfo:r,index:E,isPreload:this.isPreLoadFile(r)};this.trigger("rendering",w),this.trigger("fileListRendering",T),this.listParent.appendChild(a),this.fileList.push(a),this.truncateName(l);var k=this.flag;this.isPreLoadFile(r)&&(this.flag=!1,this.checkActionComplete(!0),this.flag=k)}else this.isFormUpload()?(this.uploadWrapper.classList.add(q),this.formCustomFileList(e,this.element.files)):this.createCustomfileList(e)},t.prototype.getSlicedName=function(e){var t=e.textContent;e.dataset.tail=t.slice(t.length-10)},t.prototype.setListToFileInfo=function(e,t){for(var n=0,i=e;n<i.length;n++){i[n].list=t}},t.prototype.truncateName=function(e){var t=e;("edge"!==this.browserName&&t.offsetWidth<t.scrollWidth||t.offsetWidth+1<t.scrollWidth)&&this.getSlicedName(t)},t.prototype.getFileType=function(e){var t,n=e.lastIndexOf(".");return n>=0&&(t=e.substring(n+1)),t||""},t.prototype.getFileNameOnly=function(e){var t=this.getFileType(e);return e.split("."+t)[0]},t.prototype.setInitialAttributes=function(){if(this.initialAttr.accept&&this.element.setAttribute("accept",this.initialAttr.accept),this.initialAttr.disabled&&this.element.setAttribute("disabled","disabled"),this.initialAttr.multiple){var e=document.createAttribute("multiple");this.element.setAttributeNode(e)}},t.prototype.filterfileList=function(e){for(var t=[],n=0;n<e.length;n++)this.getLiElement(e[n]).classList.contains(D)||t.push(e[n]);return t},t.prototype.updateStatus=function(e,t,n,o){if(void 0===o&&(o=!0),""===t||(0,i.hX)(t)||""===n||(0,i.hX)(n)||(e.status=t,e.statusCode=n),o){var r=this.getLiElement(e);(0,i.hX)(r)||(0,i.hX)(r.querySelector("."+m))||""===t||(0,i.hX)(t)||(r.querySelector("."+m).textContent=t)}return e},t.prototype.getLiElement=function(e){for(var t,n=0;n<this.filesData.length;n++)(0,i.hX)(e)||((0,i.hX)(this.filesData[n].id)||(0,i.hX)(e.id)?this.filesData[n].name!==e.name:this.filesData[n].name!==e.name||this.filesData[n].id!==e.id)||(t=n);return this.fileList[t]},t.prototype.createProgressBar=function(e){var t=this.createElement("span",{className:T}),n=this.createElement("progressbar",{className:k,attrs:{value:"0",max:"100"}}),i=this.createElement("span",{className:"e-progress-inner-wrap"});n.setAttribute("style","width: 0%");var o=this.createElement("span",{className:N});o.textContent="0%",i.appendChild(n),t.appendChild(i),t.appendChild(o),e.querySelector("."+M).appendChild(t)},t.prototype.updateProgressbar=function(e,t){if(!isNaN(Math.round(e.loaded/e.total*100))&&!(0,i.hX)(t.querySelector("."+k)))if((0,i.hX)(this.progressInterval)||""===this.progressInterval)this.changeProgressValue(t,Math.round(e.loaded/e.total*100).toString()+"%");else{var n=Math.round(e.loaded/e.total*100)%parseInt(this.progressInterval,10);0!==n&&100!==n||this.changeProgressValue(t,Math.round(e.loaded/e.total*100).toString()+"%")}},t.prototype.changeProgressValue=function(e,t){e.querySelector("."+k).setAttribute("style","width:"+t),e.querySelector("."+N).textContent=t},t.prototype.uploadInProgress=function(e,t,n,o){var r=this.getLiElement(t);if(!(0,i.hX)(r)||n){if((0,i.hX)(r))this.cancelUploadingFile(t,e,o);else{"5"===t.statusCode&&this.cancelUploadingFile(t,e,o,r),r.querySelectorAll("."+T).length>0||!r.querySelector("."+m)||(r.querySelector("."+m).classList.add(L),this.createProgressBar(r),this.updateProgressBarClasses(r,L),r.querySelector("."+m).classList.remove(x)),this.updateProgressbar(e,r);var a=r.querySelector("."+v);(0,i.hX)(a)||(a.classList.add(S,L),a.setAttribute("title",this.localizedTexts("abort")),a.classList.remove(v))}var s={e:e,operation:"upload",file:this.updateStatus(t,this.localizedTexts("inProgress"),"3")};this.trigger("progress",s)}},t.prototype.cancelUploadingFile=function(e,t,n,o){var r=this;if("5"===e.statusCode){var a={event:t,fileData:e,cancel:!1,customFormData:[]};this.trigger("canceling",a,(function(t){if(t.cancel){if(e.statusCode="3",!(0,i.hX)(o)){var a=o.querySelector("."+S);(0,i.hX)(a)||((0,s.W$)(a),(0,i.Yo)(o.querySelector(".e-spinner-pane")))}}else{n.emitError=!1,n.httpRequest.abort();var l=new FormData;if("5"===e.statusCode){var d=r.element.getAttribute("name");l.append(d,e.name),l.append("cancel-uploading",e.name),r.updateFormData(l,t.customFormData);var h=new i.dj(r.asyncSettings.removeUrl,"POST",!0,null);h.emitError=!1,h.onLoad=function(t){return r.removecanceledFile(t,e),{}},h.send(l)}}}))}},t.prototype.removecanceledFile=function(e,t){var n=this.getLiElement(t);if(!n.querySelector("."+E)&&!(0,i.hX)(n.querySelector("."+S))){this.updateStatus(t,this.localizedTexts("fileUploadCancel"),"5"),this.renderFailureState(e,t,n);var o=n.querySelector("."+v);(0,i.hX)(n)||((0,s.W$)(o),(0,i.hX)(n.querySelector(".e-spinner-pane"))||(0,i.Yo)(n.querySelector(".e-spinner-pane")));var r={event:e,response:e&&e.currentTarget?this.getResponse(e):null,operation:"cancel",file:t};this.trigger("success",r)}},t.prototype.renderFailureState=function(e,t,n){var o=this;this.updateProgressBarClasses(n,x),this.removeProgressbar(n,"failure"),(0,i.hX)(n.querySelector(".e-file-status"))||n.querySelector(".e-file-status").classList.add(x);var r=n.querySelector("."+S);(0,i.hX)(r)||(r.classList.remove(S,L),r.classList.add(v),r.setAttribute("title",this.localizedTexts("remove")),this.pauseButton=this.createElement("span",{className:"e-icons e-file-reload-btn",attrs:{tabindex:this.btnTabIndex}}),r.parentElement.insertBefore(this.pauseButton,r),this.pauseButton.setAttribute("title",this.localizedTexts("retry")),n.querySelector("."+E).addEventListener("click",(function(e){o.reloadcanceledFile(e,t,n,!1)}),!1))},t.prototype.reloadcanceledFile=function(e,t,n,o){t.statusCode="1",t.status=this.localizedTexts("readyToUploadMessage"),o||((0,i.hX)(n.querySelector("."+m))||n.querySelector("."+m).classList.remove(x),(0,i.hX)(n.querySelector("."+E))||(0,i.Yo)(n.querySelector("."+E)),this.pauseButton=null),n.classList.add(H),this.upload([t])},t.prototype.uploadComplete=function(e,t,n){var o=e.target;if(4===o.readyState&&o.status>=200&&o.status<=299){var r=this.getLiElement(t);if((0,i.hX)(r)&&(!n||(0,i.hX)(n)))return;if(!(0,i.hX)(r)){this.updateProgressBarClasses(r,D),this.removeProgressbar(r,"success");var a=r.querySelector("."+S);(0,i.hX)(a)||(a.classList.add(y),a.setAttribute("title",this.localizedTexts("delete")),a.classList.remove(S),a.classList.remove(L))}this.raiseSuccessEvent(e,t)}else this.uploadFailed(e,t)},t.prototype.getResponse=function(e){var t=e.currentTarget;return{readyState:t.readyState,statusCode:t.status,statusText:t.statusText,headers:t.getAllResponseHeaders(),withCredentials:t.withCredentials}},t.prototype.raiseSuccessEvent=function(e,t){var n=this,o=e&&e.currentTarget?this.getResponse(e):null,r=this.localizedTexts("uploadSuccessMessage"),a={e:e,response:o,operation:"upload",file:this.updateStatus(t,r,"2",!1),statusText:r},l=this.getLiElement(t);if(!(0,i.hX)(l)){var d=l.querySelector("."+C);(0,i.hX)(d)||((0,s.W$)(l),(0,i.Yo)(d))}this.trigger("success",a,(function(e){n.updateStatus(t,e.statusText,"2"),n.uploadedFilesData.push(t),n.trigger("change",{file:n.uploadedFilesData}),n.checkActionButtonStatus(),n.fileList.length>0&&(n.getLiElement(t).classList.contains(H)?n.getLiElement(t).classList.remove(H):(n.uploadSequential(),n.checkActionComplete(!0)))}))},t.prototype.uploadFailed=function(e,t){var n=this,o=this.getLiElement(t),r=e&&e.currentTarget?this.getResponse(e):null,a=this.localizedTexts("uploadFailedMessage"),s={e:e,response:r,operation:"upload",file:this.updateStatus(t,a,"0",!1),statusText:a};(0,i.hX)(o)||this.renderFailureState(e,t,o),this.trigger("failure",s,(function(e){n.updateStatus(t,e.statusText,"0"),n.checkActionButtonStatus(),n.uploadSequential(),n.checkActionComplete(!0)}))},t.prototype.uploadSequential=function(){this.sequentialUpload&&(this.autoUpload?this.checkAutoUpload(this.filesData):this.uploadButtonClick())},t.prototype.checkActionComplete=function(e){e?++this.actionCompleteCount:--this.actionCompleteCount,this.raiseActionComplete()},t.prototype.raiseActionComplete=function(){if(this.filesData.length===this.actionCompleteCount&&this.flag){this.flag=!1;var e={fileData:[]};e.fileData=this.getSelectedFileStatus(this.selectedFiles),this.trigger("actionComplete",e)}},t.prototype.getSelectedFileStatus=function(e){for(var t=[],n=0,i=0;i<e.length;i++)for(var o=e[i],r=0;r<this.filesData.length;r++)this.filesData[r].name===o.name&&(t[n]=this.filesData[r],++n);return t},t.prototype.updateProgressBarClasses=function(e,t){var n=e.querySelector("."+k);(0,i.hX)(n)||n.classList.add(t)},t.prototype.removeProgressbar=function(e,t){var n=this;(0,i.hX)(e.querySelector("."+T))||(this.progressAnimation=new i.X5({duration:1250}),this.progressAnimation.animate(e.querySelector("."+T),{name:"FadeOut"}),this.progressAnimation.animate(e.querySelector("."+N),{name:"FadeOut"}),setTimeout((function(){n.animateProgressBar(e,t)}),750))},t.prototype.animateProgressBar=function(e,t){"success"===t?(e.classList.add(D),(0,i.hX)(e.querySelector("."+m))||(e.querySelector("."+m).classList.remove(L),this.progressAnimation.animate(e.querySelector("."+m),{name:"FadeIn"}),e.querySelector("."+m).classList.add(D))):(0,i.hX)(e.querySelector("."+m))||(e.querySelector("."+m).classList.remove(L),this.progressAnimation.animate(e.querySelector("."+m),{name:"FadeIn"}),e.querySelector("."+m).classList.add(x)),e.querySelector("."+T)&&(0,i.Yo)(e.querySelector("."+T))},t.prototype.setExtensions=function(e){""===e||(0,i.hX)(e)?this.element.removeAttribute("accept"):this.element.setAttribute("accept",e)},t.prototype.templateComplier=function(e){if(e)try{if((0,i.Ub)(e,document).length)return(0,i.wE)((0,i.Lt)(e,document).innerHTML.trim())}catch(t){return(0,i.wE)(e)}},t.prototype.setRTL=function(){this.enableRtl?(0,i.iQ)([this.uploadWrapper],O):(0,i.vy)([this.uploadWrapper],O)},t.prototype.localizedTexts=function(e){return this.l10n.setLocale(this.locale),this.l10n.getConstant(e)},t.prototype.setControlStatus=function(){this.enabled?(this.uploadWrapper.classList.contains(R)&&this.uploadWrapper.classList.remove(R),!(0,i.hX)(this.browseButton)&&this.element.hasAttribute("disabled")&&(this.element.removeAttribute("disabled"),this.browseButton.removeAttribute("disabled")),!(0,i.hX)(this.clearButton)&&this.clearButton.hasAttribute("disabled")&&this.clearButton.removeAttribute("disabled"),!(0,i.hX)(this.uploadButton)&&this.uploadButton.hasAttribute("disabled")&&this.uploadButton.hasAttribute("disabled")):(this.uploadWrapper.classList.add(R),this.element.setAttribute("disabled","disabled"),this.browseButton.setAttribute("disabled","disabled"),(0,i.hX)(this.clearButton)||this.clearButton.setAttribute("disabled","disabled"),(0,i.hX)(this.uploadButton)||this.uploadButton.setAttribute("disabled","disabled"))},t.prototype.checkHTMLAttributes=function(e){for(var t=0,n=e?(0,i.hX)(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["accept","multiple","disabled"];t<n.length;t++){var o=n[t];if(!(0,i.hX)(this.element.getAttribute(o)))switch(o){case"accept":((0,i.hX)(this.uploaderOptions)||void 0===this.uploaderOptions.allowedExtensions||e)&&(this.setProperties({allowedExtensions:this.element.getAttribute("accept")},!e),this.initialAttr.accept=this.allowedExtensions);break;case"multiple":if((0,i.hX)(this.uploaderOptions)||void 0===this.uploaderOptions.multiple||e){var r="multiple"===this.element.getAttribute(o)||""===this.element.getAttribute(o)||"true"===this.element.getAttribute(o);this.setProperties({multiple:r},!e),this.initialAttr.multiple=!0}break;case"disabled":if((0,i.hX)(this.uploaderOptions)||void 0===this.uploaderOptions.enabled||e){var a="disabled"!==this.element.getAttribute(o)&&""!==this.element.getAttribute(o)&&"true"!==this.element.getAttribute(o);this.setProperties({enabled:a},!e),this.initialAttr.disabled=!0}}}},t.prototype.chunkUpload=function(e,t,n){var i=Math.min(this.asyncSettings.chunkSize,e.size),o={chunkIndex:0,blob:e.rawFile.slice(0,i),file:e,start:0,end:i,retryCount:0,request:null};this.sendRequest(e,o,t,n)},t.prototype.sendRequest=function(e,t,n,o){var r=this,a=new FormData,s=e.rawFile.slice(t.start,t.end);a.append("chunkFile",s,e.name),a.append(this.uploaderName,s,e.name),a.append("chunk-index",t.chunkIndex.toString()),a.append("chunkIndex",t.chunkIndex.toString());var l=Math.max(Math.ceil(e.size/this.asyncSettings.chunkSize),1);a.append("total-chunk",l.toString()),a.append("totalChunk",l.toString());var d=new i.dj({url:this.asyncSettings.saveUrl,type:"POST",async:!0,contentType:null});d.emitError=!1,d.onLoad=function(e){return r.chunkUploadComplete(e,t,n),{}},d.onUploadProgress=function(e){return r.chunkUploadInProgress(e,t,n),{}};var h={fileData:e,customFormData:[],cancel:!1,chunkSize:0===this.asyncSettings.chunkSize?null:this.asyncSettings.chunkSize};d.beforeSend=function(n){h.currentRequest=d.httpRequest,h.currentChunkIndex=t.chunkIndex,0===h.currentChunkIndex?r.trigger("uploading",h,(function(t){r.uploadingEventCallback(a,t,n,e)})):r.trigger("chunkUploading",h,(function(t){r.uploadingEventCallback(a,t,n,e)}))},d.onError=function(e){return r.chunkUploadFailed(e,t,n),{}},d.send(a),t.request=d},t.prototype.uploadingEventCallback=function(e,t,n,i){t.cancel?this.eventCancelByArgs(n,t,i):this.updateFormData(e,t.customFormData)},t.prototype.eventCancelByArgs=function(e,t,n){var o=this;if(e.cancel=!0,"5"!==t.fileData.statusCode){t.fileData.statusCode="5",t.fileData.status=this.localizedTexts("fileUploadCancel");var r=this.getLiElement(t.fileData);if(r){(0,i.hX)(r.querySelector("."+m))||(r.querySelector("."+m).innerHTML=this.localizedTexts("fileUploadCancel"),r.querySelector("."+m).classList.add(x)),this.pauseButton=this.createElement("span",{className:"e-icons e-file-reload-btn",attrs:{tabindex:this.btnTabIndex}});var a=r.querySelector("."+v);a&&a.parentElement.insertBefore(this.pauseButton,a),this.pauseButton.setAttribute("title",this.localizedTexts("retry")),this.pauseButton.addEventListener("click",(function(e){o.reloadcanceledFile(e,n,r)}),!1),this.checkActionButtonStatus()}}},t.prototype.checkChunkUpload=function(){return!(this.asyncSettings.chunkSize<=0||(0,i.hX)(this.asyncSettings.chunkSize))},t.prototype.chunkUploadComplete=function(e,t,n){var o,r=this,a=e.target;if(4===a.readyState&&a.status>=200&&a.status<300){var l=e&&e.currentTarget?this.getResponse(e):null,d=Math.max(Math.ceil(t.file.size/this.asyncSettings.chunkSize),1),h={event:e,file:t.file,chunkIndex:t.chunkIndex,totalChunk:d,chunkSize:this.asyncSettings.chunkSize,response:l};if(this.trigger("chunkSuccess",h),!(0,i.hX)(n)&&n||(o=this.getLiElement(t.file)),this.updateMetaData(t),t.end===t.file.size&&(t.file.statusCode="3"),"5"===t.file.statusCode){var p={event:e,fileData:t.file,cancel:!1,customFormData:[]};this.trigger("canceling",p,(function(e){if(e.cancel){t.file.statusCode="3";var l=o.querySelector("."+S);(0,i.hX)(o)||(0,i.hX)(l)||((0,s.W$)(l),(0,i.Yo)(o.querySelector(".e-spinner-pane"))),r.sendNextRequest(t)}else{t.request.emitError=!1,a.abort();var d=new FormData,h=r.element.getAttribute("name");d.append(h,t.file.name),d.append("cancel-uploading",t.file.name),d.append("cancelUploading",t.file.name),r.updateFormData(d,e.customFormData);var p=new i.dj(r.asyncSettings.removeUrl,"POST",!0,null);p.emitError=!1,p.onLoad=function(e){return r.removeChunkFile(e,t,n),{}},p.send(d)}}))}else{if(d-1===t.chunkIndex&&d>t.chunkIndex){var c=this.pausedData.indexOf(t);return c>=0&&this.pausedData.splice(c,1),(0,i.hX)(this.template)&&((0,i.hX)(n)||!n)&&o&&(o&&!(0,i.hX)(o.querySelector("."+P))&&(0,i.Yo)(o.querySelector("."+P)),this.removeChunkProgressBar(t)),void this.raiseSuccessEvent(e,t.file)}"4"!==t.file.statusCode&&this.sendNextRequest(t)}}else this.chunkUploadFailed(e,t)},t.prototype.sendNextRequest=function(e){e.start=e.end,e.end+=this.asyncSettings.chunkSize,e.end=Math.min(e.end,e.file.size),e.chunkIndex+=1,this.sendRequest(e.file,e)},t.prototype.removeChunkFile=function(e,t,n){if((0,i.hX)(this.template)&&(0,i.hX)(n)&&!n){var o=this.getLiElement(t.file),r=o.querySelector("."+S),a=r;this.updateStatus(t.file,this.localizedTexts("fileUploadCancel"),"5"),this.updateProgressBarClasses(o,x),this.removeProgressbar(o,"failure"),r&&r.classList.remove(S),r&&r.classList.add(v),r&&r.setAttribute("title",this.localizedTexts("remove"));var l=o.querySelector("."+P);l&&l.classList.add(E),l&&l.classList.remove(P),l&&l.setAttribute("title",this.localizedTexts("retry")),(0,i.hX)(o)||(0,i.hX)(r)||(0,i.hX)(o.querySelector(".e-spinner-pane"))||((0,s.W$)(a),(0,i.Yo)(o.querySelector(".e-spinner-pane")))}},t.prototype.pauseUpload=function(e,t,n){e.file.statusCode="4",e.file.status=this.localizedTexts("pause"),this.updateMetaData(e);var i={event:t||null,file:e.file,chunkIndex:e.chunkIndex,chunkCount:Math.round(e.file.size/this.asyncSettings.chunkSize),chunkSize:this.asyncSettings.chunkSize};this.abortUpload(e,n,i)},t.prototype.abortUpload=function(e,t,n){"4"!==e.file.statusCode&&(e.request.emitError=!1,e.request.httpRequest.abort());var o=this.getLiElement(e.file);if((0,i.hX)(this.template)&&((0,i.hX)(t)||!t)){var r=o.querySelector("."+P);r.classList.remove(P),r.classList.add(F),r.setAttribute("title",this.localizedTexts("resume")),r.nextElementSibling.classList.add(v),r.nextElementSibling.classList.remove(S),r.nextElementSibling.setAttribute("title",this.localizedTexts("remove"))}for(var a=0;a<this.pausedData.length;a++)this.pausedData[a].file.name===e.file.name&&this.pausedData.splice(a,1);this.pausedData.push(e),this.trigger("pausing",n)},t.prototype.resumeUpload=function(e,t,n){var o,r=this.getLiElement(e.file);(0,i.hX)(r)||(o=r.querySelector("."+F)),(0,i.hX)(o)||!(0,i.hX)(n)&&n||(o.classList.remove(F),o.classList.add(P),o.setAttribute("title",this.localizedTexts("pause")),o.nextElementSibling.classList.remove(v),o.nextElementSibling.classList.add(S),o.nextElementSibling.setAttribute("title",this.localizedTexts("abort"))),e.file.status=this.localizedTexts("inProgress"),e.file.statusCode="3",this.updateMetaData(e);var a={event:t||null,file:e.file,chunkIndex:e.chunkIndex,chunkCount:Math.round(e.file.size/this.asyncSettings.chunkSize),chunkSize:this.asyncSettings.chunkSize};this.trigger("resuming",a);for(var s=0;s<this.pausedData.length;s++)this.pausedData[s].end===this.pausedData[s].file.size?this.chunkUploadComplete(t,e,n):this.pausedData[s].file.name===e.file.name&&(this.pausedData[s].start=this.pausedData[s].end,this.pausedData[s].end=this.pausedData[s].end+this.asyncSettings.chunkSize,this.pausedData[s].end=Math.min(this.pausedData[s].end,this.pausedData[s].file.size),this.pausedData[s].chunkIndex=this.pausedData[s].chunkIndex+1,this.sendRequest(this.pausedData[s].file,this.pausedData[s],n))},t.prototype.updateMetaData=function(e){-1===this.uploadMetaData.indexOf(e)||this.uploadMetaData.splice(this.uploadMetaData.indexOf(e),1),this.uploadMetaData.push(e)},t.prototype.removeChunkProgressBar=function(e){var t=this.getLiElement(e.file);if(!(0,i.hX)(t)){this.updateProgressBarClasses(t,D),this.removeProgressbar(t,"success");var n=t.querySelector("."+S);(0,i.hX)(n)||(n.classList.add(y),n.setAttribute("title",this.localizedTexts("delete")),n.classList.remove(S,L))}},t.prototype.chunkUploadFailed=function(e,t,n){var o,r=this,a=Math.max(Math.ceil(t.file.size/this.asyncSettings.chunkSize),1);!(0,i.hX)(this.template)||!(0,i.hX)(n)&&n||(o=this.getLiElement(t.file));var s=e&&e.currentTarget?this.getResponse(e):null,l={event:e,file:t.file,chunkIndex:t.chunkIndex,totalChunk:a,chunkSize:this.asyncSettings.chunkSize,cancel:!1,response:s};this.trigger("chunkFailure",l,(function(a){if(!a.cancel)if(t.retryCount<r.asyncSettings.retryCount)setTimeout((function(){r.retryRequest(o,t,n)}),r.asyncSettings.retryAfterDelay);else{if(!(0,i.hX)(o)){var l=o.querySelector("."+P)?o.querySelector("."+P):o.querySelector("."+F);(0,i.hX)(l)||(l.classList.add(E),l.classList.remove(P,F)),r.updateProgressBarClasses(o,x),r.removeProgressbar(o,"failure"),o.querySelector(".e-icons").classList.remove(L);var d=o.querySelector("."+S)?o.querySelector("."+S):o.querySelector("."+v);d.classList.remove(S),(0,i.hX)(o.querySelector("."+P))||(0,i.Yo)(o.querySelector("."+P)),t.start>0?(d.classList.add(y),d.setAttribute("title",r.localizedTexts("delete"))):(d.classList.add(v),d.setAttribute("title",r.localizedTexts("remove")))}t.retryCount=0;var h=t.file,p=r.localizedTexts("uploadFailedMessage"),c={e:e,response:s,operation:"upload",file:r.updateStatus(h,p,"0",!1),statusText:p};r.trigger("failure",c,(function(e){r.updateStatus(h,e.statusText,"0"),r.uploadSequential(),r.checkActionComplete(!0)}))}}))},t.prototype.retryRequest=function(e,t,n){(0,i.hX)(this.template)&&((0,i.hX)(n)||!n)&&e&&this.updateProgressBarClasses(e,x),t.retryCount+=1,this.sendRequest(t.file,t)},t.prototype.checkPausePlayAction=function(e){var t=e.target,n=e.target.parentElement,i=this.fileList.indexOf(n),o=this.filesData[i],r=this.getCurrentMetaData(o);t.classList.contains(P)?this.pauseUpload(r,e):t.classList.contains(F)?this.resumeUpload(r,e):t.classList.contains(E)&&(r.file.status===this.localizedTexts("fileUploadCancel")?this.retryUpload(r,!1):this.retryUpload(r,!0))},t.prototype.retryUpload=function(e,t){t?(e.end=e.end+this.asyncSettings.chunkSize,e.start=e.start+this.asyncSettings.chunkSize,this.sendRequest(e.file,e)):(e.file.statusCode="1",e.file.status=this.localizedTexts("readyToUploadMessage"),this.chunkUpload(e.file)),this.getLiElement(e.file).classList.add(H)},t.prototype.chunkUploadInProgress=function(e,t,n){var o=this;if("4"!==t.file.statusCode){"4"!==t.file.statusCode&&"5"!==t.file.statusCode&&(t.file.statusCode="3",t.file.status=this.localizedTexts("inProgress")),this.updateMetaData(t);var r=this.getLiElement(t.file);if(!(0,i.hX)(r)){var a=r.querySelector("."+E);if((0,i.hX)(a)||(a.classList.add(P),a.setAttribute("title",this.localizedTexts("pause")),a.classList.remove(E)),!(0,i.hX)(r)){if(!(r.querySelectorAll("."+T).length>0)){var s=r.querySelector("."+m);(0,i.hX)(this.template)&&(s.classList.add(L),s.classList.remove(x),this.createProgressBar(r),this.updateProgressBarClasses(r,L));var l=r.querySelector("."+v)?r.querySelector("."+v):r.querySelector("."+y);(0,i.hX)(l)||(l.classList.add(S),l.setAttribute("title",this.localizedTexts("abort")),l.classList.remove(v))}if(!isNaN(Math.round(e.loaded/e.total*100))&&(0,i.hX)(this.template)&&"4"!==t.file.statusCode){var d=void 0,h=Math.ceil(t.file.size/this.asyncSettings.chunkSize)-1;this.asyncSettings.chunkSize&&h&&(d=Math.round(t.chunkIndex/h*100),this.changeProgressValue(r,d.toString()+"%"))}0===t.chunkIndex&&this.checkActionButtonStatus()}if((0,i.hX)(r.querySelector("."+P))&&(0,i.hX)(this.template)&&(0,i.hX)(r.querySelector("."+y))){this.pauseButton=this.createElement("span",{className:"e-icons e-file-pause-btn",attrs:{tabindex:this.btnTabIndex}}),"msie"===this.browserName&&this.pauseButton.classList.add("e-msie");var p=r.querySelector("."+S);p.parentElement.insertBefore(this.pauseButton,p),this.pauseButton.setAttribute("title",this.localizedTexts("pause")),this.pauseButton.addEventListener("click",(function(e){o.checkPausePlayAction(e)}),!1)}}}},t.prototype.bytesToSize=function(e){var t=-1;if(!e)return"0.0 KB";do{e/=1024,t++}while(e>99);return t>=2&&(e*=1024,t=1),Math.max(e,0).toFixed(1)+" "+["KB","MB"][t]},t.prototype.sortFileList=function(e){for(var t=e=e||this.sortFilesList,n=[],i=0;i<t.length;i++)n.push(t[i].name);for(var o=[],r=0,a=n.sort();r<a.length;r++){var s=a[r];for(i=0;i<t.length;i++)s===t[i].name&&o.push(t[i])}return o},t.prototype.destroy=function(){this.element.value=null,this.clearTemplate(),this.clearAll(),this.unWireEvents(),this.unBindDropEvents(),this.multiple&&this.element.removeAttribute("multiple"),this.enabled||this.element.removeAttribute("disabled"),this.element.removeAttribute("accept"),this.setInitialAttributes();for(var t=0,n=["aria-label","directory","webkitdirectory","tabindex"];t<n.length;t++){var o=n[t];this.element.removeAttribute(o)}(0,i.hX)(this.uploadWrapper)||(this.uploadWrapper.parentElement.appendChild(this.element),(0,i.Yo)(this.uploadWrapper)),this.uploadWrapper=null,e.prototype.destroy.call(this)},t.prototype.upload=function(e,t){var n=this;if(e=e||this.filesData,this.sequentialUpload&&(this.isFirstFileOnSelection||t))this.sequenceUpload(e);else{var i=this.getFilesInArray(e);this.trigger("beforeUpload",{customFormData:[],currentRequest:null,cancel:!1},(function(e){e.cancel||n.uploadFiles(i,t)}))}},t.prototype.getFilesInArray=function(e){var t=[];return e instanceof Array?t=e:t.push(e),t},t.prototype.serverReadFileBase64=function(e,t,n){var i=this;return new Promise((function(o,r){var a,s=i.fileStreams[e].rawFile;try{var l=new FileReader;l.onload=(a=l,function(){try{var e=a.result,t=e?e.split(";base64,")[1]:null;o(t)}catch(n){r(n)}}),l.readAsDataURL(s.slice(t,t+n))}catch(d){r(d)}}))},t.prototype.uploadFileCount=function(e){var t=this.filesData;return t&&0!==t.length?t.length:-1},t.prototype.getFileRead=function(e,t){var n=this.filesData;if(!n||0===n.length)return-1;var i=n[e],o=this.newFileRef++;return this.fileStreams[o]=i,o},t.prototype.getFileInfo=function(e,t){var n=this.filesData;return n&&0!==n.length&&n[e]?this.filesData[e]:null},t.prototype.uploadFiles=function(e,t){var n=[];if(""!==this.asyncSettings.saveUrl&&!(0,i.hX)(this.asyncSettings.saveUrl)){if(!t||(0,i.hX)(t))if(this.multiple)n=this.filterfileList(e);else{var o=[];o.push(e[0]),n=this.filterfileList(o)}else n=e;for(var r=0;r<n.length;r++)this.uploadFilesRequest(n,r,t)}},t.prototype.uploadFilesRequest=function(e,t,n){var o=this,r=this.checkChunkUpload(),a=new i.dj(this.asyncSettings.saveUrl,"POST",!0,null);a.emitError=!1;var s={fileData:e[t],customFormData:[],cancel:!1},l=new FormData;if(a.beforeSend=function(n){s.currentRequest=a.httpRequest,o.trigger("uploading",s,(function(i){i.cancel&&o.eventCancelByArgs(n,i,e[t]),o.updateFormData(l,i.customFormData)}))},"1"===e[t].statusCode){var d=this.element.getAttribute("name");l.append(d,e[t].rawFile,e[t].name),r&&e[t].size>this.asyncSettings.chunkSize?this.chunkUpload(e[t],n,t):(a.onLoad=function(i){return s.cancel||o.uploadComplete(i,e[t],n),{}},a.onUploadProgress=function(i){return s.cancel||o.uploadInProgress(i,e[t],n,a),{}},a.onError=function(n){return o.uploadFailed(n,e[t]),{}},a.send(l))}},t.prototype.spliceFiles=function(e){for(var t=this.fileList[e],n=this.getFilesData(),i=+t.getAttribute("data-files-count"),o=0,r=0;r<e;r++)o+=+this.fileList[r].getAttribute("data-files-count");for(var a=o+i-1;a>=o;a--)n.splice(a,1)},t.prototype.remove=function(e,t,n,o,r){var a=this;(0,i.hX)(o)&&(o=!0);var s={event:r,cancel:!1,filesData:[],customFormData:[],postRawFile:o,currentRequest:null};this.trigger("beforeRemove",{cancel:!1,customFormData:[],currentRequest:null},(function(o){if(!o.cancel)if(a.isFormUpload())s.filesData=e,a.trigger("removing",s,(function(t){if(!t.cancel)for(var n=!1,o=void 0,r=0,s=a.getFilesInArray(e);r<s.length;r++){var l=s[r];if(n||(o=a.fileList.indexOf(l.list)),o>-1){var d=(0,i.hX)(l.input)?null:l.input;d&&(0,i.Yo)(d),a.spliceFiles(o),(0,i.Yo)(a.fileList[o]),a.fileList.splice(o,1),n=!0,o=-1}}}));else if(a.isForm&&((0,i.hX)(a.asyncSettings.removeUrl)||""===a.asyncSettings.removeUrl))s.filesData=a.getFilesData(),a.trigger("removing",s,(function(e){e.cancel||a.clearAll()}));else{var l=[];(e=(0,i.hX)(e)?a.filesData:e)instanceof Array?l=e:l.push(e),s.filesData=l;for(var d=a.asyncSettings.removeUrl,h=""!==d&&!(0,i.hX)(d),p=function(e){var i=a.uploadedFilesData.indexOf(e);("2"===e.statusCode||"4"===e.statusCode||"0"===e.statusCode&&-1!==i)&&h?a.removeUploadedFile(e,s,n,t):n?a.removeFilesData(e,t):a.trigger("removing",s,(function(n){n.cancel||a.removeFilesData(e,t)})),r&&!r.target.classList.contains(v)&&a.checkActionComplete(!1)},c=0,u=l;c<u.length;c++){p(u[c])}}}))},t.prototype.clearAll=function(){var e=this;if((0,i.hX)(this.listParent))return"msie"!==this.browserName&&(this.element.value=""),void(this.filesData=[]);var t={cancel:!1,filesData:this.filesData};this.trigger("clearing",t,(function(t){t.cancel||(e.clearData(),e.actionCompleteCount=0,e.count=-1)}))},t.prototype.getFilesData=function(e){return(0,i.hX)(e)?this.filesData:this.getSelectedFiles(e)},t.prototype.pause=function(e,t){e=e||this.filesData;var n=this.getFilesInArray(e);this.pauseUploading(n,t)},t.prototype.pauseUploading=function(e,t){for(var n=this.getFiles(e),i=0;i<n.length;i++)"3"===n[i].statusCode&&this.pauseUpload(this.getCurrentMetaData(n[i],null),null,t)},t.prototype.getFiles=function(e){var t=[];return(0,i.hX)(e)||e instanceof Array?t=e:t.push(e),t},t.prototype.resume=function(e,t){e=e||this.filesData;var n=this.getFilesInArray(e);this.resumeFiles(n,t)},t.prototype.resumeFiles=function(e,t){for(var n=this.getFiles(e),i=0;i<n.length;i++)"4"===n[i].statusCode&&this.resumeUpload(this.getCurrentMetaData(n[i],null),null,t)},t.prototype.retry=function(e,t,n){e=e||this.filesData;var i=this.getFilesInArray(e);this.sequentialUpload&&this.isFirstFileOnSelection&&(this.isFirstFileOnSelection=!1),this.retryFailedFiles(i,t,n)},t.prototype.retryFailedFiles=function(e,t,n){for(var i=this.getFiles(e),o=0;o<i.length;o++)if("5"===i[o].statusCode||"0"===i[o].statusCode)if(this.asyncSettings.chunkSize>0)this.retryUpload(this.getCurrentMetaData(i[o],null),t);else{var r=void 0;n||(r=this.fileList[this.filesData.indexOf(i[o])]),this.reloadcanceledFile(null,i[o],r,n)}},t.prototype.cancel=function(e){e=e||this.filesData;var t=this.getFilesInArray(e);this.cancelUpload(t)},t.prototype.cancelUpload=function(e){var t=this.getFiles(e);if(this.asyncSettings.chunkSize>0){for(var n=0;n<t.length;n++)if("3"===t[n].statusCode){var i=this.getCurrentMetaData(t[n],null);i.file.statusCode="5",i.file.status=this.localizedTexts("fileUploadCancel"),this.updateMetaData(i),this.showHideUploadSpinner(t[n])}}else for(n=0;n<t.length;n++)"3"===t[n].statusCode&&(t[n].statusCode="5",t[n].status=this.localizedTexts("fileUploadCancel"),this.showHideUploadSpinner(t[n]))},t.prototype.showHideUploadSpinner=function(e){var t=this.getLiElement(e);if(!(0,i.hX)(t)&&(0,i.hX)(this.template)){var n=t.querySelector("."+S);(0,s.GF)({target:n,width:"20px"}),(0,s.xc)(n)}},d([(0,i.pr)({saveUrl:"",removeUrl:""},Q)],t.prototype,"asyncSettings",void 0),d([(0,i.mA)(!1)],t.prototype,"sequentialUpload",void 0),d([(0,i.mA)({})],t.prototype,"htmlAttributes",void 0),d([(0,i.mA)("")],t.prototype,"cssClass",void 0),d([(0,i.mA)(!0)],t.prototype,"enabled",void 0),d([(0,i.mA)(null)],t.prototype,"template",void 0),d([(0,i.mA)(!0)],t.prototype,"multiple",void 0),d([(0,i.mA)(!0)],t.prototype,"autoUpload",void 0),d([(0,i.pr)({},U)],t.prototype,"buttons",void 0),d([(0,i.mA)("")],t.prototype,"allowedExtensions",void 0),d([(0,i.mA)(0)],t.prototype,"minFileSize",void 0),d([(0,i.mA)(3e7)],t.prototype,"maxFileSize",void 0),d([(0,i.mA)(null)],t.prototype,"dropArea",void 0),d([(0,i.pM)([{}],j)],t.prototype,"files",void 0),d([(0,i.mA)(!0)],t.prototype,"showFileList",void 0),d([(0,i.mA)(!1)],t.prototype,"directoryUpload",void 0),d([(0,i.mA)("Default")],t.prototype,"dropEffect",void 0),d([(0,i.Jh)()],t.prototype,"created",void 0),d([(0,i.Jh)()],t.prototype,"actionComplete",void 0),d([(0,i.Jh)()],t.prototype,"rendering",void 0),d([(0,i.Jh)()],t.prototype,"beforeUpload",void 0),d([(0,i.Jh)()],t.prototype,"fileListRendering",void 0),d([(0,i.Jh)()],t.prototype,"selected",void 0),d([(0,i.Jh)()],t.prototype,"uploading",void 0),d([(0,i.Jh)()],t.prototype,"success",void 0),d([(0,i.Jh)()],t.prototype,"failure",void 0),d([(0,i.Jh)()],t.prototype,"removing",void 0),d([(0,i.Jh)()],t.prototype,"beforeRemove",void 0),d([(0,i.Jh)()],t.prototype,"clearing",void 0),d([(0,i.Jh)()],t.prototype,"progress",void 0),d([(0,i.Jh)()],t.prototype,"change",void 0),d([(0,i.Jh)()],t.prototype,"chunkSuccess",void 0),d([(0,i.Jh)()],t.prototype,"chunkFailure",void 0),d([(0,i.Jh)()],t.prototype,"chunkUploading",void 0),d([(0,i.Jh)()],t.prototype,"canceling",void 0),d([(0,i.Jh)()],t.prototype,"pausing",void 0),d([(0,i.Jh)()],t.prototype,"resuming",void 0),t=d([i.kc],t)}(i.uA),_=n(155),J=n(6257),Y=n(2819),V=n(1411),K=n(134),G=n(5453),$=function(){function e(e,t){this.isImgUploaded=!1,this.isAllowedTypes=!0,this.pageX=null,this.pageY=null,this.deletedImg=[],this.parent=e,this.rteID=e.element.id,this.i10n=t.getService("rteLocale"),this.rendererFactory=t.getService("rendererFactory"),this.dialogRenderObj=t.getService("dialogRenderObject"),this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(o.u2,this.onKeyDown,this),this.parent.on(o.LL,this.onKeyUp,this),this.parent.on(o.V4,this.insertImage,this),this.parent.on(o.jD,this.showDialog,this),this.parent.on(o.IH,this.closeDialog,this),this.parent.on(o.L5,this.onWindowResize,this),this.parent.on(o.tq,this.showImageQuickToolbar,this),this.parent.on(o.XY,this.clearDialogObj,this),this.parent.on(o.tb,this.onToolbarAction,this),this.parent.on(o.Ku,this.caption,this),this.parent.on(o.Vq,this.deleteImg,this),this.parent.on(o.S3,this.insertImgLink,this),this.parent.on(o.e_,this.insertAltText,this),this.parent.on(o.ot,this.editAreaClickHandler,this),this.parent.on(o.KK,this.onIframeMouseDown,this),this.parent.on(o.R9,this.imageSize,this),this.parent.on(o.uY,this.alignmentSelect,this),this.parent.on(o.qO,this.afterRender,this),this.parent.on(o.Ei,this.afterRender,this),this.parent.on(o.oh,this.imagePaste,this),this.parent.on(o.zr,this.removeEventListener,this))},e.prototype.removeEventListener=function(){if(!this.parent.isDestroyed){this.parent.off(o.u2,this.onKeyDown),this.parent.off(o.LL,this.onKeyUp),this.parent.off(o.L5,this.onWindowResize),this.parent.off(o.V4,this.insertImage),this.parent.off(o.jD,this.showDialog),this.parent.off(o.IH,this.closeDialog),this.parent.off(o.tq,this.showImageQuickToolbar),this.parent.off(o.XY,this.clearDialogObj),this.parent.off(o.Ku,this.caption),this.parent.off(o.tb,this.onToolbarAction),this.parent.off(o.Vq,this.deleteImg),this.parent.off(o.S3,this.insertImgLink),this.parent.off(o.e_,this.insertAltText),this.parent.off(o.ot,this.editAreaClickHandler),this.parent.off(o.KK,this.onIframeMouseDown),this.parent.off(o.R9,this.imageSize),this.parent.off(o.uY,this.alignmentSelect),this.parent.off(o.qO,this.afterRender),this.parent.off(o.Ei,this.afterRender),this.parent.off(o.oh,this.imagePaste),this.parent.off(o.zr,this.removeEventListener);var e=this.parent.iframeSettings.enable?this.parent.inputElement.ownerDocument:this.parent.inputElement;e.removeEventListener("drop",this.dragDrop.bind(this),!0),e.removeEventListener("dragstart",this.dragStart.bind(this),!0),e.removeEventListener("dragenter",this.dragEnter.bind(this),!0),e.removeEventListener("dragover",this.dragOver.bind(this),!0),(0,i.hX)(this.contentModule)||(i.Jm.remove(this.contentModule.getEditPanel(),i.Pw.touchEndEvent,this.imageClick),this.parent.formatter.editorManager.observer.off(o.XZ,this.undoStack),this.parent.insertImageSettings.resize&&(i.Jm.remove(this.parent.contentModule.getEditPanel(),i.Pw.touchStartEvent,this.resizeStart),i.Jm.remove(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick),i.Jm.remove(this.contentModule.getEditPanel(),"cut",this.onCutHandler)))}},e.prototype.onIframeMouseDown=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},e.prototype.afterRender=function(){this.contentModule=this.rendererFactory.getRenderer(V.nJ.Content),i.Jm.add(this.contentModule.getEditPanel(),i.Pw.touchEndEvent,this.imageClick,this),this.parent.insertImageSettings.resize&&(i.Jm.add(this.parent.contentModule.getEditPanel(),i.Pw.touchStartEvent,this.resizeStart,this),i.Jm.add(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick,this),i.Jm.add(this.contentModule.getEditPanel(),"cut",this.onCutHandler,this));var e=this.parent.iframeSettings.enable?this.parent.inputElement.ownerDocument:this.parent.inputElement;e.addEventListener("drop",this.dragDrop.bind(this),!0),e.addEventListener("dragstart",this.dragStart.bind(this),!0),e.addEventListener("dragenter",this.dragOver.bind(this),!0),e.addEventListener("dragover",this.dragOver.bind(this),!0)},e.prototype.undoStack=function(e){if("undo"===e.subCommand.toLowerCase()||"redo"===e.subCommand.toLowerCase())for(var t=0;t<this.parent.formatter.getUndoRedoStack().length;t++){var n=this.parent.createElement("div"),o=(0,K.ZC)(this.parent.formatter.getUndoRedoStack()[t].text);n.appendChild(o);var r=n.querySelectorAll("img");if(n.querySelector(".e-img-resize")&&r.length>0){for(var a=0;a<r.length;a++)r[a].style.outline="";(0,i.Yo)(n.querySelector(".e-img-resize")),this.parent.formatter.getUndoRedoStack()[t].text=n.innerHTML}}},e.prototype.resizeEnd=function(e){this.resizeBtnInit(),this.imgEle.parentElement.style.cursor="auto",i.Pw.isDevice&&(0,i.vy)([e.target.parentElement],"e-mob-span");var t={event:e,requestType:"images"};this.parent.trigger(o.D5,t);this.getPointX(e),this.parent.iframeSettings.enable?(window.pageYOffset,this.parent.element.getBoundingClientRect().top,e.clientY):e.pageY;this.parent.formatter.editorManager.observer.on(o.XZ,this.undoStack,this),this.parent.formatter.saveData()},e.prototype.resizeStart=function(e,t){var n=this;if(!this.parent.readonly){var r=t||e.target;if(this.prevSelectedImgEle=this.imgEle,"IMG"===r.tagName){this.parent.preventDefaultResize(e);var a=r;this.imgResizeDiv&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&(0,i.Yo)(this.imgResizeDiv),this.imageResize(a)}if(r.classList.contains("e-rte-imageboxmark")){if(0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),this.pageX=this.getPointX(e),this.pageY=this.getPointY(e),e.preventDefault(),e.stopImmediatePropagation(),this.resizeBtnInit(),this.quickToolObj&&this.quickToolObj.imageQTBar.hidePopup(),r.classList.contains("e-rte-topLeft")&&(this.resizeBtnStat.topLeft=!0),r.classList.contains("e-rte-topRight")&&(this.resizeBtnStat.topRight=!0),r.classList.contains("e-rte-botLeft")&&(this.resizeBtnStat.botLeft=!0),r.classList.contains("e-rte-botRight")&&(this.resizeBtnStat.botRight=!0),i.Pw.isDevice&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&!this.imgResizeDiv.classList.contains("e-mob-span"))(0,i.iQ)([this.imgResizeDiv],"e-mob-span");else{var s={event:e,requestType:"images"};this.parent.trigger(o.tP,s,(function(e){e.cancel&&n.cancelResizeAction()}))}i.Jm.add(this.contentModule.getDocument(),i.Pw.touchEndEvent,this.resizeEnd,this)}}},e.prototype.imageClick=function(e){i.Pw.isDevice&&("IMG"===e.target.tagName&&"A"===e.target.parentElement.tagName||"IMG"===e.target.tagName?(this.contentModule.getEditPanel().setAttribute("contenteditable","false"),e.target.focus()):this.parent.readonly||this.contentModule.getEditPanel().setAttribute("contenteditable","true")),"IMG"===e.target.tagName&&"A"===e.target.parentElement.tagName&&e.preventDefault()},e.prototype.onCutHandler=function(){this.imgResizeDiv&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&this.cancelResizeAction()},e.prototype.imageResize=function(e){this.resizeBtnInit(),this.imgEle=e,(0,i.iQ)([this.imgEle],"e-resize"),this.imgResizeDiv=this.parent.createElement("span",{className:"e-img-resize",id:this.rteID+"_imgResize"}),this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-topLeft",styles:"cursor: nwse-resize"})),this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-topRight",styles:"cursor: nesw-resize"})),this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-botLeft",styles:"cursor: nesw-resize"})),this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-botRight",styles:"cursor: nwse-resize"})),i.Pw.isDevice&&(0,i.iQ)([this.imgResizeDiv],"e-mob-rte"),e.style.outline="2px solid #4a90e2",this.imgResizePos(e,this.imgResizeDiv),this.resizeImgDupPos(e),this.contentModule.getEditPanel().appendChild(this.imgResizeDiv),i.Jm.add(this.contentModule.getDocument(),i.Pw.touchMoveEvent,this.resizing,this)},e.prototype.getPointX=function(e){return e.touches&&e.touches.length?e.touches[0].pageX:e.pageX},e.prototype.getPointY=function(e){return e.touches&&e.touches.length?e.touches[0].pageY:e.pageY},e.prototype.imgResizePos=function(e,t){var n=this.calcPos(e),o=n.top,r=n.left,a=e.width,s=e.height,l=i.Pw.isDevice?4*parseInt(e.style.outline.slice(-3),10)+2:2*parseInt(e.style.outline.slice(-3),10)+2,d=i.Pw.isDevice?0:2;t.querySelector(".e-rte-botLeft").style.left=r-l+"px",t.querySelector(".e-rte-botLeft").style.top=s-l+o+"px",t.querySelector(".e-rte-botRight").style.left=a-(l-d)+r+"px",t.querySelector(".e-rte-botRight").style.top=s-l+o+"px",t.querySelector(".e-rte-topRight").style.left=a-(l-d)+r+"px",t.querySelector(".e-rte-topRight").style.top=o-l+"px",t.querySelector(".e-rte-topLeft").style.left=r-l+"px",t.querySelector(".e-rte-topLeft").style.top=o-l+"px"},e.prototype.calcPos=function(e){for(var t=e.ownerDocument,n=(e.offsetParent&&(e.offsetParent.classList.contains("e-img-caption")||["TD","TH","TABLE","A"].indexOf(e.offsetParent.tagName)>-1)?(0,i.kp)(e,"#"+this.parent.getID()+"_rte-edit-view"):e.offsetParent)||t.documentElement;n&&(n===t.body||n===t.documentElement)&&"static"===n.style.position;)n=n.parentNode;return n&&n!==e&&1===n.nodeType&&n.getBoundingClientRect(),{top:e.offsetTop,left:e.offsetLeft}},e.prototype.setAspectRatio=function(e,t,n,o){if(!(0,i.hX)(e.width)){var r=""!==e.style.width?e.style.width.match(/^\d+(\.\d*)?%$/g)?parseFloat(e.style.width):parseInt(e.style.width,10):e.width,a=""!==e.style.height?parseInt(e.style.height,10):e.height;if(r>a)if(e.style.minWidth="20px",this.parent.insertImageSettings.resizeByPercent){if(0!==parseInt(""+e.getBoundingClientRect().width,10)&&0!==parseInt(""+r,10)){var s=this.pixToPerc(r/a*n,e.previousElementSibling||e.parentElement);e.style.width=Math.min(Math.round(s/e.getBoundingClientRect().width*t*100)/100,100)+"%"}else e.style.width=this.pixToPerc(r/a*n,e.previousElementSibling||e.parentElement)+"%";e.style.height=null,e.removeAttribute("height")}else if(""===e.style.width&&""!==e.style.height)e.style.height=n+"px";else if(""!==e.style.width&&""===e.style.height){var l=r/a*n+r/a<this.parent.inputElement.getBoundingClientRect().right-32?r/a*n+r/a:this.parent.inputElement.getBoundingClientRect().right-32;e.style.width=l.toString()+"px"}else if(""!==e.style.width){l=r/a*n<this.parent.inputElement.getBoundingClientRect().right-32?r/a*n:this.parent.inputElement.getBoundingClientRect().right-32;e.style.width=l+"px",e.style.height=n+"px"}else e.setAttribute("width",(r/a*n+r/a).toString());else a>r?this.parent.insertImageSettings.resizeByPercent?(0!==parseInt(""+e.getBoundingClientRect().width,10)&&0!==parseInt(""+r,10)?e.style.width=Math.min(Math.round(r/e.getBoundingClientRect().width*t*100)/100,100)+"%":e.style.width=this.pixToPerc(t/a*n,e.previousElementSibling||e.parentElement)+"%",e.style.height=null,e.removeAttribute("height")):""!==e.style.width?(e.style.width=t+"px",e.style.height=a/r*t+"px"):e.setAttribute("width",this.resizeBtnStat.botRight?(this.getPointX(o.event)-e.getBoundingClientRect().left).toString():t.toString()):this.parent.insertImageSettings.resizeByPercent?(e.style.width=this.pixToPerc(t,e.previousElementSibling||e.parentElement)+"%",e.style.height=null,e.removeAttribute("height")):""!==e.style.width?(e.style.width=t+"px",e.style.height=t+"px"):(e.setAttribute("width",t.toString()),e.setAttribute("height",t.toString()))}},e.prototype.pixToPerc=function(e,t){return e/parseFloat(getComputedStyle(t).width)*100},e.prototype.imgDupMouseMove=function(e,t,n){var r=this,a={event:n,requestType:"images"};this.parent.trigger(o.EV,a,(function(n){if(n.cancel)r.cancelResizeAction();else{if(parseInt(r.parent.insertImageSettings.minWidth,10)>=parseInt(e,10)||parseInt(r.parent.getInsertImgMaxWidth(),10)<=parseInt(e,10)&&(0,i.hX)(r.imgEle.style.width))return;if(!r.parent.insertImageSettings.resizeByPercent&&(parseInt(r.parent.insertImageSettings.minHeight,10)>=parseInt(t,10)||parseInt(r.parent.insertImageSettings.maxHeight,10)<=parseInt(t,10)))return;r.imgEle.parentElement.style.cursor="pointer",r.setAspectRatio(r.imgEle,parseInt(e,10),parseInt(t,10),a),r.resizeImgDupPos(r.imgEle),r.imgResizePos(r.imgEle,r.imgResizeDiv),r.parent.setContentHeight("",!1)}}))},e.prototype.resizing=function(e){this.imgEle.offsetWidth>=this.parent.getInsertImgMaxWidth()&&(this.imgEle.style.maxHeight=this.imgEle.offsetHeight+"px");var t=this.getPointX(e),n=this.getPointY(e),i=this.resizeBtnStat.botLeft||this.resizeBtnStat.topLeft?-(t-this.pageX):t-this.pageX,o=this.resizeBtnStat.topLeft||this.resizeBtnStat.topRight?-(n-this.pageY):n-this.pageY,r=parseInt(this.imgDupPos.width,10)+i,a=parseInt(this.imgDupPos.height,10)+o;this.pageX=t,this.pageY=n,(this.resizeBtnStat.botRight||this.resizeBtnStat.botLeft||this.resizeBtnStat.topRight||this.resizeBtnStat.topLeft)&&this.imgDupMouseMove(r+"px",a+"px",e)},e.prototype.cancelResizeAction=function(){i.Jm.remove(this.contentModule.getDocument(),i.Pw.touchMoveEvent,this.resizing),i.Jm.remove(this.contentModule.getDocument(),i.Pw.touchEndEvent,this.resizeEnd),this.imgEle&&this.imgResizeDiv&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&((0,i.Yo)(this.imgResizeDiv),this.imgEle.style.outline="",this.imgResizeDiv=null,this.pageX=null,this.pageY=null)},e.prototype.resizeImgDupPos=function(e){this.imgDupPos={width:""!==e.style.width&&this.parent.insertImageSettings&&!this.parent.insertImageSettings.resizeByPercent?this.imgEle.style.width:e.width+"px",height:""!==e.style.height?this.imgEle.style.height:e.height+"px"}},e.prototype.resizeBtnInit=function(){return this.resizeBtnStat={botLeft:!1,botRight:!1,topRight:!1,topLeft:!1}},e.prototype.onToolbarAction=function(e){switch((0,G.wU)()&&this.parent.notify(o.jN,{}),e.args.item.subCommand){case"Replace":this.parent.fileManagerSettings.enable?this.parent.notify(o.AE,e):this.parent.notify(o.V4,e);break;case"Caption":this.parent.notify(o.Ku,e);break;case"InsertLink":this.parent.notify(o.S3,e);break;case"AltText":this.parent.notify(o.e_,e);break;case"Remove":this.parent.notify(o.Vq,e);break;case"Dimension":this.parent.notify(o.R9,e);break;case"OpenImageLink":this.openImgLink(e);break;case"EditImageLink":this.editImgLink(e);break;case"RemoveImageLink":this.removeImgLink(e)}},e.prototype.openImgLink=function(e){var t=""===e.selectParent[0].parentNode.target?"_self":"_blank";this.parent.formatter.process(this.parent,e.args,e.args,{url:e.selectParent[0].parentNode.href,target:t,selectNode:e.selectNode,subCommand:e.args.item.subCommand})},e.prototype.editImgLink=function(e){var t=e.selectParent[0].parentNode,n=this.i10n.getConstant("dialogUpdate"),i={url:t.href,target:t.target,header:"Edit Link",btnText:n};this.insertImgLink(e,i)},e.prototype.removeImgLink=function(e){i.Pw.isIE&&this.contentModule.getEditPanel().focus(),e.selection.restore();var t=!(!this.contentModule.getEditPanel().contains(this.captionEle)||!(0,i.Lt)("a",this.captionEle)),n=t?[this.captionEle]:[e.selectNode[0].parentElement];this.parent.formatter.process(this.parent,e.args,e.args,{insertElement:e.selectNode[0],selectParent:n,selection:e.selection,subCommand:e.args.item.subCommand}),this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),(0,i.hX)(e.selectParent)||(0,i.vy)([e.selectParent[0]],"e-img-focus")),t&&(0,i.Lt)(".e-img-inner",this.captionEle).focus()},e.prototype.onKeyDown=function(e){var t,n,o,a,s,l=e.args;this.deletedImg=[];if("HTML"===this.parent.editorMode&&(s=(t=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument())).startContainer===t.endContainer&&t.startOffset===t.endOffset),!s&&"HTML"===this.parent.editorMode&&[27,112,113,114,115,116,117,118,119,120,121,122,123,44,45,9,16,17,18,19,20,33,34,35,36,37,38,39,40,91,92,93,144,145,182,183].indexOf(l.which)<0)for(var d=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(t),h=0;h<d.length;h++)"IMG"===d[h].nodeName&&this.deletedImg.push(d[h]);if("HTML"===this.parent.editorMode&&(8===l.which&&"Backspace"===l.code||46===l.which&&"Delete"===l.code)){var p=t.startContainer===t.endContainer&&t.startOffset===t.endOffset;8===l.which&&"Backspace"===l.code&&p?this.checkImageBack(t):46===l.which&&"Delete"===l.code&&p&&this.checkImageDel(t)}if(!(0,i.hX)(this.parent.formatter.editorManager.nodeSelection)&&"KeyK"!==l.code&&(t=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),n=this.parent.formatter.editorManager.nodeSelection.save(t,this.parent.contentModule.getDocument()),o=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(t),a=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(t),!l.ctrlKey&&l.key&&(1===l.key.length||"enter"===l.action)&&"IMG"===a[0].tagName&&a[0].parentElement)){var c=a[0].parentElement.childNodes[0];this.contentModule.getEditPanel().querySelector(".e-img-resize")&&this.removeResizeEle(),this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(),c,c,c.textContent.length,c.textContent.length),(0,i.vy)([a[0]],"e-img-focus"),this.quickToolObj.imageQTBar.hidePopup()}if(!l.ctrlKey||89!==l.keyCode&&90!==l.keyCode||this.undoStack({subCommand:90===l.keyCode?"undo":"redo"}),8===l.keyCode||46===l.keyCode){if(o&&"IMG"===o[0].nodeName&&o.length<1){l.preventDefault();var u={selectNode:o,selection:n,selectParent:a,args:{item:{command:"Images",subCommand:"Remove"},originalEvent:l}};this.deleteImg(u,l.keyCode)}this.parent.contentModule.getEditPanel().querySelector(".e-img-resize")&&this.removeResizeEle()}switch("Backspace"===l.code&&(l.action="backspace"),l.action){case"escape":(0,i.hX)(this.dialogObj)||this.dialogObj.close();break;case"backspace":case"delete":for(h=0;h<this.deletedImg.length;h++){var m=this.deletedImg[h].src;this.imageRemovePost(m)}"Markdown"!==this.parent.editorMode&&(3===t.startContainer.nodeType?"Backspace"===l.code?t.startContainer.previousElementSibling&&0===t.startOffset&&t.startContainer.previousElementSibling.classList.contains(r.id)&&t.startContainer.previousElementSibling.classList.contains(r.LP)&&(0,i.Yo)(t.startContainer.previousElementSibling):t.startContainer.nextElementSibling&&t.endContainer.textContent.length===t.endOffset&&t.startContainer.nextElementSibling.classList.contains(r.id)&&t.startContainer.nextElementSibling.classList.contains(r.LP)&&(0,i.Yo)(t.startContainer.nextElementSibling):1===t.startContainer.nodeType&&t.startContainer.querySelector("."+r.id+"."+r.LP)&&(0,i.Yo)(t.startContainer.querySelector("."+r.id+"."+r.LP)));break;case"insert-image":this.openDialog(!0,l,n,o,a),l.preventDefault()}},e.prototype.openDialog=function(e,t,n,o,r){var a,s,l,d;e||(0,i.hX)(this.parent.formatter.editorManager.nodeSelection)?(s=n,l=o,d=r):(a=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),s=this.parent.formatter.editorManager.nodeSelection.save(a,this.parent.contentModule.getDocument()),l=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(a),d=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(a)),"HTML"===this.parent.editorMode?this.insertImage({args:{item:{command:"Images",subCommand:"Image"},originalEvent:t},selectNode:l,selection:s,selectParent:d}):this.insertImage({args:{item:{command:"Images",subCommand:"Image"},originalEvent:t},member:"image",text:this.parent.formatter.editorManager.markdownSelection.getSelectedText(this.parent.contentModule.getEditPanel()),module:"Markdown",name:"insertImage"})},e.prototype.showDialog=function(){this.openDialog(!1)},e.prototype.closeDialog=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},e.prototype.onKeyUp=function(e){if(!(0,i.hX)(this.deletedImg)&&this.deletedImg.length>0)for(var t=0;t<this.deletedImg.length;t++){var n={element:this.deletedImg[t],src:this.deletedImg[t].getAttribute("src")};this.parent.trigger(o.RW,n)}},e.prototype.checkImageBack=function(e){"#text"!==e.startContainer.nodeName||0!==e.startOffset||(0,i.hX)(e.startContainer.previousSibling)||"IMG"!==e.startContainer.previousSibling.nodeName?"#text"===e.startContainer.nodeName||(0,i.hX)(e.startContainer.childNodes[e.startOffset-1])||"IMG"!==e.startContainer.childNodes[e.startOffset-1].nodeName||this.deletedImg.push(e.startContainer.childNodes[e.startOffset-1]):this.deletedImg.push(e.startContainer.previousSibling)},e.prototype.checkImageDel=function(e){"#text"!==e.startContainer.nodeName||e.startOffset!==e.startContainer.textContent.length||(0,i.hX)(e.startContainer.nextSibling)||"IMG"!==e.startContainer.nextSibling.nodeName?"#text"===e.startContainer.nodeName||(0,i.hX)(e.startContainer.childNodes[e.startOffset])||"IMG"!==e.startContainer.childNodes[e.startOffset].nodeName||this.deletedImg.push(e.startContainer.childNodes[e.startOffset]):this.deletedImg.push(e.startContainer.nextSibling)},e.prototype.alignmentSelect=function(e){var t=e.item;if(document.body.contains(document.body.querySelector(".e-rte-quick-toolbar"))&&"Images"===t.command){var n=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),o=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(n),r={args:e,selectNode:o="IMG"===o[0].nodeName?o:[this.imgEle]};switch(0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),t.subCommand){case"JustifyLeft":this.alignImage(r,"JustifyLeft");break;case"JustifyCenter":this.alignImage(r,"JustifyCenter");break;case"JustifyRight":this.alignImage(r,"JustifyRight");break;case"Inline":this.inline(r);break;case"Break":this.break(r)}this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),(0,i.vy)([o[0]],"e-img-focus")),this.cancelResizeAction()}},e.prototype.imageWithLinkQTBarItemUpdate=function(){for(var e=this.quickToolObj.imageQTBar.toolbarElement.querySelectorAll(".e-toolbar-item"),t=0;t<e.length;t++)e[t].getAttribute("title")===this.i10n.getConstant("openLink")||e[t].getAttribute("title")===this.i10n.getConstant("editLink")||e[t].getAttribute("title")===this.i10n.getConstant("removeLink")?((0,i.iQ)([e[t]],"e-link-groups"),e[t].style.display="none"):"Insert Link"===e[t].getAttribute("title")?e[t].style.display="":e[t].classList.contains("e-rte-horizontal-separator")&&(e[t],(0,i.Yo)(e[t]));var n=this.quickToolObj.imageQTBar.toolbarElement.querySelectorAll(".e-toolbar-item:not(.e-link-groups)");this.quickToolObj.imageQTBar.addQTBarItem(["-"],Math.round(n.length/2))},e.prototype.showImageQuickToolbar=function(e){var t=this;if(!("Images"!==e.type||(0,i.hX)(this.parent.quickToolbarModule)||(0,i.hX)(this.parent.quickToolbarModule.imageQTBar)||(0,i.hX)(e.args))){this.quickToolObj=this.parent.quickToolbarModule;var n=e.args,o=e.elements;[].forEach.call(e.elements,(function(e,t){0===t&&(o=e)})),o&&!(0,i.kp)(o,"a")&&this.imageWithLinkQTBarItemUpdate(),"IMG"===o.nodeName&&(0,i.iQ)([o],["e-img-focus"]);var r=this.parent.iframeSettings.enable?window.pageYOffset+this.parent.element.getBoundingClientRect().top+n.clientY:n.pageY;this.parent.quickToolbarModule.imageQTBar&&(e.isNotify?setTimeout((function(){t.quickToolObj.imageQTBar.showPopup(n.pageX,r,o)}),400):this.quickToolObj.imageQTBar.showPopup(n.pageX,r,o))}},e.prototype.hideImageQuickToolbar=function(){(0,i.hX)(this.contentModule.getEditPanel().querySelector(".e-img-focus"))||((0,i.vy)([this.contentModule.getEditPanel().querySelector(".e-img-focus")],"e-img-focus"),this.quickToolObj&&this.quickToolObj.imageQTBar&&document.body.contains(this.quickToolObj.imageQTBar.element)&&this.quickToolObj.imageQTBar.hidePopup())},e.prototype.editAreaClickHandler=function(e){if(this.parent.readonly)this.hideImageQuickToolbar();else{var t=e.args,n=this.parent.quickToolbarSettings.showOnRightClick;if(2===t.which||n&&1===t.which||!n&&3===t.which)n&&1===t.which&&!(0,i.hX)(t.target)&&"IMG"===t.target.tagName&&(this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(),t.target));else if("HTML"===this.parent.editorMode&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.imageQTBar){this.quickToolObj=this.parent.quickToolbarModule;var r=t.target;this.contentModule=this.rendererFactory.getRenderer(V.nJ.Content);var a=this.quickToolObj.imageQTBar.element.classList.contains("e-rte-pop");if("IMG"===r.nodeName&&this.parent.quickToolbarModule){if(a)return;this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(),r),(0,G.wU)()&&this.parent.notify(o.qm,e),(0,i.iQ)([r],"e-img-focus");var s=this.quickToolObj.imageQTBar.toolbarElement.querySelectorAll(".e-toolbar-item");if((0,i.kp)(r,"a")){for(var l=0;l<s.length;l++)s[l].getAttribute("title")===this.i10n.getConstant("openLink")||s[l].getAttribute("title")===this.i10n.getConstant("editLink")||s[l].getAttribute("title")===this.i10n.getConstant("removeLink")?(s[l].style.display="",(0,i.vy)([s[l]],"e-link-groups")):"Insert Link"===s[l].getAttribute("title")?s[l].style.display="none":s[l].classList.contains("e-rte-horizontal-separator")&&(s[l],(0,i.Yo)(s[l]));var d=this.quickToolObj.imageQTBar.toolbarElement.querySelectorAll(".e-toolbar-item:not(.e-link-groups)");this.quickToolObj.imageQTBar.addQTBarItem(["-"],Math.round(d.length/2))}else(0,i.kp)(r,"a")||this.imageWithLinkQTBarItemUpdate();this.showImageQuickToolbar({args:t,type:"Images",elements:[t.target]})}else this.hideImageQuickToolbar()}}},e.prototype.insertImgLink=function(e,t){var n=this;if("IMG"===e.selectNode[0].nodeName&&(this.imagDialog(e),!(0,i.hX)(this.dialogObj))){var o=this.parent.createElement("div",{className:"e-img-linkwrap"}),r='<div class="e-rte-field"><input type="text" data-role ="none" class="e-input e-img-link" spellcheck="false" placeholder="'+this.i10n.getConstant("linkurl")+'"/></div><div class="e-rte-label"></div><div class="e-rte-field"><input type="checkbox" class="e-rte-linkTarget"  data-role ="none"></div>',a=(0,K.ZC)(r);o.appendChild(a);var s=o.querySelector(".e-rte-linkTarget"),l=o.querySelector(".e-img-link"),d=this.i10n.getConstant("linkOpenInNewWindow");this.checkBoxObj=new J.o({label:d,checked:!0,enableRtl:this.parent.enableRtl,change:function(e){h=e.checked?"_blank":null}}),this.checkBoxObj.isStringTemplate=!0,this.checkBoxObj.createElement=this.parent.createElement,this.checkBoxObj.appendTo(s);var h=this.checkBoxObj.checked?"_blank":null,p=this.i10n.getConstant("dialogUpdate"),c={args:e.args,selfImage:this,selection:e.selection,selectNode:e.selectNode,selectParent:e.selectParent,link:l,target:h};this.dialogObj.setProperties({height:"inherit",width:"290px",header:this.parent.localeObj.getConstant("imageInsertLinkHeader"),content:o,position:{X:"center",Y:"center"},buttons:[{click:function(e){n.insertlink(c)},buttonModel:{content:p,cssClass:"e-flat e-update-link",isPrimary:!0}}]}),(0,i.hX)(t)||(l.value=t.url,t.target?this.checkBoxObj.checked=!0:this.checkBoxObj.checked=!1,this.dialogObj.header=t.header),this.dialogObj.element.style.maxHeight="inherit",this.dialogObj.content.querySelector("input").focus()}},e.prototype.insertAltText=function(e){var t=this;if("IMG"===e.selectNode[0].nodeName){this.imagDialog(e);var n=this.i10n.getConstant("altText");if(!(0,i.hX)(this.dialogObj)){var o=this.parent.createElement("div",{className:"e-img-altwrap"}),r=this.i10n.getConstant("alternateHeader"),a=this.i10n.getConstant("dialogUpdate"),s='<div class="e-rte-field"><input type="text" spellcheck="false" value="'+(null===e.selectNode[0].getAttribute("alt")?"":e.selectNode[0].getAttribute("alt"))+'" class="e-input e-img-alt" placeholder="'+n+'"/></div>',l=(0,K.ZC)(s);o.appendChild(l);var d=o.querySelector(".e-img-alt"),h={args:e.args,selfImage:this,selection:e.selection,selectNode:e.selectNode,alt:d};this.dialogObj.setProperties({height:"inherit",width:"290px",header:r,content:o,position:{X:"center",Y:"center"},buttons:[{click:function(e){t.insertAlt(h)},buttonModel:{content:a,cssClass:"e-flat e-update-alt",isPrimary:!0}}]}),this.dialogObj.element.style.maxHeight="inherit",this.dialogObj.content.querySelector("input").focus()}}},e.prototype.insertAlt=function(e){if(!(0,i.hX)(e.alt)){e.selection.restore(),0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData();var t=e.alt.value;this.parent.formatter.process(this.parent,e.args,e.args,{altText:t,selectNode:e.selectNode,subCommand:e.args.item.subCommand}),this.dialogObj.hide({returnValue:!1})}},e.prototype.insertlink=function(e){if("IMG"===e.selectNode[0].nodeName){var t=e.link.value;if(""===t)return(0,i.iQ)([e.link],"e-error"),e.link.setSelectionRange(0,t.length),void e.link.focus();this.isUrl(t)?(0,i.vy)([e.link],"e-error"):t="http://"+t;var n=e.selfImage;if("HTML"===n.parent.editorMode&&e.selection.restore(),0===n.parent.formatter.getUndoRedoStack().length&&n.parent.formatter.saveData(),"A"===e.selectNode[0].parentElement.nodeName)return n.parent.formatter.process(n.parent,e.args,e.args,{url:t,target:n.checkBoxObj.checked?"_blank":null,selectNode:e.selectNode,subCommand:e.args.item.subCommand}),void n.dialogObj.hide({returnValue:!0});n.parent.formatter.process(n.parent,e.args,e.args,{url:t,target:n.checkBoxObj.checked?"_blank":null,selectNode:e.selectNode,subCommand:e.args.item.subCommand,selection:e.selection});var o=(0,i.kp)(e.selectNode[0],".e-img-caption");o&&(0,i.Lt)(".e-img-inner",o).focus(),o&&(0,i.Lt)(".e-img-inner",o).focus(),n.dialogObj.hide({returnValue:!1})}},e.prototype.isUrl=function(e){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi.test(e)},e.prototype.deleteImg=function(e,t){if("IMG"===e.selectNode[0].nodeName){var n={element:e.selectNode[0],src:e.selectNode[0].getAttribute("src")};0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),e.selection.restore(),this.contentModule.getEditPanel().querySelector(".e-img-resize")&&this.removeResizeEle(),this.parent.formatter.process(this.parent,e.args,e.args,{selectNode:e.selectNode,captionClass:r.id,subCommand:e.args.item.subCommand}),this.imageRemovePost(n.src),this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&this.quickToolObj.imageQTBar.hidePopup(),this.cancelResizeAction(),(0,i.hX)(t)&&this.parent.trigger(o.RW,n)}},e.prototype.imageRemovePost=function(e){var t=this,n="";if(!(0,i.hX)(this.parent.insertImageSettings.removeUrl)&&""!==this.parent.insertImageSettings.removeUrl){n=e.indexOf("http://")>-1||e.indexOf("https://")>-1?e:new URL(e,document.baseURI).href,this.removingImgName=n.replace(/^.*[\\\/]/,"");var o=new XMLHttpRequest;o.addEventListener("readystatechange",(function(){4==this.readyState&&200==this.status&&t.triggerPost(this.response)})),o.open("GET",n),o.responseType="blob",o.send()}},e.prototype.triggerPost=function(e){var t=this.parent.insertImageSettings.removeUrl;if(!(0,i.hX)(t)&&""!==t){var n=new File([e],this.removingImgName),o=new i.dj(t,"POST",!0,null),r=new FormData;r.append("UploadFiles",n),o.send(r)}},e.prototype.caption=function(e){var t=e.selectNode[0];if("IMG"===t.nodeName){e.selection.restore(),0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),this.cancelResizeAction(),(0,i.iQ)([t],"e-rte-image");var n=e.args.item?e.args.item.subCommand:"Caption";if((0,i.hX)((0,i.kp)(t,"."+r.id))){this.captionEle=this.parent.createElement("span",{className:r.id+" "+r.Qr,attrs:{contenteditable:"false",draggable:"false",style:"width:"+this.parent.insertImageSettings.width}});var o=this.parent.createElement("span",{className:"e-img-wrap"}),a=this.parent.createElement("span",{className:"e-img-inner",attrs:{contenteditable:"true"}}),s=e.selectNode[0].parentElement;"A"===s.tagName&&s.setAttribute("contenteditable","true"),o.appendChild("A"===s.tagName?s:e.selectNode[0]),o.appendChild(a);var l=this.i10n.getConstant("imageCaption");a.innerHTML=l,this.captionEle.appendChild(o),t.classList.contains(r.eh)&&(0,i.iQ)([this.captionEle],r.LP),t.classList.contains(r._L)&&(0,i.iQ)([this.captionEle],r._L),t.classList.contains(r.OP)&&(0,i.iQ)([this.captionEle],r.OP),t.classList.contains(r.fG)&&(0,i.iQ)([this.captionEle],r.fG),t.classList.contains(r.Op)&&(0,i.iQ)([this.captionEle],r.Op),this.parent.formatter.process(this.parent,e.args,e.args,{insertElement:this.captionEle,selectNode:e.selectNode,subCommand:n}),this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(),a.childNodes[0],a.childNodes[0],0,a.childNodes[0].textContent.length)}else(0,i.Yo)((0,i.kp)(t,"."+r.id)),i.Pw.isIE&&(this.contentModule.getEditPanel().focus(),e.selection.restore()),"A"===t.parentElement.tagName?this.parent.formatter.process(this.parent,e.args,e.args,{insertElement:t.parentElement,selectNode:e.selectNode,subCommand:n}):this.parent.formatter.process(this.parent,e.args,e.args,{insertElement:t,selectNode:e.selectNode,subCommand:n});this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),(0,i.vy)([t],"e-img-focus"))}},e.prototype.imageSize=function(e){var t=this;if("IMG"===e.selectNode[0].nodeName&&(this.imagDialog(e),!(0,i.hX)(this.dialogObj))){var n=this.i10n.getConstant("imageSizeHeader"),o=this.i10n.getConstant("dialogUpdate"),r=this.imgsizeInput(e),a={args:e.args,selfImage:this,selection:e.selection,selectNode:e.selectNode};this.dialogObj.setProperties({height:"inherit",width:"290px",header:n,content:r,position:{X:"center",Y:"center"},buttons:[{click:function(e){t.insertSize(a)},buttonModel:{content:o,cssClass:"e-flat e-update-size",isPrimary:!0}}]}),this.dialogObj.element.style.maxHeight="inherit",this.dialogObj.content.querySelector("input").focus()}},e.prototype.break=function(e){if("IMG"===e.selectNode[0].nodeName){var t=e.args.item?e.args.item.subCommand:"Break";this.parent.formatter.process(this.parent,e.args,e.args,{selectNode:e.selectNode,subCommand:t})}},e.prototype.inline=function(e){if("IMG"===e.selectNode[0].nodeName){var t=e.args.item?e.args.item.subCommand:"Inline";this.parent.formatter.process(this.parent,e.args,e.args,{selectNode:e.selectNode,subCommand:t})}},e.prototype.alignImage=function(e,t){var n=e.args.item?e.args.item.subCommand:t;this.parent.formatter.process(this.parent,e.args,e.args,{selectNode:e.selectNode,subCommand:n})},e.prototype.clearDialogObj=function(){this.dialogObj&&(this.dialogObj.destroy(),(0,i.Yo)(this.dialogObj.element),this.dialogObj=null)},e.prototype.imagDialog=function(e){var t=this;if(this.dialogObj)this.dialogObj.hide({returnValue:!0});else{var n=this.parent.createElement("div",{className:"e-rte-img-dialog",id:this.rteID+"_image"});this.parent.element.appendChild(n);var o=this.i10n.getConstant("dialogInsert"),a=this.i10n.getConstant("dialogCancel"),s=this.i10n.getConstant("imageHeader"),l=e.selection,d={selfImage:this,selection:e.selection,args:e.args,selectParent:e.selectParent},h={header:s,cssClass:r.bU,enableRtl:this.parent.enableRtl,locale:this.parent.locale,showCloseIcon:!0,closeOnEscape:!0,width:i.Pw.isDevice?"290px":"340px",height:"inherit",position:{X:"center",Y:i.Pw.isDevice?"center":"top"},isModal:i.Pw.isDevice,buttons:[{click:this.insertImageUrl.bind(d),buttonModel:{content:o,cssClass:"e-flat e-insertImage",isPrimary:!0,disabled:!0}},{click:function(e){t.cancelDialog(e)},buttonModel:{cssClass:"e-flat e-cancel",content:a}}],target:i.Pw.isDevice?document.body:this.parent.element,animationSettings:{effect:"None"},close:function(e){t.isImgUploaded&&t.uploadObj.removing(),t.parent.isBlur=!1,e&&e.event.returnValue&&("HTML"===t.parent.editorMode?l.restore():t.parent.formatter.editorManager.markdownSelection.restore(t.parent.contentModule.getEditPanel())),t.dialogObj.destroy(),(0,i.Yo)(t.dialogObj.element),t.dialogRenderObj.close(e),t.dialogObj=null}},p=this.parent.createElement("div",{className:"e-img-content"});(!(0,i.hX)(this.parent.insertImageSettings.path)&&"Markdown"===this.parent.editorMode||"HTML"===this.parent.editorMode)&&p.appendChild(this.imgUpload(e));var c=this.parent.createElement("div",{className:"e-linkheader"}),u=this.i10n.getConstant("imageLinkHeader");"HTML"===this.parent.editorMode?c.innerHTML=u:c.innerHTML=this.i10n.getConstant("mdimageLink"),p.appendChild(c),p.appendChild(this.imageUrlPopup(e)),e.selectNode&&"IMG"===e.selectNode[0].nodeName?(h.header=this.parent.localeObj.getConstant("editImageHeader"),h.content=p):h.content=p,this.dialogObj=this.dialogRenderObj.render(h),this.dialogObj.createElement=this.parent.createElement,this.dialogObj.appendTo(n),(0,i.hX)(this.dialogObj)||(e.selectNode&&"IMG"===e.selectNode[0].nodeName&&"insertImage"===e.name&&(this.dialogObj.element.querySelector(".e-insertImage").textContent=this.parent.localeObj.getConstant("dialogUpdate")),n.style.maxHeight="inherit",this.quickToolObj&&(this.quickToolObj.imageQTBar&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),(0,i.hX)(e.selectParent)||(0,i.vy)([e.selectParent[0]],"e-img-focus")),this.quickToolObj.inlineQTBar&&document.body.contains(this.quickToolObj.inlineQTBar.element)&&this.quickToolObj.inlineQTBar.hidePopup()))}},e.prototype.cancelDialog=function(e){this.parent.isBlur=!1,this.dialogObj.hide({returnValue:!0}),this.isImgUploaded&&this.uploadObj.removing()},e.prototype.onDocumentClick=function(e){var t=e.target;"IMG"===t.nodeName&&(this.imgEle=t),!(0,i.hX)(this.dialogObj)&&(!(0,i.kp)(t,"[id='"+this.dialogObj.element.id+"']")&&this.parent.toolbarSettings.enable&&this.parent.getToolbarElement()&&!this.parent.getToolbarElement().contains(e.target)||this.parent.getToolbarElement()&&this.parent.getToolbarElement().contains(e.target)&&!(0,i.kp)(t,"#"+this.parent.getID()+"_toolbar_Image")&&!t.querySelector("#"+this.parent.getID()+"_toolbar_Image"))&&(e.offsetX>e.target.clientWidth||e.offsetY>e.target.clientHeight||(this.dialogObj.hide({returnValue:!0}),this.parent.isBlur=!0,(0,K.Pt)(this.parent.element,"focusout"))),"IMG"===e.target.tagName||!this.imgResizeDiv||this.quickToolObj&&this.quickToolObj.imageQTBar&&this.quickToolObj.imageQTBar.element.contains(e.target)||!this.contentModule.getEditPanel().contains(this.imgResizeDiv)||this.cancelResizeAction(),this.contentModule.getEditPanel().querySelector(".e-img-resize")&&("IMG"!==t.tagName&&this.removeResizeEle(),"IMG"===t.tagName||(0,i.hX)(this.imgEle)?(0,i.hX)(this.prevSelectedImgEle)||this.prevSelectedImgEle===t||(this.prevSelectedImgEle.style.outline=""):this.imgEle.style.outline="")},e.prototype.removeResizeEle=function(){i.Jm.remove(this.contentModule.getDocument(),i.Pw.touchMoveEvent,this.resizing),i.Jm.remove(this.contentModule.getDocument(),i.Pw.touchEndEvent,this.resizeEnd),(0,i.Yo)(this.contentModule.getEditPanel().querySelector(".e-img-resize"))},e.prototype.onWindowResize=function(){(0,i.hX)(this.contentModule)||(0,i.hX)(this.contentModule.getEditPanel().querySelector(".e-img-resize"))||this.cancelResizeAction()},e.prototype.imageUrlPopup=function(e){var t=this,n=this.parent.createElement("div",{className:"imgUrl"}),o=this.i10n.getConstant("imageUrl");return this.inputUrl=this.parent.createElement("input",{className:"e-input e-img-url",attrs:{placeholder:o,spellcheck:"false"}}),this.inputUrl.addEventListener("input",(function(){(0,i.hX)(t.inputUrl)||(0===t.inputUrl.value.length?t.dialogObj.getButtons(0).element.disabled=!0:t.dialogObj.getButtons(0).element.removeAttribute("disabled"))})),n.appendChild(this.inputUrl),n},e.prototype.insertImageUrl=function(e){var t=this.selfImage;t.isImgUploaded=!1;var n=t.inputUrl.value;if(0===t.parent.formatter.getUndoRedoStack().length&&t.parent.formatter.saveData(),(0,i.hX)(t.uploadUrl)||""===t.uploadUrl.url){if(""!==n){if("HTML"===t.parent.editorMode&&(0,i.hX)((0,i.kp)(this.selection.range.startContainer.parentNode,"[id='"+t.contentModule.getPanel().id+"']"))){t.contentModule.getEditPanel().focus();var o=t.parent.formatter.editorManager.nodeSelection.getRange(t.contentModule.getDocument());this.selection=t.parent.formatter.editorManager.nodeSelection.save(o,t.contentModule.getDocument()),this.selectParent=t.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(o)}var a=/[\w-]+.(jpg|png|jpeg|gif)/g,s=(0,i.hX)(n.match(a))||"HTML"!==t.parent.editorMode?"":n.match(a)[0],l={cssClass:"inline"===t.parent.insertImageSettings.display?r.eh:r._L,url:n,selection:this.selection,altText:s,selectParent:this.selectParent,width:{width:t.parent.insertImageSettings.width,minWidth:t.parent.insertImageSettings.minWidth,maxWidth:t.parent.getInsertImgMaxWidth()},height:{height:t.parent.insertImageSettings.height,minHeight:t.parent.insertImageSettings.minHeight,maxHeight:t.parent.insertImageSettings.maxHeight}};t.parent.formatter.process(t.parent,this.args,this.args.originalEvent,l),t.dialogObj.hide({returnValue:!1})}}else t.uploadUrl.cssClass="inline"===t.parent.insertImageSettings.display?r.eh:r._L,t.dialogObj.hide({returnValue:!1}),t.parent.formatter.process(t.parent,this.args,this.args.originalEvent,t.uploadUrl),t.uploadUrl.url="",t.contentModule.getEditPanel().querySelector(".e-img-resize")&&(t.imgEle.style.outline="",t.removeResizeEle())},e.prototype.imgsizeInput=function(e){var t=this,n=e.selectNode[0],o=this.i10n.getConstant("imageHeight"),r=this.i10n.getConstant("imageWidth"),s=this.parent.createElement("div",{className:"e-img-sizewrap"}),l=!(0,i.hX)(this.changedWidthValue)||"auto"!==n.style.width.toString()&&""===n.style.width?(0,i.hX)(this.changedWidthValue)?parseInt(n.getClientRects()[0].width.toString(),10).toString():this.changedWidthValue:n.style.width,d=!(0,i.hX)(this.changedHeightValue)||"auto"!==n.style.height.toString()&&""===n.style.height?(0,i.hX)(this.changedHeightValue)?parseInt(n.getClientRects()[0].height.toString(),10).toString():this.changedHeightValue:n.style.height;this.changedWidthValue=null,this.changedHeightValue=null;var h='<div class="e-rte-label"><label>'+r+'</label></div><div class="e-rte-field"><input type="text" id="imgwidth" class="e-img-width" value='+l+' /></div><div class="e-rte-label"><label>'+o+'</label></div><div class="e-rte-field"> <input type="text" id="imgheight" class="e-img-height" value='+d+" /></div>",p=(0,K.ZC)(h);s.appendChild(p);var c=new a.f({value:(0,i.IV)(l),enableRtl:this.parent.enableRtl,input:function(e){t.inputWidthValue=(0,i.IV)(t.inputValue(e.value))}});c.createElement=this.parent.createElement,c.appendTo(s.querySelector("#imgwidth"));var u=new a.f({value:(0,i.IV)(d),enableRtl:this.parent.enableRtl,input:function(e){t.inputHeightValue=(0,i.IV)(t.inputValue(e.value))}});return u.createElement=this.parent.createElement,u.appendTo(s.querySelector("#imgheight")),s},e.prototype.inputValue=function(e){return"auto"===e||-1!==e.indexOf("%")||-1!==e.indexOf("px")||e.match(/(\d+)/)?e:"auto"},e.prototype.insertSize=function(e){e.selection.restore();var t=e.selfImage;0===t.parent.formatter.getUndoRedoStack().length&&t.parent.formatter.saveData();var n=t.dialogObj.element;this.changedWidthValue=this.inputWidthValue,this.changedHeightValue=this.inputHeightValue;var i=n.querySelector(".e-img-width").value,o=n.parentElement.querySelector(".e-img-height").value;t.parent.formatter.process(this.parent,e.args,e.args,{width:i,height:o,selectNode:e.selectNode,subCommand:e.args.item.subCommand}),this.imgResizeDiv&&t.imgResizePos(e.selectNode[0],this.imgResizeDiv),t.dialogObj.hide({returnValue:!0})},e.prototype.insertImage=function(e){if(this.imagDialog(e),!(0,i.hX)(this.dialogObj)){this.dialogObj.element.style.maxHeight="inherit";var t=this.dialogObj.element.querySelector(".e-img-content");!(0,i.hX)(this.parent.insertImageSettings.path)&&"Markdown"===this.parent.editorMode||"HTML"===this.parent.editorMode?document.getElementById(this.rteID+"_insertImage").focus():t.querySelector(".e-img-url").focus()}},e.prototype.imgUpload=function(e){var t,n,r=this,a=this,s=a.parent.iframeSettings.enable;if("HTML"===a.parent.editorMode&&(!s&&(0,i.hX)((0,i.kp)(e.selection.range.startContainer.parentNode,"[id='"+this.parent.contentModule.getPanel().id+"']"))||s&&!(0,K.nB)(e.selection.range.startContainer.parentNode.ownerDocument.querySelector("body"),"e-lib"))){this.contentModule.getEditPanel().focus();var l=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());t=this.parent.formatter.editorManager.nodeSelection.save(l,this.parent.contentModule.getDocument()),n=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(l)}else t=e.selection,n=e.selectParent;var d=this.parent.createElement("div",{className:"e-img-uploadwrap e-droparea"}),h=this.i10n.getConstant("imageDeviceUploadMessage"),p=this.i10n.getConstant("imageUploadMessage"),c=this.parent.createElement("span",{className:"e-droptext"}),u=this.parent.createElement("span",{className:"e-rte-upload-text",innerHTML:i.Pw.isDevice?h:p});c.appendChild(u);var m=this.parent.createElement("button",{className:"e-browsebtn",id:this.rteID+"_insertImage",attrs:{autofocus:"true",type:"button"}});c.appendChild(m),d.appendChild(c);var g=this.i10n.getConstant("browse"),f=new Y.$({content:g,enableRtl:this.parent.enableRtl});f.isStringTemplate=!0,f.createElement=this.parent.createElement,f.appendTo(m);var b=i.Pw.isDevice?c:m;i.Jm.add(b,"click",this.fileSelect,this);var v,y,C,S,E,w=this.parent.createElement("input",{id:this.rteID+"_upload",attrs:{type:"File",name:"UploadFiles"}});return d.appendChild(w),this.uploadObj=new W({asyncSettings:{saveUrl:this.parent.insertImageSettings.saveUrl,removeUrl:this.parent.insertImageSettings.removeUrl},dropArea:c,multiple:!1,enableRtl:this.parent.enableRtl,allowedExtensions:this.parent.insertImageSettings.allowedTypes.toString(),selected:function(e){a.isImgUploaded=!0,C=e,S=e.filesData,r.parent.isServerRendered&&(C=JSON.parse(JSON.stringify(e)),e.cancel=!0,y=e.filesData,C.filesData=y),r.parent.trigger(o.L_,C,(function(e){if(!e.cancel){if(r.checkExtension(e.filesData[0]),v=e.filesData[0].name,"HTML"===r.parent.editorMode&&(0,i.hX)(r.parent.insertImageSettings.path)){var o=new FileReader;o.addEventListener("load",(function(e){var s="Base64"===r.parent.insertImageSettings.saveFormat?o.result:URL.createObjectURL((0,K.yN)(o.result));a.uploadUrl={url:s,selection:t,altText:v,selectParent:n,width:{width:a.parent.insertImageSettings.width,minWidth:a.parent.insertImageSettings.minWidth,maxWidth:a.parent.getInsertImgMaxWidth()},height:{height:a.parent.insertImageSettings.height,minHeight:a.parent.insertImageSettings.minHeight,maxHeight:a.parent.insertImageSettings.maxHeight}},a.inputUrl.setAttribute("disabled","true"),(0,i.hX)(a.parent.insertImageSettings.saveUrl)&&r.isAllowedTypes&&!(0,i.hX)(r.dialogObj)&&r.dialogObj.getButtons(0).element.removeAttribute("disabled")})),o.readAsDataURL(e.filesData[0].rawFile)}r.parent.isServerRendered&&r.uploadObj._internalRenderSelect(e,y)}}))},beforeUpload:function(e){r.parent.isServerRendered?((E=JSON.parse(JSON.stringify(e))).filesData=S,e.cancel=!0,r.parent.trigger(o.Pl,E,(function(e){e.cancel||(r.uploadObj.currentRequestHeader=e.currentRequest?e.currentRequest:r.uploadObj.currentRequestHeader,r.uploadObj.customFormDatas=e.customFormData&&e.customFormData.length>0?e.customFormData:r.uploadObj.customFormDatas,r.uploadObj.uploadFiles(y,null))}))):r.parent.trigger(o.Ox,e)},uploading:function(e){r.parent.isServerRendered||r.parent.trigger(o.Pl,e)},success:function(e){r.parent.trigger(o.az,e,(function(e){if(!(0,i.hX)(r.parent.insertImageSettings.path)){var o=r.parent.insertImageSettings.path+e.file.name;a.uploadUrl={url:o,selection:t,altText:v,selectParent:n,width:{width:a.parent.insertImageSettings.width,minWidth:a.parent.insertImageSettings.minWidth,maxWidth:a.parent.getInsertImgMaxWidth()},height:{height:a.parent.insertImageSettings.height,minHeight:a.parent.insertImageSettings.minHeight,maxHeight:a.parent.insertImageSettings.maxHeight}},a.inputUrl.setAttribute("disabled","true")}"upload"!==e.operation||(0,i.hX)(r.dialogObj)||r.dialogObj.getButtons(0).element.removeAttribute("disabled")}))},failure:function(e){r.parent.trigger(o.mB,e)},removing:function(){r.parent.trigger(o.Ry,e,(function(e){a.isImgUploaded=!1,r.dialogObj.getButtons(0).element.disabled=!0,a.inputUrl.removeAttribute("disabled"),a.uploadUrl&&(a.uploadUrl.url="")}))}}),this.uploadObj.isStringTemplate=!0,this.uploadObj.createElement=this.parent.createElement,this.uploadObj.appendTo(w),d},e.prototype.checkExtension=function(e){this.uploadObj.allowedExtensions&&(-1===this.uploadObj.allowedExtensions.toLocaleLowerCase().indexOf(("."+e.type).toLocaleLowerCase())?(this.dialogObj.getButtons(0).element.setAttribute("disabled","disabled"),this.isAllowedTypes=!1):this.isAllowedTypes=!0)},e.prototype.fileSelect=function(){return this.dialogObj.element.getElementsByClassName("e-file-select-wrap")[0].querySelector("button").click(),!1},e.prototype.dragStart=function(e){if("IMG"!==e.target.nodeName)return!0;this.parent.trigger(o.eY,e,(function(t){t.cancel?e.preventDefault():(e.dataTransfer.effectAllowed="copyMove",e.target.classList.add(r.eB))}))},e.prototype.dragEnter=function(e){e.dataTransfer.dropEffect="copy",e.preventDefault()},e.prototype.dragOver=function(e){if(!("edge"===i.Pw.info.name&&e.dataTransfer.items[0].type.split("/")[0].indexOf("image")>-1||i.Pw.isIE&&"Files"===e.dataTransfer.types[0]))return!0;e.preventDefault()},e.prototype.dragDrop=function(e){var t=this;this.parent.trigger(o.yr,e,(function(e){var n=t.parent.inputElement.ownerDocument.querySelector("."+r.eB),a=n&&"IMG"===n.tagName||e.dataTransfer.files.length>0;!e.cancel&&a?t.parent.trigger(o.eY,e,(function(n){if(n.cancel)e.preventDefault();else{if((0,i.kp)(e.target,"#"+t.parent.getID()+"_toolbar")||"false"===t.parent.inputElement.contentEditable)return void e.preventDefault();t.parent.element.querySelector("."+r.cd)&&(0,i.Yo)(t.imgResizeDiv),e.preventDefault();var a=void 0;if(t.contentModule.getDocument().caretRangeFromPoint?a=t.contentModule.getDocument().caretRangeFromPoint(e.clientX,e.clientY):e.rangeParent?(a=t.contentModule.getDocument().createRange()).setStart(e.rangeParent,e.rangeOffset):a=t.getDropRange(e.clientX,e.clientY),t.parent.notify(o.N$,{range:a}),t.parent.element.querySelector("."+r.mE))return;t.insertDragImage(e)}})):a&&e.preventDefault()}))},e.prototype.getDropRange=function(e,t){var n=this.contentModule.getDocument().createRange();this.parent.formatter.editorManager.nodeSelection.setRange(this.contentModule.getDocument(),n);var i=this.contentModule.getDocument().elementFromPoint(e,t),o=i.childNodes.length>0?i.childNodes[0]:i,r=0;if("<br>"===this.parent.inputElement.firstChild.innerHTML)n.setStart(o,r),n.setEnd(o,r);else{var a=void 0;do{r++,n.setStart(o,r),n.setEnd(o,r+1),a=n.getBoundingClientRect()}while(a.left<e&&r<o.length-1)}return n},e.prototype.insertDragImage=function(e){var t=this;e.preventDefault();var n=this.parent.element.querySelector(""+r.Fb);this.parent.notify(o.gv,{args:e}),n&&n.classList.add(r.sB);var i=this.parent.inputElement.ownerDocument.querySelector("."+r.eB);if(e.dataTransfer.files.length>0&&null===i){if(e.dataTransfer.files.length>1)return;for(var a=e.dataTransfer.files,s=a[0].name,l=s.substring(s.lastIndexOf(".")),d=this.parent.insertImageSettings.allowedTypes,h=0;h<d.length;h++)if(l.toLocaleLowerCase()===d[h].toLowerCase())if(this.parent.insertImageSettings.saveUrl)this.onSelect(e);else{var p={args:e,text:"",file:a[0]};e.preventDefault(),this.imagePaste(p)}}else{var c=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());if(i&&"IMG"===i.tagName){i.nextElementSibling&&i.nextElementSibling.classList.contains(r.ED)?c.insertNode(i.parentElement.parentElement):c.insertNode(i),i.classList.remove(r.eB);var u={elements:[i]};i.addEventListener("load",(function(){t.parent.trigger(o.wn,u)})),this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument());p=e;this.resizeStart(p,i),this.hideImageQuickToolbar()}}},e.prototype.onSelect=function(e){var t=this,n=this,a=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),s=this.parent.createElement("ul",{className:r.ew});this.parent.element.appendChild(s);var l={name:"",size:0,status:"",statusCode:"",type:"",rawFile:e.dataTransfer.files[0],validationMessages:{}},d=this.parent.createElement("IMG");d.style.opacity="0.5",d.classList.add(r.nw),d.classList.add(r.eh),d.classList.add(r.C4);var h=l.rawFile,p=new FileReader;p.addEventListener("load",(function(){var e=URL.createObjectURL((0,K.yN)(p.result));d.src="Blob"===n.parent.insertImageSettings.saveFormat?e:p.result})),h&&p.readAsDataURL(h),a.insertNode(d),this.uploadMethod(e,d);var c={elements:[d]};d.addEventListener("load",(function(){t.parent.trigger(o.wn,c)})),(0,i.Yo)(s)},e.prototype.uploadMethod=function(e,t){var n=this,a=!1,s=this,l=this.parent.createElement("div");this.parent.element.appendChild(l);var d=this.parent.createElement("input",{id:this.rteID+"_upload",attrs:{type:"File",name:"UploadFiles"}}),h=this.parent.iframeSettings.enable?-50:-90;this.popupObj=new _.zD(l,{relateTo:t,height:"85px",width:"300px",offsetY:h,content:d,viewPortElement:this.parent.element,position:{X:"center",Y:"top"},enableRtl:this.parent.enableRtl,zIndex:10001,close:function(e){n.parent.isBlur=!1,n.popupObj.destroy(),(0,i.Yo)(n.popupObj.element),n.popupObj=null,n.parent.inlineMode.enable||n.parent.toolbarModule.baseToolbar.toolbarObj.disable(!1)}}),this.popupObj.element.style.display="none",(0,i.iQ)([this.popupObj.element],r.Fb),(0,i.iQ)([this.popupObj.element],r.Eg);var p,c,u=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),m=e.dataTransfer.files[0].size>1e6?300:100;setTimeout((function(){s.refreshPopup(t)}),m),this.uploadObj=new W({asyncSettings:{saveUrl:this.parent.insertImageSettings.saveUrl,removeUrl:this.parent.insertImageSettings.removeUrl},cssClass:r.Mg,dropArea:this.parent.element,allowedExtensions:this.parent.insertImageSettings.allowedTypes.toString(),removing:function(){n.parent.inputElement.contentEditable="true",a=!1,(0,i.Yo)(t),n.popupObj.close()},canceling:function(){n.parent.inputElement.contentEditable="true",a=!1,(0,i.Yo)(t),n.popupObj.close(),n.quickToolObj.imageQTBar.hidePopup(),setTimeout((function(){n.uploadObj.destroy()}),900)},beforeUpload:function(e){n.parent.isServerRendered?((c=JSON.parse(JSON.stringify(e))).filesData=p,a=!0,e.cancel=!0,n.parent.trigger(o.Pl,c,(function(e){e.cancel||(n.parent.inlineMode.enable||n.parent.toolbarModule.baseToolbar.toolbarObj.disable(!0),n.uploadObj.currentRequestHeader=e.currentRequest?e.currentRequest:n.uploadObj.currentRequestHeader,n.uploadObj.customFormDatas=e.customFormData&&e.customFormData.length>0?e.customFormData:n.uploadObj.customFormDatas,n.uploadObj.uploadFiles(p,null),n.parent.inputElement.contentEditable="false")}))):(n.parent.trigger(o.Ox,e),n.parent.inlineMode.enable||n.parent.toolbarModule.baseToolbar.toolbarObj.disable(!0))},uploading:function(e){n.parent.isServerRendered||(a=!0,n.parent.trigger(o.Pl,e,(function(e){e.cancel?((0,i.hX)(t)||(0,i.Yo)(t),(0,i.hX)(n.popupObj.element)||(0,i.Yo)(n.popupObj.element)):n.parent.inputElement.contentEditable="false"})))},selected:function(e){a&&(e.cancel=!0),n.parent.isServerRendered&&(p=e.filesData)},failure:function(i){a=!1,n.parent.inputElement.contentEditable="true";var o={args:e,type:"Images",isNotify:void 0,elements:t};setTimeout((function(){n.uploadFailure(t,o,i)}),900)},success:function(i){if("cancel"!==i.operation){a=!1,n.parent.inputElement.contentEditable="true";var o={args:e,type:"Images",isNotify:void 0,elements:t};setTimeout((function(){n.uploadSuccess(t,e,o,i)}),900)}}}),this.uploadObj.appendTo(this.popupObj.element.childNodes[0]),this.popupObj.element.querySelector(".e-rte-dialog-upload .e-file-select-wrap").style.display="none",u.selectNodeContents(t),this.parent.formatter.editorManager.nodeSelection.setRange(this.contentModule.getDocument(),u)},e.prototype.refreshPopup=function(e){(this.parent.iframeSettings.enable?this.parent.element.offsetTop+e.offsetTop:e.offsetTop)>this.parent.element.offsetTop+this.parent.element.offsetHeight?(this.popupObj.relateTo=this.parent.inputElement,this.popupObj.offsetY=this.parent.iframeSettings.enable?-30:-65,this.popupObj.element.style.display="block"):this.popupObj&&(this.popupObj.refreshPosition(e),this.popupObj.element.style.display="block")},e.prototype.uploadFailure=function(e,t,n){(0,i.Yo)(e),this.popupObj&&this.popupObj.close(),this.parent.trigger(o.mB,n),this.uploadObj.destroy()},e.prototype.uploadSuccess=function(e,t,n,a){var s=this;e.style.opacity="1",e.classList.add(r.cl),a.element=e,this.parent.trigger(o.az,a,(function(t){if(!(0,i.hX)(s.parent.insertImageSettings.path)){var n=s.parent.insertImageSettings.path+t.file.name;e.src=n,e.setAttribute("alt",t.file.name)}})),this.popupObj&&(this.popupObj.close(),this.uploadObj.destroy()),this.showImageQuickToolbar(n),this.resizeStart(t,e)},e.prototype.imagePaste=function(e){var t=this;if(0===e.text.length&&!(0,i.hX)(e.file)){var n=this,o=new FileReader;e.args.preventDefault(),o.addEventListener("load",(function(a){var s={cssClass:"inline"===n.parent.insertImageSettings.display?r.eh:r._L,url:"Base64"!==t.parent.insertImageSettings.saveFormat&&(0,i.hX)(e.callBack)?URL.createObjectURL((0,K.yN)(o.result)):o.result,width:{width:n.parent.insertImageSettings.width,minWidth:n.parent.insertImageSettings.minWidth,maxWidth:n.parent.getInsertImgMaxWidth()},height:{height:n.parent.insertImageSettings.height,minHeight:n.parent.insertImageSettings.minHeight,maxHeight:n.parent.insertImageSettings.maxHeight}};(0,i.hX)(e.callBack)?(n.parent.formatter.process(n.parent,{item:{command:"Images",subCommand:"Image"}},e.args,s),t.showPopupToolBar(e,s)):e.callBack(s)})),o.readAsDataURL(e.file)}},e.prototype.showPopupToolBar=function(e,t){var n=this,i='img[src="'+t.url+'"]',o=this.parent.inputElement.querySelector(i);this.parent.quickToolbarModule.createQTBar("Image","MultiRow",this.parent.quickToolbarSettings.image,V.nJ.ImageToolbar);var r={args:e.args,type:"Images",isNotify:void 0,elements:o};o&&setTimeout((function(){n.showImageQuickToolbar(r),n.resizeStart(e.args,o)}),0)},e.prototype.destroy=function(){this.prevSelectedImgEle=void 0,this.removeEventListener()},e.prototype.getModuleName=function(){return"image"},e}()},6321:(e,t,n)=>{n.d(t,{N:()=>h});var i=n(8452),o=n(5290),r=n(5624),a=n(6257),s=n(1411),l=n(134),d=n(5453),h=function(){function e(e,t){this.parent=e,this.rteID=e.element.id,this.i10n=t.getService("rteLocale"),this.addEventListener(),this.serviceLocator=t,this.rendererFactory=t.getService("rendererFactory"),this.dialogRenderObj=t.getService("dialogRenderObject")}return e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(o.Ck,this.linkDialog,this),this.parent.on(o.WM,this.showDialog,this),this.parent.on(o.Ds,this.closeDialog,this),this.parent.on(o.u2,this.onKeyDown,this),this.parent.on(o.tq,this.showLinkQuickToolbar,this),this.parent.on(o.XY,this.clearDialogObj,this),this.parent.on(o.dJ,this.onToolbarAction,this),this.parent.on(o.KK,this.onIframeMouseDown,this),this.parent.on(o.yL,this.removeLink,this),this.parent.on(o.bv,this.editLink,this),this.parent.on(o.Fe,this.openLink,this),this.parent.on(o.ot,this.editAreaClickHandler,this),this.parent.on(o.zr,this.destroy,this))},e.prototype.onToolbarAction=function(e){switch(e.args.item.subCommand){case"OpenLink":this.parent.notify(o.Fe,e);break;case"EditLink":this.parent.notify(o.bv,e);break;case"RemoveLink":this.parent.notify(o.yL,e)}},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(o.Ck,this.linkDialog),this.parent.off(o.WM,this.showDialog),this.parent.off(o.Ds,this.closeDialog),this.parent.off(o.u2,this.onKeyDown),this.parent.off(o.tq,this.showLinkQuickToolbar),this.parent.off(o.XY,this.clearDialogObj),this.parent.off(o.dJ,this.onToolbarAction),this.parent.off(o.yL,this.removeLink),this.parent.off(o.KK,this.onIframeMouseDown),this.parent.off(o.bv,this.editLink),this.parent.off(o.Fe,this.openLink),this.parent.off(o.ot,this.editAreaClickHandler),this.parent.off(o.zr,this.destroy))},e.prototype.onIframeMouseDown=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},e.prototype.showLinkQuickToolbar=function(e){if(!(0,i.hX)(e.args)&&"enter"!==e.args.action&&"space"!==e.args.action){var t=void 0,n=void 0;if("Links"!==e.type||(0,i.hX)(this.parent.quickToolbarModule)||(0,i.hX)(this.parent.quickToolbarModule.linkQTBar))return;this.quickToolObj=this.parent.quickToolbarModule;var o,r=this.parent.element.getBoundingClientRect().top,a=this.parent.element.getBoundingClientRect().left,s=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());if([].forEach.call(e.elements,(function(e,t){0===t&&(o="#text"===e.nodeName?e.parentNode:e)})),e.isNotify){var l=this.parent.toolbarModule.getToolbarElement(),d=o.getBoundingClientRect().top,h=o.getBoundingClientRect().left,p=d-r,c=l?l.offsetHeight+this.parent.toolbarModule.getExpandTBarPopHeight():0;t=this.parent.iframeSettings.enable?a+h:o.getBoundingClientRect().left,n=window.pageYOffset+(this.parent.iframeSettings.enable?r+c+d:r+p)}else{var u=void 0;u=e.args.touches?e.args.changedTouches[0]:u=e.args,t=this.parent.iframeSettings.enable?window.pageXOffset+a+u.clientX:u.pageX,n=this.parent.iframeSettings.enable?window.pageYOffset+r+u.clientY:u.pageY}this.quickToolObj.linkQTBar&&this.quickToolObj.linkQTBar.showPopup(t,n,s.endContainer)}},e.prototype.hideLinkQuickToolbar=function(){this.quickToolObj&&this.quickToolObj.linkQTBar&&document.body.contains(this.quickToolObj.linkQTBar.element)&&this.quickToolObj.linkQTBar.hidePopup()},e.prototype.editAreaClickHandler=function(e){if(this.parent.readonly)this.hideLinkQuickToolbar();else{var t=e.args,n=this.parent.quickToolbarSettings.showOnRightClick;if(!(2===t.which||n&&1===t.which||!n&&3===t.which)&&"HTML"===this.parent.editorMode&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.linkQTBar){this.quickToolObj=this.parent.quickToolbarModule;var o=t.target;o=this.getAnchorNode(o),this.contentModule=this.rendererFactory.getRenderer(s.nJ.Content);var r=this.quickToolObj.linkQTBar.element.classList.contains("e-rte-pop");if("A"===o.nodeName&&o.childNodes.length>0&&"IMG"!==o.childNodes[0].nodeName&&"IMG"!==e.args.target.nodeName&&!(0,i.hX)((0,i.kp)(this.parent.getRange().startContainer.parentElement,"A"))&&!(0,i.hX)((0,i.kp)(this.parent.getRange().endContainer.parentElement,"A"))){if(r)return;this.showLinkQuickToolbar({args:t,isNotify:!1,type:"Links",elements:[t.target]})}else this.hideLinkQuickToolbar()}}},e.prototype.onKeyDown=function(e){var t=e.args;switch(t.action){case"escape":(0,i.hX)(this.dialogObj)||this.dialogObj.close();break;case"insert-link":this.openDialog(!0,e),t.preventDefault()}},e.prototype.openDialog=function(e,t){if(e||this.parent.contentModule.getEditPanel().focus(),"HTML"===this.parent.editorMode){var n=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),i=this.parent.formatter.editorManager.nodeSelection.save(n,this.parent.contentModule.getDocument()),o=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(n),r=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(n),a={args:t?t.args:{item:{command:"Links",subCommand:"CreateLink"},originalEvent:void 0},selectNode:o,selection:i,selectParent:r};this.linkDialog(a)}else{var s=this.parent.contentModule.getEditPanel();this.parent.formatter.editorManager.markdownSelection.save(s.selectionStart,s.selectionEnd),this.linkDialog({args:{item:{command:"Links",subCommand:"Link"},originalEvent:t&&t.args},member:"link",text:this.parent.formatter.editorManager.markdownSelection.getSelectedText(this.parent.contentModule.getEditPanel()),module:"Markdown",name:"insertLink"})}},e.prototype.showDialog=function(){this.openDialog(!1)},e.prototype.closeDialog=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},e.prototype.clearDialogObj=function(){this.dialogObj&&(this.dialogObj.destroy(),(0,i.Yo)(this.dialogObj.element),this.dialogObj=null)},e.prototype.linkDialog=function(e,t){var n=this;if(this.dialogObj)this.dialogObj.hide({returnValue:!0});else if("HTML"===this.parent.editorMode&&e.selectParent.length>0&&!(0,i.hX)(e.selectParent[0].classList)&&e.selectParent[0].classList.contains("e-rte-anchor")&&(0,i.hX)(t))this.editLink(e);else{var o=this.i10n.getConstant("linkWebUrl"),s=this.i10n.getConstant("linkText"),d=this.i10n.getConstant("linkTooltipLabel"),h=this.i10n.getConstant("linkurl"),p=this.i10n.getConstant("textPlaceholder"),c=this.i10n.getConstant("linkTitle"),u=this.parent.createElement("div",{className:"e-rte-link-dialog",id:this.rteID+"_rtelink"});this.parent.element.appendChild(u);var m=this.parent.createElement("div",{className:"e-rte-linkcontent",id:this.rteID+"_linkContent"}),g='<div class="e-rte-label"><label>'+o+'</label></div><div class="e-rte-field"><input type="text" data-role ="none" spellcheck="false" placeholder="'+h+'" class="e-input e-rte-linkurl"/></div><div class="e-rte-label"><label>'+s+'</label></div><div class="e-rte-field"> <input type="text" data-role ="none" spellcheck="false" class="e-input e-rte-linkText" placeholder="'+p+'"></div><div class="e-rte-label">'+("HTML"===this.parent.editorMode?"<label>"+d+'</label></div><div class="e-rte-field"><input type="text" data-role ="none" spellcheck="false" placeholder = "'+c+'" class="e-input e-rte-linkTitle"></div><div class="e-rte-label"></div><div class="e-rte-field"><input type="checkbox" class="e-rte-linkTarget"  data-role ="none"></div>':""),f=(0,l.ZC)(g);m.appendChild(f);var b=m.querySelector(".e-rte-linkTarget"),v=m.querySelector(".e-rte-linkurl"),y=m.querySelector(".e-rte-linkText"),C=m.querySelector(".e-rte-linkTitle"),S=this.i10n.getConstant("linkOpenInNewWindow");this.checkBoxObj=new a.o({label:S,checked:!0,enableRtl:this.parent.enableRtl}),this.checkBoxObj.isStringTemplate=!0,this.checkBoxObj.createElement=this.parent.createElement,this.checkBoxObj.appendTo(b);var E="HTML"===this.parent.editorMode?e.selection.getRange(this.parent.contentModule.getDocument()).toString():e.text,w=this.i10n.getConstant("dialogInsert"),T=this.i10n.getConstant("dialogCancel"),k=e.selection,N={selfLink:this,selection:e.selection,selectParent:e.selectParent,args:e.args},L={header:this.i10n.getConstant("linkHeader"),content:m,cssClass:r.bU,enableRtl:this.parent.enableRtl,locale:this.parent.locale,showCloseIcon:!0,closeOnEscape:!0,width:i.Pw.isDevice?"290px":"310px",height:"inherit",isModal:i.Pw.isDevice,buttons:[{click:this.insertlink.bind(N),buttonModel:{content:w,cssClass:"e-flat e-insertLink",isPrimary:!0}},{click:this.cancelDialog.bind(N),buttonModel:{cssClass:"e-flat",content:T}}],target:i.Pw.isDevice?document.body:this.parent.element,animationSettings:{effect:"None"},close:function(e){n.parent.isBlur=!1,e&&e.event.returnValue&&("HTML"===n.parent.editorMode?k.restore():n.parent.formatter.editorManager.markdownSelection.restore(n.parent.contentModule.getEditPanel())),n.dialogObj.destroy(),(0,i.Yo)(n.dialogObj.element);var t=n.dialogObj;n.dialogRenderObj.close(t),n.dialogObj=null}};this.dialogObj=this.dialogRenderObj.render(L),this.dialogObj.createElement=this.parent.createElement,this.dialogObj.appendTo(u),u.style.maxHeight="inherit",(0,i.hX)(this.dialogObj)||((0,i.hX)(t)||(v.value=t.url,y.value=t.text,C.value=t.title,t.target?this.checkBoxObj.checked=!0:this.checkBoxObj.checked=!1,this.dialogObj.header=t.header,this.dialogObj.element.querySelector(".e-insertLink").textContent=t.btnText),this.checkUrl(!1),("HTML"===this.parent.editorMode&&(0,i.hX)(t)&&(!(0,i.hX)(E)&&""!==E&&0===e.selection.range.startOffset||e.selection.range.startOffset!==e.selection.range.endOffset)||"Markdown"===e.module)&&(y.value=E),i.Jm.add(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick,this),this.quickToolObj&&(this.hideLinkQuickToolbar(),this.quickToolObj.inlineQTBar&&document.body.contains(this.quickToolObj.inlineQTBar.element)&&this.quickToolObj.inlineQTBar.hidePopup()))}},e.prototype.insertlink=function(e){var t,n=this.selfLink.dialogObj.element,o=n.querySelector(".e-rte-linkurl").value,r=n.querySelector(".e-rte-linkText").value;"HTML"===this.selfLink.parent.editorMode&&(t=n.querySelector(".e-rte-linkTitle").value);var a=this.selfLink.checkBoxObj.checked?"_blank":null;if(""!==o){this.selfLink.isUrl(o)?this.selfLink.checkUrl(!1):(r=""===r?o:r,this.selfLink.parent.enableAutoUrl||(o=o.indexOf("http")>-1?o:"http://"+o));var s=this.selfLink;if("HTML"===s.parent.editorMode&&(0,i.hX)((0,i.kp)(this.selection.range.startContainer.parentNode,"[id='"+s.parent.contentModule.getPanel().id+"']"))){s.parent.contentModule.getEditPanel().focus(),i.Pw.isIE&&s.parent.iframeSettings.enable&&this.selection.restore();var l=s.parent.formatter.editorManager.nodeSelection.getRange(s.parent.contentModule.getDocument());this.selection=s.parent.formatter.editorManager.nodeSelection.save(l,s.parent.contentModule.getDocument()),this.selectParent=s.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(l)}var h,p={url:o,text:r,title:t,target:a,selection:this.selection,selectParent:this.selectParent};if(document.body.contains(s.dialogObj.element)&&this.selfLink.dialogObj.hide({returnValue:!1}),(0,d.wU)()&&s.parent.iframeSettings.enable&&(0,i.Lt)("iframe",s.parent.element).contentWindow.focus(),"HTML"===s.parent.editorMode&&this.selection.restore(),0===s.parent.formatter.getUndoRedoStack().length&&s.parent.formatter.saveData(),(0,i.hX)(this.args)||"KeyK"!==this.args.code)h=this.args;else{var c=this.args;(0,i.X$)(this.args,{item:{command:"Links",subCommand:"CreateLink"},originalEvent:c},!0),h={item:{command:"Links",subCommand:"CreateLink"},originalEvent:c}}this.selfLink.parent.formatter.process(this.selfLink.parent,h,!(0,i.hX)(this.args)&&this.args.originalEvent,p),this.selfLink.parent.contentModule.getEditPanel().focus()}else this.selfLink.checkUrl(!0)},e.prototype.isUrl=function(e){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi.test(e)},e.prototype.checkUrl=function(e){var t=this.dialogObj.element.querySelector(".e-rte-linkurl");e?((0,i.iQ)([t],"e-error"),t.setSelectionRange(0,t.value.length),t.focus()):(0,i.vy)([t],"e-error")},e.prototype.removeLink=function(e){0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),this.parent.formatter.process(this.parent,e.args,e.args,{selectNode:e.selectNode,selectParent:e.selectParent,selection:e.selection,subCommand:e.args.item.subCommand}),(0,d.wU)()&&this.parent.iframeSettings.enable?(0,i.Lt)("iframe",this.parent.element).contentWindow.focus():this.parent.contentModule.getEditPanel().focus(),this.hideLinkQuickToolbar()},e.prototype.openLink=function(e){var t=this.getAnchorNode(e.selectParent[0]);(t.classList.contains("e-rte-anchor")||"A"===t.tagName)&&this.parent.formatter.process(this.parent,e.args,e.args,{url:t.href,target:""===t.target?"_self":"_blank",selectNode:e.selectNode,subCommand:e.args.item.subCommand})},e.prototype.getAnchorNode=function(e){var t=(0,i.kp)(e,"a");return t||e},e.prototype.editLink=function(e){var t=this.getAnchorNode(e.selectNode[0]),n=this.getAnchorNode(e.selectParent[0]);if((n="A"===t.nodeName?t:n).classList.contains("e-rte-anchor")||"A"===n.tagName){var i=this.i10n.getConstant("dialogUpdate"),o={url:n.getAttribute("href"),text:n.innerText,title:n.title,target:n.target,header:this.i10n.getConstant("editLink"),btnText:i};this.linkDialog(e,o)}},e.prototype.cancelDialog=function(e){this.selfLink.parent.isBlur=!1,this.selfLink.dialogObj.hide({returnValue:!0}),(0,d.wU)()?this.selection.restore():this.selfLink.parent.contentModule.getEditPanel().focus()},e.prototype.onDocumentClick=function(e){var t=e.target;!(0,i.hX)(this.dialogObj)&&(!(0,i.kp)(t,"[id='"+this.dialogObj.element.id+"']")&&this.parent.toolbarSettings.enable&&this.parent.getToolbarElement()&&!this.parent.getToolbarElement().contains(e.target)||(this.parent.getToolbarElement()&&this.parent.getToolbarElement().contains(e.target)||this.parent.inlineMode.enable&&!(0,i.kp)(t,"#"+this.dialogObj.element.id))&&!(0,i.kp)(t,"#"+this.parent.getID()+"_toolbar_CreateLink")&&!t.querySelector("#"+this.parent.getID()+"_toolbar_CreateLink"))&&(this.dialogObj.hide({returnValue:!0}),i.Jm.remove(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick),this.parent.isBlur=!0,(0,l.Pt)(this.parent.element,"focusout"))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.getModuleName=function(){return"link"},e}()},3573:(e,t,n)=>{n.d(t,{O:()=>r});var i=n(8452),o=n(1411),r=function(){function e(){this.rendererMap={}}return e.prototype.addRenderer=function(e,t){var n=(0,i.FD)(o.nJ,e);(0,i.hX)(this.rendererMap[n])&&(this.rendererMap[n]=t)},e.prototype.getRenderer=function(e){var t=(0,i.FD)(o.nJ,e);if((0,i.hX)(this.rendererMap[t]))throw"The renderer "+t+" is not found";return this.rendererMap[t]},e}()},6545:(e,t,n)=>{n.d(t,{q:()=>o});var i=n(8452),o=function(){function e(){this.services={}}return e.prototype.register=function(e,t){(0,i.hX)(this.services[e])&&(this.services[e]=t)},e.prototype.getService=function(e){if((0,i.hX)(this.services[e]))throw"The service "+e+" is not registered";return this.services[e]},e}()}}]);
//# sourceMappingURL=976.3cdc2e4e.chunk.js.map